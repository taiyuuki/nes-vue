const Kr=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function i(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerpolicy&&(n.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?n.credentials="include":r.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(r){if(r.ep)return;r.ep=!0;const n=i(r);fetch(r.href,n)}};Kr();function yi(t,e){const i=Object.create(null),s=t.split(",");for(let r=0;r<s.length;r++)i[s[r]]=!0;return e?r=>!!i[r.toLowerCase()]:r=>!!i[r]}const jr="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",zr=yi(jr);function ws(t){return!!t||t===""}function We(t){if(w(t)){const e={};for(let i=0;i<t.length;i++){const s=t[i],r=et(s)?Qr(s):We(s);if(r)for(const n in r)e[n]=r[n]}return e}else{if(et(t))return t;if(it(t))return t}}const $r=/;(?![^(]*\))/g,Jr=/:(.+)/;function Qr(t){const e={};return t.split($r).forEach(i=>{if(i){const s=i.split(Jr);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function Fi(t){let e="";if(et(t))e=t;else if(w(t))for(let i=0;i<t.length;i++){const s=Fi(t[i]);s&&(e+=s+" ")}else if(it(t))for(const i in t)t[i]&&(e+=i+" ");return e.trim()}const vs=t=>et(t)?t:t==null?"":w(t)||it(t)&&(t.toString===Bs||!x(t.toString))?JSON.stringify(t,Ls,2):String(t),Ls=(t,e)=>e&&e.__v_isRef?Ls(t,e.value):le(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((i,[s,r])=>(i[`${s} =>`]=r,i),{})}:ks(e)?{[`Set(${e.size})`]:[...e.values()]}:it(e)&&!w(e)&&!Vs(e)?String(e):e,K={},oe=[],bt=()=>{},tn=()=>!1,en=/^on[^a-z]/,Ze=t=>en.test(t),Mi=t=>t.startsWith("onUpdate:"),ht=Object.assign,Pi=(t,e)=>{const i=t.indexOf(e);i>-1&&t.splice(i,1)},sn=Object.prototype.hasOwnProperty,V=(t,e)=>sn.call(t,e),w=Array.isArray,le=t=>Ke(t)==="[object Map]",ks=t=>Ke(t)==="[object Set]",x=t=>typeof t=="function",et=t=>typeof t=="string",wi=t=>typeof t=="symbol",it=t=>t!==null&&typeof t=="object",xs=t=>it(t)&&x(t.then)&&x(t.catch),Bs=Object.prototype.toString,Ke=t=>Bs.call(t),rn=t=>Ke(t).slice(8,-1),Vs=t=>Ke(t)==="[object Object]",vi=t=>et(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Le=yi(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),je=t=>{const e=Object.create(null);return i=>e[i]||(e[i]=t(i))},nn=/-(\w)/g,ce=je(t=>t.replace(nn,(e,i)=>i?i.toUpperCase():"")),hn=/\B([A-Z])/g,pe=je(t=>t.replace(hn,"-$1").toLowerCase()),Gs=je(t=>t.charAt(0).toUpperCase()+t.slice(1)),ni=je(t=>t?`on${Gs(t)}`:""),be=(t,e)=>!Object.is(t,e),hi=(t,e)=>{for(let i=0;i<t.length;i++)t[i](e)},Ge=(t,e,i)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:i})},on=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let is;const ln=()=>is||(is=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});let Tt;class an{constructor(e=!1){this.active=!0,this.effects=[],this.cleanups=[],!e&&Tt&&(this.parent=Tt,this.index=(Tt.scopes||(Tt.scopes=[])).push(this)-1)}run(e){if(this.active){const i=Tt;try{return Tt=this,e()}finally{Tt=i}}}on(){Tt=this}off(){Tt=this.parent}stop(e){if(this.active){let i,s;for(i=0,s=this.effects.length;i<s;i++)this.effects[i].stop();for(i=0,s=this.cleanups.length;i<s;i++)this.cleanups[i]();if(this.scopes)for(i=0,s=this.scopes.length;i<s;i++)this.scopes[i].stop(!0);if(this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.active=!1}}}function un(t,e=Tt){e&&e.active&&e.effects.push(t)}const Li=t=>{const e=new Set(t);return e.w=0,e.n=0,e},qs=t=>(t.w&Ut)>0,Xs=t=>(t.n&Ut)>0,cn=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=Ut},fn=t=>{const{deps:e}=t;if(e.length){let i=0;for(let s=0;s<e.length;s++){const r=e[s];qs(r)&&!Xs(r)?r.delete(t):e[i++]=r,r.w&=~Ut,r.n&=~Ut}e.length=i}},fi=new WeakMap;let Re=0,Ut=1;const pi=30;let Ct;const Qt=Symbol(""),mi=Symbol("");class ki{constructor(e,i=null,s){this.fn=e,this.scheduler=i,this.active=!0,this.deps=[],this.parent=void 0,un(this,s)}run(){if(!this.active)return this.fn();let e=Ct,i=Ht;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=Ct,Ct=this,Ht=!0,Ut=1<<++Re,Re<=pi?cn(this):ss(this),this.fn()}finally{Re<=pi&&fn(this),Ut=1<<--Re,Ct=this.parent,Ht=i,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Ct===this?this.deferStop=!0:this.active&&(ss(this),this.onStop&&this.onStop(),this.active=!1)}}function ss(t){const{deps:e}=t;if(e.length){for(let i=0;i<e.length;i++)e[i].delete(t);e.length=0}}let Ht=!0;const Hs=[];function me(){Hs.push(Ht),Ht=!1}function _e(){const t=Hs.pop();Ht=t===void 0?!0:t}function _t(t,e,i){if(Ht&&Ct){let s=fi.get(t);s||fi.set(t,s=new Map);let r=s.get(i);r||s.set(i,r=Li()),Ys(r)}}function Ys(t,e){let i=!1;Re<=pi?Xs(t)||(t.n|=Ut,i=!qs(t)):i=!t.has(Ct),i&&(t.add(Ct),Ct.deps.push(t))}function kt(t,e,i,s,r,n){const o=fi.get(t);if(!o)return;let h=[];if(e==="clear")h=[...o.values()];else if(i==="length"&&w(t))o.forEach((a,c)=>{(c==="length"||c>=s)&&h.push(a)});else switch(i!==void 0&&h.push(o.get(i)),e){case"add":w(t)?vi(i)&&h.push(o.get("length")):(h.push(o.get(Qt)),le(t)&&h.push(o.get(mi)));break;case"delete":w(t)||(h.push(o.get(Qt)),le(t)&&h.push(o.get(mi)));break;case"set":le(t)&&h.push(o.get(Qt));break}if(h.length===1)h[0]&&_i(h[0]);else{const a=[];for(const c of h)c&&a.push(...c);_i(Li(a))}}function _i(t,e){const i=w(t)?t:[...t];for(const s of i)s.computed&&rs(s);for(const s of i)s.computed||rs(s)}function rs(t,e){(t!==Ct||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const pn=yi("__proto__,__v_isRef,__isVue"),Us=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(wi)),mn=xi(),_n=xi(!1,!0),dn=xi(!0),ns=Rn();function Rn(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...i){const s=X(this);for(let n=0,o=this.length;n<o;n++)_t(s,"get",n+"");const r=s[e](...i);return r===-1||r===!1?s[e](...i.map(X)):r}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...i){me();const s=X(this)[e].apply(this,i);return _e(),s}}),t}function xi(t=!1,e=!1){return function(s,r,n){if(r==="__v_isReactive")return!t;if(r==="__v_isReadonly")return t;if(r==="__v_isShallow")return e;if(r==="__v_raw"&&n===(t?e?wn:zs:e?js:Ks).get(s))return s;const o=w(s);if(!t&&o&&V(ns,r))return Reflect.get(ns,r,n);const h=Reflect.get(s,r,n);return(wi(r)?Us.has(r):pn(r))||(t||_t(s,"get",r),e)?h:nt(h)?o&&vi(r)?h:h.value:it(h)?t?$s(h):Gi(h):h}}const gn=Ws(),Sn=Ws(!0);function Ws(t=!1){return function(i,s,r,n){let o=i[s];if(Ie(o)&&nt(o)&&!nt(r))return!1;if(!t&&!Ie(r)&&(di(r)||(r=X(r),o=X(o)),!w(i)&&nt(o)&&!nt(r)))return o.value=r,!0;const h=w(i)&&vi(s)?Number(s)<i.length:V(i,s),a=Reflect.set(i,s,r,n);return i===X(n)&&(h?be(r,o)&&kt(i,"set",s,r):kt(i,"add",s,r)),a}}function Cn(t,e){const i=V(t,e);t[e];const s=Reflect.deleteProperty(t,e);return s&&i&&kt(t,"delete",e,void 0),s}function An(t,e){const i=Reflect.has(t,e);return(!wi(e)||!Us.has(e))&&_t(t,"has",e),i}function bn(t){return _t(t,"iterate",w(t)?"length":Qt),Reflect.ownKeys(t)}const Zs={get:mn,set:gn,deleteProperty:Cn,has:An,ownKeys:bn},In={get:dn,set(t,e){return!0},deleteProperty(t,e){return!0}},Dn=ht({},Zs,{get:_n,set:Sn}),Bi=t=>t,ze=t=>Reflect.getPrototypeOf(t);function Fe(t,e,i=!1,s=!1){t=t.__v_raw;const r=X(t),n=X(e);i||(e!==n&&_t(r,"get",e),_t(r,"get",n));const{has:o}=ze(r),h=s?Bi:i?Xi:De;if(o.call(r,e))return h(t.get(e));if(o.call(r,n))return h(t.get(n));t!==r&&t.get(e)}function Me(t,e=!1){const i=this.__v_raw,s=X(i),r=X(t);return e||(t!==r&&_t(s,"has",t),_t(s,"has",r)),t===r?i.has(t):i.has(t)||i.has(r)}function Pe(t,e=!1){return t=t.__v_raw,!e&&_t(X(t),"iterate",Qt),Reflect.get(t,"size",t)}function hs(t){t=X(t);const e=X(this);return ze(e).has.call(e,t)||(e.add(t),kt(e,"add",t,t)),this}function os(t,e){e=X(e);const i=X(this),{has:s,get:r}=ze(i);let n=s.call(i,t);n||(t=X(t),n=s.call(i,t));const o=r.call(i,t);return i.set(t,e),n?be(e,o)&&kt(i,"set",t,e):kt(i,"add",t,e),this}function ls(t){const e=X(this),{has:i,get:s}=ze(e);let r=i.call(e,t);r||(t=X(t),r=i.call(e,t)),s&&s.call(e,t);const n=e.delete(t);return r&&kt(e,"delete",t,void 0),n}function as(){const t=X(this),e=t.size!==0,i=t.clear();return e&&kt(t,"clear",void 0,void 0),i}function we(t,e){return function(s,r){const n=this,o=n.__v_raw,h=X(o),a=e?Bi:t?Xi:De;return!t&&_t(h,"iterate",Qt),o.forEach((c,p)=>s.call(r,a(c),a(p),n))}}function ve(t,e,i){return function(...s){const r=this.__v_raw,n=X(r),o=le(n),h=t==="entries"||t===Symbol.iterator&&o,a=t==="keys"&&o,c=r[t](...s),p=i?Bi:e?Xi:De;return!e&&_t(n,"iterate",a?mi:Qt),{next(){const{value:g,done:S}=c.next();return S?{value:g,done:S}:{value:h?[p(g[0]),p(g[1])]:p(g),done:S}},[Symbol.iterator](){return this}}}}function Gt(t){return function(...e){return t==="delete"?!1:this}}function Nn(){const t={get(n){return Fe(this,n)},get size(){return Pe(this)},has:Me,add:hs,set:os,delete:ls,clear:as,forEach:we(!1,!1)},e={get(n){return Fe(this,n,!1,!0)},get size(){return Pe(this)},has:Me,add:hs,set:os,delete:ls,clear:as,forEach:we(!1,!0)},i={get(n){return Fe(this,n,!0)},get size(){return Pe(this,!0)},has(n){return Me.call(this,n,!0)},add:Gt("add"),set:Gt("set"),delete:Gt("delete"),clear:Gt("clear"),forEach:we(!0,!1)},s={get(n){return Fe(this,n,!0,!0)},get size(){return Pe(this,!0)},has(n){return Me.call(this,n,!0)},add:Gt("add"),set:Gt("set"),delete:Gt("delete"),clear:Gt("clear"),forEach:we(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(n=>{t[n]=ve(n,!1,!1),i[n]=ve(n,!0,!1),e[n]=ve(n,!1,!0),s[n]=ve(n,!0,!0)}),[t,i,e,s]}const[En,Tn,On,yn]=Nn();function Vi(t,e){const i=e?t?yn:On:t?Tn:En;return(s,r,n)=>r==="__v_isReactive"?!t:r==="__v_isReadonly"?t:r==="__v_raw"?s:Reflect.get(V(i,r)&&r in s?i:s,r,n)}const Fn={get:Vi(!1,!1)},Mn={get:Vi(!1,!0)},Pn={get:Vi(!0,!1)},Ks=new WeakMap,js=new WeakMap,zs=new WeakMap,wn=new WeakMap;function vn(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Ln(t){return t.__v_skip||!Object.isExtensible(t)?0:vn(rn(t))}function Gi(t){return Ie(t)?t:qi(t,!1,Zs,Fn,Ks)}function kn(t){return qi(t,!1,Dn,Mn,js)}function $s(t){return qi(t,!0,In,Pn,zs)}function qi(t,e,i,s,r){if(!it(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const n=r.get(t);if(n)return n;const o=Ln(t);if(o===0)return t;const h=new Proxy(t,o===2?s:i);return r.set(t,h),h}function ae(t){return Ie(t)?ae(t.__v_raw):!!(t&&t.__v_isReactive)}function Ie(t){return!!(t&&t.__v_isReadonly)}function di(t){return!!(t&&t.__v_isShallow)}function Js(t){return ae(t)||Ie(t)}function X(t){const e=t&&t.__v_raw;return e?X(e):t}function Qs(t){return Ge(t,"__v_skip",!0),t}const De=t=>it(t)?Gi(t):t,Xi=t=>it(t)?$s(t):t;function tr(t){Ht&&Ct&&(t=X(t),Ys(t.dep||(t.dep=Li())))}function er(t,e){t=X(t),t.dep&&_i(t.dep)}function nt(t){return!!(t&&t.__v_isRef===!0)}function ue(t){return xn(t,!1)}function xn(t,e){return nt(t)?t:new Bn(t,e)}class Bn{constructor(e,i){this.__v_isShallow=i,this.dep=void 0,this.__v_isRef=!0,this._rawValue=i?e:X(e),this._value=i?e:De(e)}get value(){return tr(this),this._value}set value(e){e=this.__v_isShallow?e:X(e),be(e,this._rawValue)&&(this._rawValue=e,this._value=this.__v_isShallow?e:De(e),er(this))}}function ke(t){return nt(t)?t.value:t}const Vn={get:(t,e,i)=>ke(Reflect.get(t,e,i)),set:(t,e,i,s)=>{const r=t[e];return nt(r)&&!nt(i)?(r.value=i,!0):Reflect.set(t,e,i,s)}};function ir(t){return ae(t)?t:new Proxy(t,Vn)}class Gn{constructor(e,i,s,r){this._setter=i,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new ki(e,()=>{this._dirty||(this._dirty=!0,er(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!r,this.__v_isReadonly=s}get value(){const e=X(this);return tr(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function qn(t,e,i=!1){let s,r;const n=x(t);return n?(s=t,r=bt):(s=t.get,r=t.set),new Gn(s,r,n||!r,i)}function Yt(t,e,i,s){let r;try{r=s?t(...s):t()}catch(n){$e(n,e,i)}return r}function Rt(t,e,i,s){if(x(t)){const n=Yt(t,e,i,s);return n&&xs(n)&&n.catch(o=>{$e(o,e,i)}),n}const r=[];for(let n=0;n<t.length;n++)r.push(Rt(t[n],e,i,s));return r}function $e(t,e,i,s=!0){const r=e?e.vnode:null;if(e){let n=e.parent;const o=e.proxy,h=i;for(;n;){const c=n.ec;if(c){for(let p=0;p<c.length;p++)if(c[p](t,o,h)===!1)return}n=n.parent}const a=e.appContext.config.errorHandler;if(a){Yt(a,null,10,[t,o,h]);return}}Xn(t,i,r,s)}function Xn(t,e,i,s=!0){console.error(t)}let qe=!1,Ri=!1;const mt=[];let Lt=0;const Se=[];let ge=null,re=0;const Ce=[];let qt=null,ne=0;const sr=Promise.resolve();let Hi=null,gi=null;function Hn(t){const e=Hi||sr;return t?e.then(this?t.bind(this):t):e}function Yn(t){let e=Lt+1,i=mt.length;for(;e<i;){const s=e+i>>>1;Ne(mt[s])<t?e=s+1:i=s}return e}function rr(t){(!mt.length||!mt.includes(t,qe&&t.allowRecurse?Lt+1:Lt))&&t!==gi&&(t.id==null?mt.push(t):mt.splice(Yn(t.id),0,t),nr())}function nr(){!qe&&!Ri&&(Ri=!0,Hi=sr.then(lr))}function Un(t){const e=mt.indexOf(t);e>Lt&&mt.splice(e,1)}function hr(t,e,i,s){w(t)?i.push(...t):(!e||!e.includes(t,t.allowRecurse?s+1:s))&&i.push(t),nr()}function Wn(t){hr(t,ge,Se,re)}function Zn(t){hr(t,qt,Ce,ne)}function Je(t,e=null){if(Se.length){for(gi=e,ge=[...new Set(Se)],Se.length=0,re=0;re<ge.length;re++)ge[re]();ge=null,re=0,gi=null,Je(t,e)}}function or(t){if(Je(),Ce.length){const e=[...new Set(Ce)];if(Ce.length=0,qt){qt.push(...e);return}for(qt=e,qt.sort((i,s)=>Ne(i)-Ne(s)),ne=0;ne<qt.length;ne++)qt[ne]();qt=null,ne=0}}const Ne=t=>t.id==null?1/0:t.id;function lr(t){Ri=!1,qe=!0,Je(t),mt.sort((i,s)=>Ne(i)-Ne(s));const e=bt;try{for(Lt=0;Lt<mt.length;Lt++){const i=mt[Lt];i&&i.active!==!1&&Yt(i,null,14)}}finally{Lt=0,mt.length=0,or(),qe=!1,Hi=null,(mt.length||Se.length||Ce.length)&&lr(t)}}function Kn(t,e,...i){if(t.isUnmounted)return;const s=t.vnode.props||K;let r=i;const n=e.startsWith("update:"),o=n&&e.slice(7);if(o&&o in s){const p=`${o==="modelValue"?"model":o}Modifiers`,{number:g,trim:S}=s[p]||K;S&&(r=i.map(T=>T.trim())),g&&(r=i.map(on))}let h,a=s[h=ni(e)]||s[h=ni(ce(e))];!a&&n&&(a=s[h=ni(pe(e))]),a&&Rt(a,t,6,r);const c=s[h+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[h])return;t.emitted[h]=!0,Rt(c,t,6,r)}}function ar(t,e,i=!1){const s=e.emitsCache,r=s.get(t);if(r!==void 0)return r;const n=t.emits;let o={},h=!1;if(!x(t)){const a=c=>{const p=ar(c,e,!0);p&&(h=!0,ht(o,p))};!i&&e.mixins.length&&e.mixins.forEach(a),t.extends&&a(t.extends),t.mixins&&t.mixins.forEach(a)}return!n&&!h?(s.set(t,null),null):(w(n)?n.forEach(a=>o[a]=null):ht(o,n),s.set(t,o),o)}function Qe(t,e){return!t||!Ze(e)?!1:(e=e.slice(2).replace(/Once$/,""),V(t,e[0].toLowerCase()+e.slice(1))||V(t,pe(e))||V(t,e))}let yt=null,ur=null;function Xe(t){const e=yt;return yt=t,ur=t&&t.type.__scopeId||null,e}function jn(t,e=yt,i){if(!e||t._n)return t;const s=(...r)=>{s._d&&Ss(-1);const n=Xe(e),o=t(...r);return Xe(n),s._d&&Ss(1),o};return s._n=!0,s._c=!0,s._d=!0,s}function oi(t){const{type:e,vnode:i,proxy:s,withProxy:r,props:n,propsOptions:[o],slots:h,attrs:a,emit:c,render:p,renderCache:g,data:S,setupState:T,ctx:L,inheritAttrs:k}=t;let O,y;const J=Xe(t);try{if(i.shapeFlag&4){const H=r||s;O=Ot(p.call(H,H,g,n,T,S,L)),y=a}else{const H=e;O=Ot(H.length>1?H(n,{attrs:a,slots:h,emit:c}):H(n,null)),y=e.props?a:zn(a)}}catch(H){Ae.length=0,$e(H,t,1),O=Dt(It)}let Q=O;if(y&&k!==!1){const H=Object.keys(y),{shapeFlag:st}=Q;H.length&&st&7&&(o&&H.some(Mi)&&(y=$n(y,o)),Q=Wt(Q,y))}return i.dirs&&(Q=Wt(Q),Q.dirs=Q.dirs?Q.dirs.concat(i.dirs):i.dirs),i.transition&&(Q.transition=i.transition),O=Q,Xe(J),O}const zn=t=>{let e;for(const i in t)(i==="class"||i==="style"||Ze(i))&&((e||(e={}))[i]=t[i]);return e},$n=(t,e)=>{const i={};for(const s in t)(!Mi(s)||!(s.slice(9)in e))&&(i[s]=t[s]);return i};function Jn(t,e,i){const{props:s,children:r,component:n}=t,{props:o,children:h,patchFlag:a}=e,c=n.emitsOptions;if(e.dirs||e.transition)return!0;if(i&&a>=0){if(a&1024)return!0;if(a&16)return s?us(s,o,c):!!o;if(a&8){const p=e.dynamicProps;for(let g=0;g<p.length;g++){const S=p[g];if(o[S]!==s[S]&&!Qe(c,S))return!0}}}else return(r||h)&&(!h||!h.$stable)?!0:s===o?!1:s?o?us(s,o,c):!0:!!o;return!1}function us(t,e,i){const s=Object.keys(e);if(s.length!==Object.keys(t).length)return!0;for(let r=0;r<s.length;r++){const n=s[r];if(e[n]!==t[n]&&!Qe(i,n))return!0}return!1}function Qn({vnode:t,parent:e},i){for(;e&&e.subTree===t;)(t=e.vnode).el=i,e=e.parent}const th=t=>t.__isSuspense;function eh(t,e){e&&e.pendingBranch?w(t)?e.effects.push(...t):e.effects.push(t):Zn(t)}function ih(t,e){if(tt){let i=tt.provides;const s=tt.parent&&tt.parent.provides;s===i&&(i=tt.provides=Object.create(s)),i[t]=e}}function li(t,e,i=!1){const s=tt||yt;if(s){const r=s.parent==null?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides;if(r&&t in r)return r[t];if(arguments.length>1)return i&&x(e)?e.call(s.proxy):e}}const cs={};function xe(t,e,i){return cr(t,e,i)}function cr(t,e,{immediate:i,deep:s,flush:r,onTrack:n,onTrigger:o}=K){const h=tt;let a,c=!1,p=!1;if(nt(t)?(a=()=>t.value,c=di(t)):ae(t)?(a=()=>t,s=!0):w(t)?(p=!0,c=t.some(y=>ae(y)||di(y)),a=()=>t.map(y=>{if(nt(y))return y.value;if(ae(y))return he(y);if(x(y))return Yt(y,h,2)})):x(t)?e?a=()=>Yt(t,h,2):a=()=>{if(!(h&&h.isUnmounted))return g&&g(),Rt(t,h,3,[S])}:a=bt,e&&s){const y=a;a=()=>he(y())}let g,S=y=>{g=O.onStop=()=>{Yt(y,h,4)}};if(Oe)return S=bt,e?i&&Rt(e,h,3,[a(),p?[]:void 0,S]):a(),bt;let T=p?[]:cs;const L=()=>{if(!!O.active)if(e){const y=O.run();(s||c||(p?y.some((J,Q)=>be(J,T[Q])):be(y,T)))&&(g&&g(),Rt(e,h,3,[y,T===cs?void 0:T,S]),T=y)}else O.run()};L.allowRecurse=!!e;let k;r==="sync"?k=L:r==="post"?k=()=>ut(L,h&&h.suspense):k=()=>Wn(L);const O=new ki(a,k);return e?i?L():T=O.run():r==="post"?ut(O.run.bind(O),h&&h.suspense):O.run(),()=>{O.stop(),h&&h.scope&&Pi(h.scope.effects,O)}}function sh(t,e,i){const s=this.proxy,r=et(t)?t.includes(".")?fr(s,t):()=>s[t]:t.bind(s,s);let n;x(e)?n=e:(n=e.handler,i=e);const o=tt;fe(this);const h=cr(r,n.bind(s),i);return o?fe(o):te(),h}function fr(t,e){const i=e.split(".");return()=>{let s=t;for(let r=0;r<i.length&&s;r++)s=s[i[r]];return s}}function he(t,e){if(!it(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),nt(t))he(t.value,e);else if(w(t))for(let i=0;i<t.length;i++)he(t[i],e);else if(ks(t)||le(t))t.forEach(i=>{he(i,e)});else if(Vs(t))for(const i in t)he(t[i],e);return t}function rh(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Ui(()=>{t.isMounted=!0}),dr(()=>{t.isUnmounting=!0}),t}const dt=[Function,Array],nh={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:dt,onEnter:dt,onAfterEnter:dt,onEnterCancelled:dt,onBeforeLeave:dt,onLeave:dt,onAfterLeave:dt,onLeaveCancelled:dt,onBeforeAppear:dt,onAppear:dt,onAfterAppear:dt,onAppearCancelled:dt},setup(t,{slots:e}){const i=Wh(),s=rh();let r;return()=>{const n=e.default&&mr(e.default(),!0);if(!n||!n.length)return;let o=n[0];if(n.length>1){for(const k of n)if(k.type!==It){o=k;break}}const h=X(t),{mode:a}=h;if(s.isLeaving)return ai(o);const c=fs(o);if(!c)return ai(o);const p=Si(c,h,s,i);Ci(c,p);const g=i.subTree,S=g&&fs(g);let T=!1;const{getTransitionKey:L}=c.type;if(L){const k=L();r===void 0?r=k:k!==r&&(r=k,T=!0)}if(S&&S.type!==It&&(!$t(c,S)||T)){const k=Si(S,h,s,i);if(Ci(S,k),a==="out-in")return s.isLeaving=!0,k.afterLeave=()=>{s.isLeaving=!1,i.update()},ai(o);a==="in-out"&&c.type!==It&&(k.delayLeave=(O,y,J)=>{const Q=pr(s,S);Q[String(S.key)]=S,O._leaveCb=()=>{y(),O._leaveCb=void 0,delete p.delayedLeave},p.delayedLeave=J})}return o}}},hh=nh;function pr(t,e){const{leavingVNodes:i}=t;let s=i.get(e.type);return s||(s=Object.create(null),i.set(e.type,s)),s}function Si(t,e,i,s){const{appear:r,mode:n,persisted:o=!1,onBeforeEnter:h,onEnter:a,onAfterEnter:c,onEnterCancelled:p,onBeforeLeave:g,onLeave:S,onAfterLeave:T,onLeaveCancelled:L,onBeforeAppear:k,onAppear:O,onAfterAppear:y,onAppearCancelled:J}=e,Q=String(t.key),H=pr(i,t),st=(B,j)=>{B&&Rt(B,s,9,j)},Bt=(B,j)=>{const z=j[1];st(B,j),w(B)?B.every(rt=>rt.length<=1)&&z():B.length<=1&&z()},Mt={mode:n,persisted:o,beforeEnter(B){let j=h;if(!i.isMounted)if(r)j=k||h;else return;B._leaveCb&&B._leaveCb(!0);const z=H[Q];z&&$t(t,z)&&z.el._leaveCb&&z.el._leaveCb(),st(j,[B])},enter(B){let j=a,z=c,rt=p;if(!i.isMounted)if(r)j=O||a,z=y||c,rt=J||p;else return;let at=!1;const ct=B._enterCb=P=>{at||(at=!0,P?st(rt,[B]):st(z,[B]),Mt.delayedLeave&&Mt.delayedLeave(),B._enterCb=void 0)};j?Bt(j,[B,ct]):ct()},leave(B,j){const z=String(t.key);if(B._enterCb&&B._enterCb(!0),i.isUnmounting)return j();st(g,[B]);let rt=!1;const at=B._leaveCb=ct=>{rt||(rt=!0,j(),ct?st(L,[B]):st(T,[B]),B._leaveCb=void 0,H[z]===t&&delete H[z])};H[z]=t,S?Bt(S,[B,at]):at()},clone(B){return Si(B,e,i,s)}};return Mt}function ai(t){if(ti(t))return t=Wt(t),t.children=null,t}function fs(t){return ti(t)?t.children?t.children[0]:void 0:t}function Ci(t,e){t.shapeFlag&6&&t.component?Ci(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function mr(t,e=!1,i){let s=[],r=0;for(let n=0;n<t.length;n++){let o=t[n];const h=i==null?o.key:String(i)+String(o.key!=null?o.key:n);o.type===St?(o.patchFlag&128&&r++,s=s.concat(mr(o.children,e,h))):(e||o.type!==It)&&s.push(h!=null?Wt(o,{key:h}):o)}if(r>1)for(let n=0;n<s.length;n++)s[n].patchFlag=-2;return s}function Yi(t){return x(t)?{setup:t,name:t.name}:t}const Be=t=>!!t.type.__asyncLoader,ti=t=>t.type.__isKeepAlive;function oh(t,e){_r(t,"a",e)}function lh(t,e){_r(t,"da",e)}function _r(t,e,i=tt){const s=t.__wdc||(t.__wdc=()=>{let r=i;for(;r;){if(r.isDeactivated)return;r=r.parent}return t()});if(ei(e,s,i),i){let r=i.parent;for(;r&&r.parent;)ti(r.parent.vnode)&&ah(s,e,i,r),r=r.parent}}function ah(t,e,i,s){const r=ei(e,t,s,!0);Rr(()=>{Pi(s[e],r)},i)}function ei(t,e,i=tt,s=!1){if(i){const r=i[t]||(i[t]=[]),n=e.__weh||(e.__weh=(...o)=>{if(i.isUnmounted)return;me(),fe(i);const h=Rt(e,i,t,o);return te(),_e(),h});return s?r.unshift(n):r.push(n),n}}const xt=t=>(e,i=tt)=>(!Oe||t==="sp")&&ei(t,e,i),uh=xt("bm"),Ui=xt("m"),ch=xt("bu"),fh=xt("u"),dr=xt("bum"),Rr=xt("um"),ph=xt("sp"),mh=xt("rtg"),_h=xt("rtc");function dh(t,e=tt){ei("ec",t,e)}function Zt(t,e,i,s){const r=t.dirs,n=e&&e.dirs;for(let o=0;o<r.length;o++){const h=r[o];n&&(h.oldValue=n[o].value);let a=h.dir[s];a&&(me(),Rt(a,i,8,[t.el,h,t,e]),_e())}}const Rh=Symbol(),Ai=t=>t?yr(t)?ji(t)||t.proxy:Ai(t.parent):null,He=ht(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Ai(t.parent),$root:t=>Ai(t.root),$emit:t=>t.emit,$options:t=>Sr(t),$forceUpdate:t=>t.f||(t.f=()=>rr(t.update)),$nextTick:t=>t.n||(t.n=Hn.bind(t.proxy)),$watch:t=>sh.bind(t)}),gh={get({_:t},e){const{ctx:i,setupState:s,data:r,props:n,accessCache:o,type:h,appContext:a}=t;let c;if(e[0]!=="$"){const T=o[e];if(T!==void 0)switch(T){case 1:return s[e];case 2:return r[e];case 4:return i[e];case 3:return n[e]}else{if(s!==K&&V(s,e))return o[e]=1,s[e];if(r!==K&&V(r,e))return o[e]=2,r[e];if((c=t.propsOptions[0])&&V(c,e))return o[e]=3,n[e];if(i!==K&&V(i,e))return o[e]=4,i[e];bi&&(o[e]=0)}}const p=He[e];let g,S;if(p)return e==="$attrs"&&_t(t,"get",e),p(t);if((g=h.__cssModules)&&(g=g[e]))return g;if(i!==K&&V(i,e))return o[e]=4,i[e];if(S=a.config.globalProperties,V(S,e))return S[e]},set({_:t},e,i){const{data:s,setupState:r,ctx:n}=t;return r!==K&&V(r,e)?(r[e]=i,!0):s!==K&&V(s,e)?(s[e]=i,!0):V(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(n[e]=i,!0)},has({_:{data:t,setupState:e,accessCache:i,ctx:s,appContext:r,propsOptions:n}},o){let h;return!!i[o]||t!==K&&V(t,o)||e!==K&&V(e,o)||(h=n[0])&&V(h,o)||V(s,o)||V(He,o)||V(r.config.globalProperties,o)},defineProperty(t,e,i){return i.get!=null?t._.accessCache[e]=0:V(i,"value")&&this.set(t,e,i.value,null),Reflect.defineProperty(t,e,i)}};let bi=!0;function Sh(t){const e=Sr(t),i=t.proxy,s=t.ctx;bi=!1,e.beforeCreate&&ps(e.beforeCreate,t,"bc");const{data:r,computed:n,methods:o,watch:h,provide:a,inject:c,created:p,beforeMount:g,mounted:S,beforeUpdate:T,updated:L,activated:k,deactivated:O,beforeDestroy:y,beforeUnmount:J,destroyed:Q,unmounted:H,render:st,renderTracked:Bt,renderTriggered:Mt,errorCaptured:B,serverPrefetch:j,expose:z,inheritAttrs:rt,components:at,directives:ct,filters:P}=e;if(c&&Ch(c,s,null,t.appContext.config.unwrapInjectedRef),o)for(const M in o){const q=o[M];x(q)&&(s[M]=q.bind(i))}if(r){const M=r.call(i,i);it(M)&&(t.data=Gi(M))}if(bi=!0,n)for(const M in n){const q=n[M],U=x(q)?q.bind(i,i):x(q.get)?q.get.bind(i,i):bt,Pt=!x(q)&&x(q.set)?q.set.bind(i):bt,ft=Jh({get:U,set:Pt});Object.defineProperty(s,M,{enumerable:!0,configurable:!0,get:()=>ft.value,set:ee=>ft.value=ee})}if(h)for(const M in h)gr(h[M],s,i,M);if(a){const M=x(a)?a.call(i):a;Reflect.ownKeys(M).forEach(q=>{ih(q,M[q])})}p&&ps(p,t,"c");function v(M,q){w(q)?q.forEach(U=>M(U.bind(i))):q&&M(q.bind(i))}if(v(uh,g),v(Ui,S),v(ch,T),v(fh,L),v(oh,k),v(lh,O),v(dh,B),v(_h,Bt),v(mh,Mt),v(dr,J),v(Rr,H),v(ph,j),w(z))if(z.length){const M=t.exposed||(t.exposed={});z.forEach(q=>{Object.defineProperty(M,q,{get:()=>i[q],set:U=>i[q]=U})})}else t.exposed||(t.exposed={});st&&t.render===bt&&(t.render=st),rt!=null&&(t.inheritAttrs=rt),at&&(t.components=at),ct&&(t.directives=ct)}function Ch(t,e,i=bt,s=!1){w(t)&&(t=Ii(t));for(const r in t){const n=t[r];let o;it(n)?"default"in n?o=li(n.from||r,n.default,!0):o=li(n.from||r):o=li(n),nt(o)&&s?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>o.value,set:h=>o.value=h}):e[r]=o}}function ps(t,e,i){Rt(w(t)?t.map(s=>s.bind(e.proxy)):t.bind(e.proxy),e,i)}function gr(t,e,i,s){const r=s.includes(".")?fr(i,s):()=>i[s];if(et(t)){const n=e[t];x(n)&&xe(r,n)}else if(x(t))xe(r,t.bind(i));else if(it(t))if(w(t))t.forEach(n=>gr(n,e,i,s));else{const n=x(t.handler)?t.handler.bind(i):e[t.handler];x(n)&&xe(r,n,t)}}function Sr(t){const e=t.type,{mixins:i,extends:s}=e,{mixins:r,optionsCache:n,config:{optionMergeStrategies:o}}=t.appContext,h=n.get(e);let a;return h?a=h:!r.length&&!i&&!s?a=e:(a={},r.length&&r.forEach(c=>Ye(a,c,o,!0)),Ye(a,e,o)),n.set(e,a),a}function Ye(t,e,i,s=!1){const{mixins:r,extends:n}=e;n&&Ye(t,n,i,!0),r&&r.forEach(o=>Ye(t,o,i,!0));for(const o in e)if(!(s&&o==="expose")){const h=Ah[o]||i&&i[o];t[o]=h?h(t[o],e[o]):e[o]}return t}const Ah={data:ms,props:zt,emits:zt,methods:zt,computed:zt,beforeCreate:lt,created:lt,beforeMount:lt,mounted:lt,beforeUpdate:lt,updated:lt,beforeDestroy:lt,beforeUnmount:lt,destroyed:lt,unmounted:lt,activated:lt,deactivated:lt,errorCaptured:lt,serverPrefetch:lt,components:zt,directives:zt,watch:Ih,provide:ms,inject:bh};function ms(t,e){return e?t?function(){return ht(x(t)?t.call(this,this):t,x(e)?e.call(this,this):e)}:e:t}function bh(t,e){return zt(Ii(t),Ii(e))}function Ii(t){if(w(t)){const e={};for(let i=0;i<t.length;i++)e[t[i]]=t[i];return e}return t}function lt(t,e){return t?[...new Set([].concat(t,e))]:e}function zt(t,e){return t?ht(ht(Object.create(null),t),e):e}function Ih(t,e){if(!t)return e;if(!e)return t;const i=ht(Object.create(null),t);for(const s in e)i[s]=lt(t[s],e[s]);return i}function Dh(t,e,i,s=!1){const r={},n={};Ge(n,ii,1),t.propsDefaults=Object.create(null),Cr(t,e,r,n);for(const o in t.propsOptions[0])o in r||(r[o]=void 0);i?t.props=s?r:kn(r):t.type.props?t.props=r:t.props=n,t.attrs=n}function Nh(t,e,i,s){const{props:r,attrs:n,vnode:{patchFlag:o}}=t,h=X(r),[a]=t.propsOptions;let c=!1;if((s||o>0)&&!(o&16)){if(o&8){const p=t.vnode.dynamicProps;for(let g=0;g<p.length;g++){let S=p[g];if(Qe(t.emitsOptions,S))continue;const T=e[S];if(a)if(V(n,S))T!==n[S]&&(n[S]=T,c=!0);else{const L=ce(S);r[L]=Di(a,h,L,T,t,!1)}else T!==n[S]&&(n[S]=T,c=!0)}}}else{Cr(t,e,r,n)&&(c=!0);let p;for(const g in h)(!e||!V(e,g)&&((p=pe(g))===g||!V(e,p)))&&(a?i&&(i[g]!==void 0||i[p]!==void 0)&&(r[g]=Di(a,h,g,void 0,t,!0)):delete r[g]);if(n!==h)for(const g in n)(!e||!V(e,g)&&!0)&&(delete n[g],c=!0)}c&&kt(t,"set","$attrs")}function Cr(t,e,i,s){const[r,n]=t.propsOptions;let o=!1,h;if(e)for(let a in e){if(Le(a))continue;const c=e[a];let p;r&&V(r,p=ce(a))?!n||!n.includes(p)?i[p]=c:(h||(h={}))[p]=c:Qe(t.emitsOptions,a)||(!(a in s)||c!==s[a])&&(s[a]=c,o=!0)}if(n){const a=X(i),c=h||K;for(let p=0;p<n.length;p++){const g=n[p];i[g]=Di(r,a,g,c[g],t,!V(c,g))}}return o}function Di(t,e,i,s,r,n){const o=t[i];if(o!=null){const h=V(o,"default");if(h&&s===void 0){const a=o.default;if(o.type!==Function&&x(a)){const{propsDefaults:c}=r;i in c?s=c[i]:(fe(r),s=c[i]=a.call(null,e),te())}else s=a}o[0]&&(n&&!h?s=!1:o[1]&&(s===""||s===pe(i))&&(s=!0))}return s}function Ar(t,e,i=!1){const s=e.propsCache,r=s.get(t);if(r)return r;const n=t.props,o={},h=[];let a=!1;if(!x(t)){const p=g=>{a=!0;const[S,T]=Ar(g,e,!0);ht(o,S),T&&h.push(...T)};!i&&e.mixins.length&&e.mixins.forEach(p),t.extends&&p(t.extends),t.mixins&&t.mixins.forEach(p)}if(!n&&!a)return s.set(t,oe),oe;if(w(n))for(let p=0;p<n.length;p++){const g=ce(n[p]);_s(g)&&(o[g]=K)}else if(n)for(const p in n){const g=ce(p);if(_s(g)){const S=n[p],T=o[g]=w(S)||x(S)?{type:S}:S;if(T){const L=gs(Boolean,T.type),k=gs(String,T.type);T[0]=L>-1,T[1]=k<0||L<k,(L>-1||V(T,"default"))&&h.push(g)}}}const c=[o,h];return s.set(t,c),c}function _s(t){return t[0]!=="$"}function ds(t){const e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:t===null?"null":""}function Rs(t,e){return ds(t)===ds(e)}function gs(t,e){return w(e)?e.findIndex(i=>Rs(i,t)):x(e)&&Rs(e,t)?0:-1}const br=t=>t[0]==="_"||t==="$stable",Wi=t=>w(t)?t.map(Ot):[Ot(t)],Eh=(t,e,i)=>{if(e._n)return e;const s=jn((...r)=>Wi(e(...r)),i);return s._c=!1,s},Ir=(t,e,i)=>{const s=t._ctx;for(const r in t){if(br(r))continue;const n=t[r];if(x(n))e[r]=Eh(r,n,s);else if(n!=null){const o=Wi(n);e[r]=()=>o}}},Dr=(t,e)=>{const i=Wi(e);t.slots.default=()=>i},Th=(t,e)=>{if(t.vnode.shapeFlag&32){const i=e._;i?(t.slots=X(e),Ge(e,"_",i)):Ir(e,t.slots={})}else t.slots={},e&&Dr(t,e);Ge(t.slots,ii,1)},Oh=(t,e,i)=>{const{vnode:s,slots:r}=t;let n=!0,o=K;if(s.shapeFlag&32){const h=e._;h?i&&h===1?n=!1:(ht(r,e),!i&&h===1&&delete r._):(n=!e.$stable,Ir(e,r)),o=e}else e&&(Dr(t,e),o={default:1});if(n)for(const h in r)!br(h)&&!(h in o)&&delete r[h]};function Nr(){return{app:null,config:{isNativeTag:tn,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let yh=0;function Fh(t,e){return function(s,r=null){x(s)||(s=Object.assign({},s)),r!=null&&!it(r)&&(r=null);const n=Nr(),o=new Set;let h=!1;const a=n.app={_uid:yh++,_component:s,_props:r,_container:null,_context:n,_instance:null,version:Qh,get config(){return n.config},set config(c){},use(c,...p){return o.has(c)||(c&&x(c.install)?(o.add(c),c.install(a,...p)):x(c)&&(o.add(c),c(a,...p))),a},mixin(c){return n.mixins.includes(c)||n.mixins.push(c),a},component(c,p){return p?(n.components[c]=p,a):n.components[c]},directive(c,p){return p?(n.directives[c]=p,a):n.directives[c]},mount(c,p,g){if(!h){const S=Dt(s,r);return S.appContext=n,p&&e?e(S,c):t(S,c,g),h=!0,a._container=c,c.__vue_app__=a,ji(S.component)||S.component.proxy}},unmount(){h&&(t(null,a._container),delete a._container.__vue_app__)},provide(c,p){return n.provides[c]=p,a}};return a}}function Ni(t,e,i,s,r=!1){if(w(t)){t.forEach((S,T)=>Ni(S,e&&(w(e)?e[T]:e),i,s,r));return}if(Be(s)&&!r)return;const n=s.shapeFlag&4?ji(s.component)||s.component.proxy:s.el,o=r?null:n,{i:h,r:a}=t,c=e&&e.r,p=h.refs===K?h.refs={}:h.refs,g=h.setupState;if(c!=null&&c!==a&&(et(c)?(p[c]=null,V(g,c)&&(g[c]=null)):nt(c)&&(c.value=null)),x(a))Yt(a,h,12,[o,p]);else{const S=et(a),T=nt(a);if(S||T){const L=()=>{if(t.f){const k=S?p[a]:a.value;r?w(k)&&Pi(k,n):w(k)?k.includes(n)||k.push(n):S?(p[a]=[n],V(g,a)&&(g[a]=p[a])):(a.value=[n],t.k&&(p[t.k]=a.value))}else S?(p[a]=o,V(g,a)&&(g[a]=o)):T&&(a.value=o,t.k&&(p[t.k]=o))};o?(L.id=-1,ut(L,i)):L()}}}const ut=eh;function Mh(t){return Ph(t)}function Ph(t,e){const i=ln();i.__VUE__=!0;const{insert:s,remove:r,patchProp:n,createElement:o,createText:h,createComment:a,setText:c,setElementText:p,parentNode:g,nextSibling:S,setScopeId:T=bt,cloneNode:L,insertStaticContent:k}=t,O=(l,u,f,_=null,m=null,A=null,I=!1,C=null,b=!!u.dynamicChildren)=>{if(l===u)return;l&&!$t(l,u)&&(_=ye(l),Vt(l,m,A,!0),l=null),u.patchFlag===-2&&(b=!1,u.dynamicChildren=null);const{type:d,ref:N,shapeFlag:D}=u;switch(d){case Zi:y(l,u,f,_);break;case It:J(l,u,f,_);break;case ui:l==null&&Q(u,f,_,I);break;case St:ct(l,u,f,_,m,A,I,C,b);break;default:D&1?Bt(l,u,f,_,m,A,I,C,b):D&6?P(l,u,f,_,m,A,I,C,b):(D&64||D&128)&&d.process(l,u,f,_,m,A,I,C,b,ie)}N!=null&&m&&Ni(N,l&&l.ref,A,u||l,!u)},y=(l,u,f,_)=>{if(l==null)s(u.el=h(u.children),f,_);else{const m=u.el=l.el;u.children!==l.children&&c(m,u.children)}},J=(l,u,f,_)=>{l==null?s(u.el=a(u.children||""),f,_):u.el=l.el},Q=(l,u,f,_)=>{[l.el,l.anchor]=k(l.children,u,f,_,l.el,l.anchor)},H=({el:l,anchor:u},f,_)=>{let m;for(;l&&l!==u;)m=S(l),s(l,f,_),l=m;s(u,f,_)},st=({el:l,anchor:u})=>{let f;for(;l&&l!==u;)f=S(l),r(l),l=f;r(u)},Bt=(l,u,f,_,m,A,I,C,b)=>{I=I||u.type==="svg",l==null?Mt(u,f,_,m,A,I,C,b):z(l,u,m,A,I,C,b)},Mt=(l,u,f,_,m,A,I,C)=>{let b,d;const{type:N,props:D,shapeFlag:E,transition:F,patchFlag:G,dirs:W}=l;if(l.el&&L!==void 0&&G===-1)b=l.el=L(l.el);else{if(b=l.el=o(l.type,A,D&&D.is,D),E&8?p(b,l.children):E&16&&j(l.children,b,null,_,m,A&&N!=="foreignObject",I,C),W&&Zt(l,null,_,"created"),D){for(const $ in D)$!=="value"&&!Le($)&&n(b,$,null,D[$],A,l.children,_,m,wt);"value"in D&&n(b,"value",null,D.value),(d=D.onVnodeBeforeMount)&&Et(d,_,l)}B(b,l,l.scopeId,I,_)}W&&Zt(l,null,_,"beforeMount");const Z=(!m||m&&!m.pendingBranch)&&F&&!F.persisted;Z&&F.beforeEnter(b),s(b,u,f),((d=D&&D.onVnodeMounted)||Z||W)&&ut(()=>{d&&Et(d,_,l),Z&&F.enter(b),W&&Zt(l,null,_,"mounted")},m)},B=(l,u,f,_,m)=>{if(f&&T(l,f),_)for(let A=0;A<_.length;A++)T(l,_[A]);if(m){let A=m.subTree;if(u===A){const I=m.vnode;B(l,I,I.scopeId,I.slotScopeIds,m.parent)}}},j=(l,u,f,_,m,A,I,C,b=0)=>{for(let d=b;d<l.length;d++){const N=l[d]=C?Xt(l[d]):Ot(l[d]);O(null,N,u,f,_,m,A,I,C)}},z=(l,u,f,_,m,A,I)=>{const C=u.el=l.el;let{patchFlag:b,dynamicChildren:d,dirs:N}=u;b|=l.patchFlag&16;const D=l.props||K,E=u.props||K;let F;f&&Kt(f,!1),(F=E.onVnodeBeforeUpdate)&&Et(F,f,u,l),N&&Zt(u,l,f,"beforeUpdate"),f&&Kt(f,!0);const G=m&&u.type!=="foreignObject";if(d?rt(l.dynamicChildren,d,C,f,_,G,A):I||U(l,u,C,null,f,_,G,A,!1),b>0){if(b&16)at(C,u,D,E,f,_,m);else if(b&2&&D.class!==E.class&&n(C,"class",null,E.class,m),b&4&&n(C,"style",D.style,E.style,m),b&8){const W=u.dynamicProps;for(let Z=0;Z<W.length;Z++){const $=W[Z],gt=D[$],se=E[$];(se!==gt||$==="value")&&n(C,$,gt,se,m,l.children,f,_,wt)}}b&1&&l.children!==u.children&&p(C,u.children)}else!I&&d==null&&at(C,u,D,E,f,_,m);((F=E.onVnodeUpdated)||N)&&ut(()=>{F&&Et(F,f,u,l),N&&Zt(u,l,f,"updated")},_)},rt=(l,u,f,_,m,A,I)=>{for(let C=0;C<u.length;C++){const b=l[C],d=u[C],N=b.el&&(b.type===St||!$t(b,d)||b.shapeFlag&70)?g(b.el):f;O(b,d,N,null,_,m,A,I,!0)}},at=(l,u,f,_,m,A,I)=>{if(f!==_){for(const C in _){if(Le(C))continue;const b=_[C],d=f[C];b!==d&&C!=="value"&&n(l,C,d,b,I,u.children,m,A,wt)}if(f!==K)for(const C in f)!Le(C)&&!(C in _)&&n(l,C,f[C],null,I,u.children,m,A,wt);"value"in _&&n(l,"value",f.value,_.value)}},ct=(l,u,f,_,m,A,I,C,b)=>{const d=u.el=l?l.el:h(""),N=u.anchor=l?l.anchor:h("");let{patchFlag:D,dynamicChildren:E,slotScopeIds:F}=u;F&&(C=C?C.concat(F):F),l==null?(s(d,f,_),s(N,f,_),j(u.children,f,N,m,A,I,C,b)):D>0&&D&64&&E&&l.dynamicChildren?(rt(l.dynamicChildren,E,f,m,A,I,C),(u.key!=null||m&&u===m.subTree)&&Er(l,u,!0)):U(l,u,f,N,m,A,I,C,b)},P=(l,u,f,_,m,A,I,C,b)=>{u.slotScopeIds=C,l==null?u.shapeFlag&512?m.ctx.activate(u,f,_,I,b):Y(u,f,_,m,A,I,b):v(l,u,b)},Y=(l,u,f,_,m,A,I)=>{const C=l.component=Uh(l,_,m);if(ti(l)&&(C.ctx.renderer=ie),Zh(C),C.asyncDep){if(m&&m.registerDep(C,M),!l.el){const b=C.subTree=Dt(It);J(null,b,u,f)}return}M(C,l,u,f,m,A,I)},v=(l,u,f)=>{const _=u.component=l.component;if(Jn(l,u,f))if(_.asyncDep&&!_.asyncResolved){q(_,u,f);return}else _.next=u,Un(_.update),_.update();else u.el=l.el,_.vnode=u},M=(l,u,f,_,m,A,I)=>{const C=()=>{if(l.isMounted){let{next:N,bu:D,u:E,parent:F,vnode:G}=l,W=N,Z;Kt(l,!1),N?(N.el=G.el,q(l,N,I)):N=G,D&&hi(D),(Z=N.props&&N.props.onVnodeBeforeUpdate)&&Et(Z,F,N,G),Kt(l,!0);const $=oi(l),gt=l.subTree;l.subTree=$,O(gt,$,g(gt.el),ye(gt),l,m,A),N.el=$.el,W===null&&Qn(l,$.el),E&&ut(E,m),(Z=N.props&&N.props.onVnodeUpdated)&&ut(()=>Et(Z,F,N,G),m)}else{let N;const{el:D,props:E}=u,{bm:F,m:G,parent:W}=l,Z=Be(u);if(Kt(l,!1),F&&hi(F),!Z&&(N=E&&E.onVnodeBeforeMount)&&Et(N,W,u),Kt(l,!0),D&&ri){const $=()=>{l.subTree=oi(l),ri(D,l.subTree,l,m,null)};Z?u.type.__asyncLoader().then(()=>!l.isUnmounted&&$()):$()}else{const $=l.subTree=oi(l);O(null,$,f,_,l,m,A),u.el=$.el}if(G&&ut(G,m),!Z&&(N=E&&E.onVnodeMounted)){const $=u;ut(()=>Et(N,W,$),m)}(u.shapeFlag&256||W&&Be(W.vnode)&&W.vnode.shapeFlag&256)&&l.a&&ut(l.a,m),l.isMounted=!0,u=f=_=null}},b=l.effect=new ki(C,()=>rr(d),l.scope),d=l.update=()=>b.run();d.id=l.uid,Kt(l,!0),d()},q=(l,u,f)=>{u.component=l;const _=l.vnode.props;l.vnode=u,l.next=null,Nh(l,u.props,_,f),Oh(l,u.children,f),me(),Je(void 0,l.update),_e()},U=(l,u,f,_,m,A,I,C,b=!1)=>{const d=l&&l.children,N=l?l.shapeFlag:0,D=u.children,{patchFlag:E,shapeFlag:F}=u;if(E>0){if(E&128){ft(d,D,f,_,m,A,I,C,b);return}else if(E&256){Pt(d,D,f,_,m,A,I,C,b);return}}F&8?(N&16&&wt(d,m,A),D!==d&&p(f,D)):N&16?F&16?ft(d,D,f,_,m,A,I,C,b):wt(d,m,A,!0):(N&8&&p(f,""),F&16&&j(D,f,_,m,A,I,C,b))},Pt=(l,u,f,_,m,A,I,C,b)=>{l=l||oe,u=u||oe;const d=l.length,N=u.length,D=Math.min(d,N);let E;for(E=0;E<D;E++){const F=u[E]=b?Xt(u[E]):Ot(u[E]);O(l[E],F,f,null,m,A,I,C,b)}d>N?wt(l,m,A,!0,!1,D):j(u,f,_,m,A,I,C,b,D)},ft=(l,u,f,_,m,A,I,C,b)=>{let d=0;const N=u.length;let D=l.length-1,E=N-1;for(;d<=D&&d<=E;){const F=l[d],G=u[d]=b?Xt(u[d]):Ot(u[d]);if($t(F,G))O(F,G,f,null,m,A,I,C,b);else break;d++}for(;d<=D&&d<=E;){const F=l[D],G=u[E]=b?Xt(u[E]):Ot(u[E]);if($t(F,G))O(F,G,f,null,m,A,I,C,b);else break;D--,E--}if(d>D){if(d<=E){const F=E+1,G=F<N?u[F].el:_;for(;d<=E;)O(null,u[d]=b?Xt(u[d]):Ot(u[d]),f,G,m,A,I,C,b),d++}}else if(d>E)for(;d<=D;)Vt(l[d],m,A,!0),d++;else{const F=d,G=d,W=new Map;for(d=G;d<=E;d++){const pt=u[d]=b?Xt(u[d]):Ot(u[d]);pt.key!=null&&W.set(pt.key,d)}let Z,$=0;const gt=E-G+1;let se=!1,Qi=0;const de=new Array(gt);for(d=0;d<gt;d++)de[d]=0;for(d=F;d<=D;d++){const pt=l[d];if($>=gt){Vt(pt,m,A,!0);continue}let Nt;if(pt.key!=null)Nt=W.get(pt.key);else for(Z=G;Z<=E;Z++)if(de[Z-G]===0&&$t(pt,u[Z])){Nt=Z;break}Nt===void 0?Vt(pt,m,A,!0):(de[Nt-G]=d+1,Nt>=Qi?Qi=Nt:se=!0,O(pt,u[Nt],f,null,m,A,I,C,b),$++)}const ts=se?wh(de):oe;for(Z=ts.length-1,d=gt-1;d>=0;d--){const pt=G+d,Nt=u[pt],es=pt+1<N?u[pt+1].el:_;de[d]===0?O(null,Nt,f,es,m,A,I,C,b):se&&(Z<0||d!==ts[Z]?ee(Nt,f,es,2):Z--)}}},ee=(l,u,f,_,m=null)=>{const{el:A,type:I,transition:C,children:b,shapeFlag:d}=l;if(d&6){ee(l.component.subTree,u,f,_);return}if(d&128){l.suspense.move(u,f,_);return}if(d&64){I.move(l,u,f,ie);return}if(I===St){s(A,u,f);for(let D=0;D<b.length;D++)ee(b[D],u,f,_);s(l.anchor,u,f);return}if(I===ui){H(l,u,f);return}if(_!==2&&d&1&&C)if(_===0)C.beforeEnter(A),s(A,u,f),ut(()=>C.enter(A),m);else{const{leave:D,delayLeave:E,afterLeave:F}=C,G=()=>s(A,u,f),W=()=>{D(A,()=>{G(),F&&F()})};E?E(A,G,W):W()}else s(A,u,f)},Vt=(l,u,f,_=!1,m=!1)=>{const{type:A,props:I,ref:C,children:b,dynamicChildren:d,shapeFlag:N,patchFlag:D,dirs:E}=l;if(C!=null&&Ni(C,null,f,l,!0),N&256){u.ctx.deactivate(l);return}const F=N&1&&E,G=!Be(l);let W;if(G&&(W=I&&I.onVnodeBeforeUnmount)&&Et(W,u,l),N&6)Zr(l.component,f,_);else{if(N&128){l.suspense.unmount(f,_);return}F&&Zt(l,null,u,"beforeUnmount"),N&64?l.type.remove(l,u,f,m,ie,_):d&&(A!==St||D>0&&D&64)?wt(d,u,f,!1,!0):(A===St&&D&384||!m&&N&16)&&wt(b,u,f),_&&$i(l)}(G&&(W=I&&I.onVnodeUnmounted)||F)&&ut(()=>{W&&Et(W,u,l),F&&Zt(l,null,u,"unmounted")},f)},$i=l=>{const{type:u,el:f,anchor:_,transition:m}=l;if(u===St){Wr(f,_);return}if(u===ui){st(l);return}const A=()=>{r(f),m&&!m.persisted&&m.afterLeave&&m.afterLeave()};if(l.shapeFlag&1&&m&&!m.persisted){const{leave:I,delayLeave:C}=m,b=()=>I(f,A);C?C(l.el,A,b):b()}else A()},Wr=(l,u)=>{let f;for(;l!==u;)f=S(l),r(l),l=f;r(u)},Zr=(l,u,f)=>{const{bum:_,scope:m,update:A,subTree:I,um:C}=l;_&&hi(_),m.stop(),A&&(A.active=!1,Vt(I,l,u,f)),C&&ut(C,u),ut(()=>{l.isUnmounted=!0},u),u&&u.pendingBranch&&!u.isUnmounted&&l.asyncDep&&!l.asyncResolved&&l.suspenseId===u.pendingId&&(u.deps--,u.deps===0&&u.resolve())},wt=(l,u,f,_=!1,m=!1,A=0)=>{for(let I=A;I<l.length;I++)Vt(l[I],u,f,_,m)},ye=l=>l.shapeFlag&6?ye(l.component.subTree):l.shapeFlag&128?l.suspense.next():S(l.anchor||l.el),Ji=(l,u,f)=>{l==null?u._vnode&&Vt(u._vnode,null,null,!0):O(u._vnode||null,l,u,null,null,null,f),or(),u._vnode=l},ie={p:O,um:Vt,m:ee,r:$i,mt:Y,mc:j,pc:U,pbc:rt,n:ye,o:t};let si,ri;return e&&([si,ri]=e(ie)),{render:Ji,hydrate:si,createApp:Fh(Ji,si)}}function Kt({effect:t,update:e},i){t.allowRecurse=e.allowRecurse=i}function Er(t,e,i=!1){const s=t.children,r=e.children;if(w(s)&&w(r))for(let n=0;n<s.length;n++){const o=s[n];let h=r[n];h.shapeFlag&1&&!h.dynamicChildren&&((h.patchFlag<=0||h.patchFlag===32)&&(h=r[n]=Xt(r[n]),h.el=o.el),i||Er(o,h))}}function wh(t){const e=t.slice(),i=[0];let s,r,n,o,h;const a=t.length;for(s=0;s<a;s++){const c=t[s];if(c!==0){if(r=i[i.length-1],t[r]<c){e[s]=r,i.push(s);continue}for(n=0,o=i.length-1;n<o;)h=n+o>>1,t[i[h]]<c?n=h+1:o=h;c<t[i[n]]&&(n>0&&(e[s]=i[n-1]),i[n]=s)}}for(n=i.length,o=i[n-1];n-- >0;)i[n]=o,o=e[o];return i}const vh=t=>t.__isTeleport,St=Symbol(void 0),Zi=Symbol(void 0),It=Symbol(void 0),ui=Symbol(void 0),Ae=[];let At=null;function Ee(t=!1){Ae.push(At=t?null:[])}function Lh(){Ae.pop(),At=Ae[Ae.length-1]||null}let Te=1;function Ss(t){Te+=t}function Tr(t){return t.dynamicChildren=Te>0?At||oe:null,Lh(),Te>0&&At&&At.push(t),t}function Ue(t,e,i,s,r,n){return Tr(vt(t,e,i,s,r,n,!0))}function kh(t,e,i,s,r){return Tr(Dt(t,e,i,s,r,!0))}function xh(t){return t?t.__v_isVNode===!0:!1}function $t(t,e){return t.type===e.type&&t.key===e.key}const ii="__vInternal",Or=({key:t})=>t!=null?t:null,Ve=({ref:t,ref_key:e,ref_for:i})=>t!=null?et(t)||nt(t)||x(t)?{i:yt,r:t,k:e,f:!!i}:t:null;function vt(t,e=null,i=null,s=0,r=null,n=t===St?0:1,o=!1,h=!1){const a={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&Or(e),ref:e&&Ve(e),scopeId:ur,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:n,patchFlag:s,dynamicProps:r,dynamicChildren:null,appContext:null};return h?(Ki(a,i),n&128&&t.normalize(a)):i&&(a.shapeFlag|=et(i)?8:16),Te>0&&!o&&At&&(a.patchFlag>0||n&6)&&a.patchFlag!==32&&At.push(a),a}const Dt=Bh;function Bh(t,e=null,i=null,s=0,r=null,n=!1){if((!t||t===Rh)&&(t=It),xh(t)){const h=Wt(t,e,!0);return i&&Ki(h,i),Te>0&&!n&&At&&(h.shapeFlag&6?At[At.indexOf(t)]=h:At.push(h)),h.patchFlag|=-2,h}if($h(t)&&(t=t.__vccOpts),e){e=Vh(e);let{class:h,style:a}=e;h&&!et(h)&&(e.class=Fi(h)),it(a)&&(Js(a)&&!w(a)&&(a=ht({},a)),e.style=We(a))}const o=et(t)?1:th(t)?128:vh(t)?64:it(t)?4:x(t)?2:0;return vt(t,e,i,s,r,o,n,!0)}function Vh(t){return t?Js(t)||ii in t?ht({},t):t:null}function Wt(t,e,i=!1){const{props:s,ref:r,patchFlag:n,children:o}=t,h=e?Xh(s||{},e):s;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:h,key:h&&Or(h),ref:e&&e.ref?i&&r?w(r)?r.concat(Ve(e)):[r,Ve(e)]:Ve(e):r,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==St?n===-1?16:n|16:n,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Wt(t.ssContent),ssFallback:t.ssFallback&&Wt(t.ssFallback),el:t.el,anchor:t.anchor}}function Gh(t=" ",e=0){return Dt(Zi,null,t,e)}function qh(t="",e=!1){return e?(Ee(),kh(It,null,t)):Dt(It,null,t)}function Ot(t){return t==null||typeof t=="boolean"?Dt(It):w(t)?Dt(St,null,t.slice()):typeof t=="object"?Xt(t):Dt(Zi,null,String(t))}function Xt(t){return t.el===null||t.memo?t:Wt(t)}function Ki(t,e){let i=0;const{shapeFlag:s}=t;if(e==null)e=null;else if(w(e))i=16;else if(typeof e=="object")if(s&65){const r=e.default;r&&(r._c&&(r._d=!1),Ki(t,r()),r._c&&(r._d=!0));return}else{i=32;const r=e._;!r&&!(ii in e)?e._ctx=yt:r===3&&yt&&(yt.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else x(e)?(e={default:e,_ctx:yt},i=32):(e=String(e),s&64?(i=16,e=[Gh(e)]):i=8);t.children=e,t.shapeFlag|=i}function Xh(...t){const e={};for(let i=0;i<t.length;i++){const s=t[i];for(const r in s)if(r==="class")e.class!==s.class&&(e.class=Fi([e.class,s.class]));else if(r==="style")e.style=We([e.style,s.style]);else if(Ze(r)){const n=e[r],o=s[r];o&&n!==o&&!(w(n)&&n.includes(o))&&(e[r]=n?[].concat(n,o):o)}else r!==""&&(e[r]=s[r])}return e}function Et(t,e,i,s=null){Rt(t,e,7,[i,s])}const Hh=Nr();let Yh=0;function Uh(t,e,i){const s=t.type,r=(e?e.appContext:t.appContext)||Hh,n={uid:Yh++,vnode:t,type:s,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,scope:new an(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Ar(s,r),emitsOptions:ar(s,r),emit:null,emitted:null,propsDefaults:K,inheritAttrs:s.inheritAttrs,ctx:K,data:K,props:K,attrs:K,slots:K,refs:K,setupState:K,setupContext:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return n.ctx={_:n},n.root=e?e.root:n,n.emit=Kn.bind(null,n),t.ce&&t.ce(n),n}let tt=null;const Wh=()=>tt||yt,fe=t=>{tt=t,t.scope.on()},te=()=>{tt&&tt.scope.off(),tt=null};function yr(t){return t.vnode.shapeFlag&4}let Oe=!1;function Zh(t,e=!1){Oe=e;const{props:i,children:s}=t.vnode,r=yr(t);Dh(t,i,r,e),Th(t,s);const n=r?Kh(t,e):void 0;return Oe=!1,n}function Kh(t,e){const i=t.type;t.accessCache=Object.create(null),t.proxy=Qs(new Proxy(t.ctx,gh));const{setup:s}=i;if(s){const r=t.setupContext=s.length>1?zh(t):null;fe(t),me();const n=Yt(s,t,0,[t.props,r]);if(_e(),te(),xs(n)){if(n.then(te,te),e)return n.then(o=>{Cs(t,o,e)}).catch(o=>{$e(o,t,0)});t.asyncDep=n}else Cs(t,n,e)}else Fr(t,e)}function Cs(t,e,i){x(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:it(e)&&(t.setupState=ir(e)),Fr(t,i)}let As;function Fr(t,e,i){const s=t.type;if(!t.render){if(!e&&As&&!s.render){const r=s.template;if(r){const{isCustomElement:n,compilerOptions:o}=t.appContext.config,{delimiters:h,compilerOptions:a}=s,c=ht(ht({isCustomElement:n,delimiters:h},o),a);s.render=As(r,c)}}t.render=s.render||bt}fe(t),me(),Sh(t),_e(),te()}function jh(t){return new Proxy(t.attrs,{get(e,i){return _t(t,"get","$attrs"),e[i]}})}function zh(t){const e=s=>{t.exposed=s||{}};let i;return{get attrs(){return i||(i=jh(t))},slots:t.slots,emit:t.emit,expose:e}}function ji(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(ir(Qs(t.exposed)),{get(e,i){if(i in e)return e[i];if(i in He)return He[i](t)}}))}function $h(t){return x(t)&&"__vccOpts"in t}const Jh=(t,e)=>qn(t,e,Oe),Qh="3.2.37",to="http://www.w3.org/2000/svg",Jt=typeof document!="undefined"?document:null,bs=Jt&&Jt.createElement("template"),eo={insert:(t,e,i)=>{e.insertBefore(t,i||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,i,s)=>{const r=e?Jt.createElementNS(to,t):Jt.createElement(t,i?{is:i}:void 0);return t==="select"&&s&&s.multiple!=null&&r.setAttribute("multiple",s.multiple),r},createText:t=>Jt.createTextNode(t),createComment:t=>Jt.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Jt.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},cloneNode(t){const e=t.cloneNode(!0);return"_value"in t&&(e._value=t._value),e},insertStaticContent(t,e,i,s,r,n){const o=i?i.previousSibling:e.lastChild;if(r&&(r===n||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),i),!(r===n||!(r=r.nextSibling)););else{bs.innerHTML=s?`<svg>${t}</svg>`:t;const h=bs.content;if(s){const a=h.firstChild;for(;a.firstChild;)h.appendChild(a.firstChild);h.removeChild(a)}e.insertBefore(h,i)}return[o?o.nextSibling:e.firstChild,i?i.previousSibling:e.lastChild]}};function io(t,e,i){const s=t._vtc;s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?t.removeAttribute("class"):i?t.setAttribute("class",e):t.className=e}function so(t,e,i){const s=t.style,r=et(i);if(i&&!r){for(const n in i)Ei(s,n,i[n]);if(e&&!et(e))for(const n in e)i[n]==null&&Ei(s,n,"")}else{const n=s.display;r?e!==i&&(s.cssText=i):e&&t.removeAttribute("style"),"_vod"in t&&(s.display=n)}}const Is=/\s*!important$/;function Ei(t,e,i){if(w(i))i.forEach(s=>Ei(t,e,s));else if(i==null&&(i=""),e.startsWith("--"))t.setProperty(e,i);else{const s=ro(t,e);Is.test(i)?t.setProperty(pe(s),i.replace(Is,""),"important"):t[s]=i}}const Ds=["Webkit","Moz","ms"],ci={};function ro(t,e){const i=ci[e];if(i)return i;let s=ce(e);if(s!=="filter"&&s in t)return ci[e]=s;s=Gs(s);for(let r=0;r<Ds.length;r++){const n=Ds[r]+s;if(n in t)return ci[e]=n}return e}const Ns="http://www.w3.org/1999/xlink";function no(t,e,i,s,r){if(s&&e.startsWith("xlink:"))i==null?t.removeAttributeNS(Ns,e.slice(6,e.length)):t.setAttributeNS(Ns,e,i);else{const n=zr(e);i==null||n&&!ws(i)?t.removeAttribute(e):t.setAttribute(e,n?"":i)}}function ho(t,e,i,s,r,n,o){if(e==="innerHTML"||e==="textContent"){s&&o(s,r,n),t[e]=i==null?"":i;return}if(e==="value"&&t.tagName!=="PROGRESS"&&!t.tagName.includes("-")){t._value=i;const a=i==null?"":i;(t.value!==a||t.tagName==="OPTION")&&(t.value=a),i==null&&t.removeAttribute(e);return}let h=!1;if(i===""||i==null){const a=typeof t[e];a==="boolean"?i=ws(i):i==null&&a==="string"?(i="",h=!0):a==="number"&&(i=0,h=!0)}try{t[e]=i}catch{}h&&t.removeAttribute(e)}const[Mr,oo]=(()=>{let t=Date.now,e=!1;if(typeof window!="undefined"){Date.now()>document.createEvent("Event").timeStamp&&(t=performance.now.bind(performance));const i=navigator.userAgent.match(/firefox\/(\d+)/i);e=!!(i&&Number(i[1])<=53)}return[t,e]})();let Ti=0;const lo=Promise.resolve(),ao=()=>{Ti=0},uo=()=>Ti||(lo.then(ao),Ti=Mr());function co(t,e,i,s){t.addEventListener(e,i,s)}function fo(t,e,i,s){t.removeEventListener(e,i,s)}function po(t,e,i,s,r=null){const n=t._vei||(t._vei={}),o=n[e];if(s&&o)o.value=s;else{const[h,a]=mo(e);if(s){const c=n[e]=_o(s,r);co(t,h,c,a)}else o&&(fo(t,h,o,a),n[e]=void 0)}}const Es=/(?:Once|Passive|Capture)$/;function mo(t){let e;if(Es.test(t)){e={};let i;for(;i=t.match(Es);)t=t.slice(0,t.length-i[0].length),e[i[0].toLowerCase()]=!0}return[pe(t.slice(2)),e]}function _o(t,e){const i=s=>{const r=s.timeStamp||Mr();(oo||r>=i.attached-1)&&Rt(Ro(s,i.value),e,5,[s])};return i.value=t,i.attached=uo(),i}function Ro(t,e){if(w(e)){const i=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{i.call(t),t._stopped=!0},e.map(s=>r=>!r._stopped&&s&&s(r))}else return e}const Ts=/^on[a-z]/,go=(t,e,i,s,r=!1,n,o,h,a)=>{e==="class"?io(t,s,r):e==="style"?so(t,i,s):Ze(e)?Mi(e)||po(t,e,i,s,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):So(t,e,s,r))?ho(t,e,s,n,o,h,a):(e==="true-value"?t._trueValue=s:e==="false-value"&&(t._falseValue=s),no(t,e,s,r))};function So(t,e,i,s){return s?!!(e==="innerHTML"||e==="textContent"||e in t&&Ts.test(e)&&x(i)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||Ts.test(e)&&et(i)?!1:e in t}const Co={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};hh.props;const Ao=ht({patchProp:go},eo);let Os;function bo(){return Os||(Os=Mh(Ao))}const Io=(...t)=>{const e=bo().createApp(...t),{mount:i}=e;return e.mount=s=>{const r=Do(s);if(!r)return;const n=e._component;!x(n)&&!n.render&&!n.template&&(n.template=r.innerHTML),r.innerHTML="";const o=i(r,!1,r instanceof SVGElement);return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e};function Do(t){return et(t)?document.querySelector(t):t}var Ft=function(){this.state=new Array(8);for(var t=0;t<this.state.length;t++)this.state[t]=64};Ft.BUTTON_A=0;Ft.BUTTON_B=1;Ft.BUTTON_SELECT=2;Ft.BUTTON_START=3;Ft.BUTTON_UP=4;Ft.BUTTON_DOWN=5;Ft.BUTTON_LEFT=6;Ft.BUTTON_RIGHT=7;Ft.prototype={buttonDown:function(t){this.state[t]=65},buttonUp:function(t){this.state[t]=64}};var Pr=Ft,zi={copyArrayElements:function(t,e,i,s,r){for(var n=0;n<r;++n)i[s+n]=t[e+n]},copyArray:function(t){return t.slice(0)},fromJSON:function(t,e){for(var i=0;i<t.JSON_PROPERTIES.length;i++)t[t.JSON_PROPERTIES[i]]=e[t.JSON_PROPERTIES[i]]},toJSON:function(t){for(var e={},i=0;i<t.JSON_PROPERTIES.length;i++)e[t.JSON_PROPERTIES[i]]=t[t.JSON_PROPERTIES[i]];return e}},ys=zi,wr=function(t){this.nes=t,this.mem=null,this.REG_ACC=null,this.REG_X=null,this.REG_Y=null,this.REG_SP=null,this.REG_PC=null,this.REG_PC_NEW=null,this.REG_STATUS=null,this.F_CARRY=null,this.F_DECIMAL=null,this.F_INTERRUPT=null,this.F_INTERRUPT_NEW=null,this.F_OVERFLOW=null,this.F_SIGN=null,this.F_ZERO=null,this.F_NOTUSED=null,this.F_NOTUSED_NEW=null,this.F_BRK=null,this.F_BRK_NEW=null,this.opdata=null,this.cyclesToHalt=null,this.crash=null,this.irqRequested=null,this.irqType=null,this.reset()};wr.prototype={IRQ_NORMAL:0,IRQ_NMI:1,IRQ_RESET:2,reset:function(){this.mem=new Array(65536);for(var t=0;t<8192;t++)this.mem[t]=255;for(var e=0;e<4;e++){var i=e*2048;this.mem[i+8]=247,this.mem[i+9]=239,this.mem[i+10]=223,this.mem[i+15]=191}for(var s=8193;s<this.mem.length;s++)this.mem[s]=0;this.REG_ACC=0,this.REG_X=0,this.REG_Y=0,this.REG_SP=511,this.REG_PC=32768-1,this.REG_PC_NEW=32768-1,this.REG_STATUS=40,this.setStatus(40),this.F_CARRY=0,this.F_DECIMAL=0,this.F_INTERRUPT=1,this.F_INTERRUPT_NEW=1,this.F_OVERFLOW=0,this.F_SIGN=0,this.F_ZERO=1,this.F_NOTUSED=1,this.F_NOTUSED_NEW=1,this.F_BRK=1,this.F_BRK_NEW=1,this.opdata=new vr().opdata,this.cyclesToHalt=0,this.crash=!1,this.irqRequested=!1,this.irqType=null},emulate:function(){var t,e;if(this.irqRequested){switch(t=this.F_CARRY|(this.F_ZERO===0?1:0)<<1|this.F_INTERRUPT<<2|this.F_DECIMAL<<3|this.F_BRK<<4|this.F_NOTUSED<<5|this.F_OVERFLOW<<6|this.F_SIGN<<7,this.REG_PC_NEW=this.REG_PC,this.F_INTERRUPT_NEW=this.F_INTERRUPT,this.irqType){case 0:{if(this.F_INTERRUPT!==0)break;this.doIrq(t);break}case 1:{this.doNonMaskableInterrupt(t);break}case 2:{this.doResetInterrupt();break}}this.REG_PC=this.REG_PC_NEW,this.F_INTERRUPT=this.F_INTERRUPT_NEW,this.F_BRK=this.F_BRK_NEW,this.irqRequested=!1}var i=this.opdata[this.nes.mmap.load(this.REG_PC+1)],s=i>>24,r=0,n=i>>8&255,o=this.REG_PC;this.REG_PC+=i>>16&255;var h=0;switch(n){case 0:{h=this.load(o+2);break}case 1:{h=this.load(o+2),h<128?h+=this.REG_PC:h+=this.REG_PC-256;break}case 2:break;case 3:{h=this.load16bit(o+2);break}case 4:{h=this.REG_ACC;break}case 5:{h=this.REG_PC;break}case 6:{h=this.load(o+2)+this.REG_X&255;break}case 7:{h=this.load(o+2)+this.REG_Y&255;break}case 8:{h=this.load16bit(o+2),(h&65280)!==(h+this.REG_X&65280)&&(r=1),h+=this.REG_X;break}case 9:{h=this.load16bit(o+2),(h&65280)!==(h+this.REG_Y&65280)&&(r=1),h+=this.REG_Y;break}case 10:{h=this.load(o+2),(h&65280)!==(h+this.REG_X&65280)&&(r=1),h+=this.REG_X,h&=255,h=this.load16bit(h);break}case 11:{h=this.load16bit(this.load(o+2)),(h&65280)!==(h+this.REG_Y&65280)&&(r=1),h+=this.REG_Y;break}case 12:{h=this.load16bit(o+2),h<8191?h=this.mem[h]+(this.mem[h&65280|(h&255)+1&255]<<8):h=this.nes.mmap.load(h)+(this.nes.mmap.load(h&65280|(h&255)+1&255)<<8);break}}switch(h&=65535,i&255){case 0:{t=this.REG_ACC+this.load(h)+this.F_CARRY,((this.REG_ACC^this.load(h))&128)===0&&((this.REG_ACC^t)&128)!==0?this.F_OVERFLOW=1:this.F_OVERFLOW=0,this.F_CARRY=t>255?1:0,this.F_SIGN=t>>7&1,this.F_ZERO=t&255,this.REG_ACC=t&255,s+=r;break}case 1:{this.REG_ACC=this.REG_ACC&this.load(h),this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC,n!==11&&(s+=r);break}case 2:{n===4?(this.F_CARRY=this.REG_ACC>>7&1,this.REG_ACC=this.REG_ACC<<1&255,this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC):(t=this.load(h),this.F_CARRY=t>>7&1,t=t<<1&255,this.F_SIGN=t>>7&1,this.F_ZERO=t,this.write(h,t));break}case 3:{this.F_CARRY===0&&(s+=(o&65280)!==(h&65280)?2:1,this.REG_PC=h);break}case 4:{this.F_CARRY===1&&(s+=(o&65280)!==(h&65280)?2:1,this.REG_PC=h);break}case 5:{this.F_ZERO===0&&(s+=(o&65280)!==(h&65280)?2:1,this.REG_PC=h);break}case 6:{t=this.load(h),this.F_SIGN=t>>7&1,this.F_OVERFLOW=t>>6&1,t&=this.REG_ACC,this.F_ZERO=t;break}case 7:{this.F_SIGN===1&&(s++,this.REG_PC=h);break}case 8:{this.F_ZERO!==0&&(s+=(o&65280)!==(h&65280)?2:1,this.REG_PC=h);break}case 9:{this.F_SIGN===0&&(s+=(o&65280)!==(h&65280)?2:1,this.REG_PC=h);break}case 10:{this.REG_PC+=2,this.push(this.REG_PC>>8&255),this.push(this.REG_PC&255),this.F_BRK=1,this.push(this.F_CARRY|(this.F_ZERO===0?1:0)<<1|this.F_INTERRUPT<<2|this.F_DECIMAL<<3|this.F_BRK<<4|this.F_NOTUSED<<5|this.F_OVERFLOW<<6|this.F_SIGN<<7),this.F_INTERRUPT=1,this.REG_PC=this.load16bit(65534),this.REG_PC--;break}case 11:{this.F_OVERFLOW===0&&(s+=(o&65280)!==(h&65280)?2:1,this.REG_PC=h);break}case 12:{this.F_OVERFLOW===1&&(s+=(o&65280)!==(h&65280)?2:1,this.REG_PC=h);break}case 13:{this.F_CARRY=0;break}case 14:{this.F_DECIMAL=0;break}case 15:{this.F_INTERRUPT=0;break}case 16:{this.F_OVERFLOW=0;break}case 17:{t=this.REG_ACC-this.load(h),this.F_CARRY=t>=0?1:0,this.F_SIGN=t>>7&1,this.F_ZERO=t&255,s+=r;break}case 18:{t=this.REG_X-this.load(h),this.F_CARRY=t>=0?1:0,this.F_SIGN=t>>7&1,this.F_ZERO=t&255;break}case 19:{t=this.REG_Y-this.load(h),this.F_CARRY=t>=0?1:0,this.F_SIGN=t>>7&1,this.F_ZERO=t&255;break}case 20:{t=this.load(h)-1&255,this.F_SIGN=t>>7&1,this.F_ZERO=t,this.write(h,t);break}case 21:{this.REG_X=this.REG_X-1&255,this.F_SIGN=this.REG_X>>7&1,this.F_ZERO=this.REG_X;break}case 22:{this.REG_Y=this.REG_Y-1&255,this.F_SIGN=this.REG_Y>>7&1,this.F_ZERO=this.REG_Y;break}case 23:{this.REG_ACC=(this.load(h)^this.REG_ACC)&255,this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC,s+=r;break}case 24:{t=this.load(h)+1&255,this.F_SIGN=t>>7&1,this.F_ZERO=t,this.write(h,t&255);break}case 25:{this.REG_X=this.REG_X+1&255,this.F_SIGN=this.REG_X>>7&1,this.F_ZERO=this.REG_X;break}case 26:{this.REG_Y++,this.REG_Y&=255,this.F_SIGN=this.REG_Y>>7&1,this.F_ZERO=this.REG_Y;break}case 27:{this.REG_PC=h-1;break}case 28:{this.push(this.REG_PC>>8&255),this.push(this.REG_PC&255),this.REG_PC=h-1;break}case 29:{this.REG_ACC=this.load(h),this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC,s+=r;break}case 30:{this.REG_X=this.load(h),this.F_SIGN=this.REG_X>>7&1,this.F_ZERO=this.REG_X,s+=r;break}case 31:{this.REG_Y=this.load(h),this.F_SIGN=this.REG_Y>>7&1,this.F_ZERO=this.REG_Y,s+=r;break}case 32:{n===4?(t=this.REG_ACC&255,this.F_CARRY=t&1,t>>=1,this.REG_ACC=t):(t=this.load(h)&255,this.F_CARRY=t&1,t>>=1,this.write(h,t)),this.F_SIGN=0,this.F_ZERO=t;break}case 33:break;case 34:{t=(this.load(h)|this.REG_ACC)&255,this.F_SIGN=t>>7&1,this.F_ZERO=t,this.REG_ACC=t,n!==11&&(s+=r);break}case 35:{this.push(this.REG_ACC);break}case 36:{this.F_BRK=1,this.push(this.F_CARRY|(this.F_ZERO===0?1:0)<<1|this.F_INTERRUPT<<2|this.F_DECIMAL<<3|this.F_BRK<<4|this.F_NOTUSED<<5|this.F_OVERFLOW<<6|this.F_SIGN<<7);break}case 37:{this.REG_ACC=this.pull(),this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC;break}case 38:{t=this.pull(),this.F_CARRY=t&1,this.F_ZERO=(t>>1&1)===1?0:1,this.F_INTERRUPT=t>>2&1,this.F_DECIMAL=t>>3&1,this.F_BRK=t>>4&1,this.F_NOTUSED=t>>5&1,this.F_OVERFLOW=t>>6&1,this.F_SIGN=t>>7&1,this.F_NOTUSED=1;break}case 39:{n===4?(t=this.REG_ACC,e=this.F_CARRY,this.F_CARRY=t>>7&1,t=(t<<1&255)+e,this.REG_ACC=t):(t=this.load(h),e=this.F_CARRY,this.F_CARRY=t>>7&1,t=(t<<1&255)+e,this.write(h,t)),this.F_SIGN=t>>7&1,this.F_ZERO=t;break}case 40:{n===4?(e=this.F_CARRY<<7,this.F_CARRY=this.REG_ACC&1,t=(this.REG_ACC>>1)+e,this.REG_ACC=t):(t=this.load(h),e=this.F_CARRY<<7,this.F_CARRY=t&1,t=(t>>1)+e,this.write(h,t)),this.F_SIGN=t>>7&1,this.F_ZERO=t;break}case 41:{if(t=this.pull(),this.F_CARRY=t&1,this.F_ZERO=(t>>1&1)===0?1:0,this.F_INTERRUPT=t>>2&1,this.F_DECIMAL=t>>3&1,this.F_BRK=t>>4&1,this.F_NOTUSED=t>>5&1,this.F_OVERFLOW=t>>6&1,this.F_SIGN=t>>7&1,this.REG_PC=this.pull(),this.REG_PC+=this.pull()<<8,this.REG_PC===65535)return;this.REG_PC--,this.F_NOTUSED=1;break}case 42:{if(this.REG_PC=this.pull(),this.REG_PC+=this.pull()<<8,this.REG_PC===65535)return;break}case 43:{t=this.REG_ACC-this.load(h)-(1-this.F_CARRY),this.F_SIGN=t>>7&1,this.F_ZERO=t&255,((this.REG_ACC^t)&128)!==0&&((this.REG_ACC^this.load(h))&128)!==0?this.F_OVERFLOW=1:this.F_OVERFLOW=0,this.F_CARRY=t<0?0:1,this.REG_ACC=t&255,n!==11&&(s+=r);break}case 44:{this.F_CARRY=1;break}case 45:{this.F_DECIMAL=1;break}case 46:{this.F_INTERRUPT=1;break}case 47:{this.write(h,this.REG_ACC);break}case 48:{this.write(h,this.REG_X);break}case 49:{this.write(h,this.REG_Y);break}case 50:{this.REG_X=this.REG_ACC,this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC;break}case 51:{this.REG_Y=this.REG_ACC,this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC;break}case 52:{this.REG_X=this.REG_SP-256,this.F_SIGN=this.REG_SP>>7&1,this.F_ZERO=this.REG_X;break}case 53:{this.REG_ACC=this.REG_X,this.F_SIGN=this.REG_X>>7&1,this.F_ZERO=this.REG_X;break}case 54:{this.REG_SP=this.REG_X+256,this.stackWrap();break}case 55:{this.REG_ACC=this.REG_Y,this.F_SIGN=this.REG_Y>>7&1,this.F_ZERO=this.REG_Y;break}case 56:{t=this.REG_ACC&this.load(h),this.F_CARRY=t&1,this.REG_ACC=this.F_ZERO=t>>1,this.F_SIGN=0;break}case 57:{this.REG_ACC=this.F_ZERO=this.REG_ACC&this.load(h),this.F_CARRY=this.F_SIGN=this.REG_ACC>>7&1;break}case 58:{t=this.REG_ACC&this.load(h),this.REG_ACC=this.F_ZERO=(t>>1)+(this.F_CARRY<<7),this.F_SIGN=this.F_CARRY,this.F_CARRY=t>>7&1,this.F_OVERFLOW=(t>>7^t>>6)&1;break}case 59:{t=(this.REG_X&this.REG_ACC)-this.load(h),this.F_SIGN=t>>7&1,this.F_ZERO=t&255,((this.REG_X^t)&128)!==0&&((this.REG_X^this.load(h))&128)!==0?this.F_OVERFLOW=1:this.F_OVERFLOW=0,this.F_CARRY=t<0?0:1,this.REG_X=t&255;break}case 60:{this.REG_ACC=this.REG_X=this.F_ZERO=this.load(h),this.F_SIGN=this.REG_ACC>>7&1,s+=r;break}case 61:{this.write(h,this.REG_ACC&this.REG_X);break}case 62:{t=this.load(h)-1&255,this.write(h,t),t=this.REG_ACC-t,this.F_CARRY=t>=0?1:0,this.F_SIGN=t>>7&1,this.F_ZERO=t&255,n!==11&&(s+=r);break}case 63:{t=this.load(h)+1&255,this.write(h,t),t=this.REG_ACC-t-(1-this.F_CARRY),this.F_SIGN=t>>7&1,this.F_ZERO=t&255,((this.REG_ACC^t)&128)!==0&&((this.REG_ACC^this.load(h))&128)!==0?this.F_OVERFLOW=1:this.F_OVERFLOW=0,this.F_CARRY=t<0?0:1,this.REG_ACC=t&255,n!==11&&(s+=r);break}case 64:{t=this.load(h),e=this.F_CARRY,this.F_CARRY=t>>7&1,t=(t<<1&255)+e,this.write(h,t),this.REG_ACC=this.REG_ACC&t,this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC,n!==11&&(s+=r);break}case 65:{t=this.load(h),e=this.F_CARRY<<7,this.F_CARRY=t&1,t=(t>>1)+e,this.write(h,t),t=this.REG_ACC+this.load(h)+this.F_CARRY,((this.REG_ACC^this.load(h))&128)===0&&((this.REG_ACC^t)&128)!==0?this.F_OVERFLOW=1:this.F_OVERFLOW=0,this.F_CARRY=t>255?1:0,this.F_SIGN=t>>7&1,this.F_ZERO=t&255,this.REG_ACC=t&255,n!==11&&(s+=r);break}case 66:{t=this.load(h),this.F_CARRY=t>>7&1,t=t<<1&255,this.write(h,t),this.REG_ACC=this.REG_ACC|t,this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC,n!==11&&(s+=r);break}case 67:{t=this.load(h)&255,this.F_CARRY=t&1,t>>=1,this.write(h,t),this.REG_ACC=this.REG_ACC^t,this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC,n!==11&&(s+=r);break}case 68:break;case 69:{this.load(h),n!==11&&(s+=r);break}default:{this.nes.stop(),this.nes.crashMessage="Game crashed, invalid opcode at address $"+o.toString(16);break}}return s},load:function(t){return t<8192?this.mem[t&2047]:this.nes.mmap.load(t)},load16bit:function(t){return t<8191?this.mem[t&2047]|this.mem[t+1&2047]<<8:this.nes.mmap.load(t)|this.nes.mmap.load(t+1)<<8},write:function(t,e){t<8192?this.mem[t&2047]=e:this.nes.mmap.write(t,e)},requestIrq:function(t){this.irqRequested&&t===this.IRQ_NORMAL||(this.irqRequested=!0,this.irqType=t)},push:function(t){this.nes.mmap.write(this.REG_SP,t),this.REG_SP--,this.REG_SP=256|this.REG_SP&255},stackWrap:function(){this.REG_SP=256|this.REG_SP&255},pull:function(){return this.REG_SP++,this.REG_SP=256|this.REG_SP&255,this.nes.mmap.load(this.REG_SP)},pageCrossed:function(t,e){return(t&65280)!==(e&65280)},haltCycles:function(t){this.cyclesToHalt+=t},doNonMaskableInterrupt:function(t){(this.nes.mmap.load(8192)&128)!==0&&(this.REG_PC_NEW++,this.push(this.REG_PC_NEW>>8&255),this.push(this.REG_PC_NEW&255),this.push(t),this.REG_PC_NEW=this.nes.mmap.load(65530)|this.nes.mmap.load(65531)<<8,this.REG_PC_NEW--)},doResetInterrupt:function(){this.REG_PC_NEW=this.nes.mmap.load(65532)|this.nes.mmap.load(65533)<<8,this.REG_PC_NEW--},doIrq:function(t){this.REG_PC_NEW++,this.push(this.REG_PC_NEW>>8&255),this.push(this.REG_PC_NEW&255),this.push(t),this.F_INTERRUPT_NEW=1,this.F_BRK_NEW=0,this.REG_PC_NEW=this.nes.mmap.load(65534)|this.nes.mmap.load(65535)<<8,this.REG_PC_NEW--},getStatus:function(){return this.F_CARRY|this.F_ZERO<<1|this.F_INTERRUPT<<2|this.F_DECIMAL<<3|this.F_BRK<<4|this.F_NOTUSED<<5|this.F_OVERFLOW<<6|this.F_SIGN<<7},setStatus:function(t){this.F_CARRY=t&1,this.F_ZERO=t>>1&1,this.F_INTERRUPT=t>>2&1,this.F_DECIMAL=t>>3&1,this.F_BRK=t>>4&1,this.F_NOTUSED=t>>5&1,this.F_OVERFLOW=t>>6&1,this.F_SIGN=t>>7&1},JSON_PROPERTIES:["mem","cyclesToHalt","irqRequested","irqType","REG_ACC","REG_X","REG_Y","REG_SP","REG_PC","REG_PC_NEW","REG_STATUS","F_CARRY","F_DECIMAL","F_INTERRUPT","F_INTERRUPT_NEW","F_OVERFLOW","F_SIGN","F_ZERO","F_NOTUSED","F_NOTUSED_NEW","F_BRK","F_BRK_NEW"],toJSON:function(){return ys.toJSON(this)},fromJSON:function(t){ys.fromJSON(this,t)}};var vr=function(){this.opdata=new Array(256);for(var t=0;t<256;t++)this.opdata[t]=255;this.setOp(this.INS_ADC,105,this.ADDR_IMM,2,2),this.setOp(this.INS_ADC,101,this.ADDR_ZP,2,3),this.setOp(this.INS_ADC,117,this.ADDR_ZPX,2,4),this.setOp(this.INS_ADC,109,this.ADDR_ABS,3,4),this.setOp(this.INS_ADC,125,this.ADDR_ABSX,3,4),this.setOp(this.INS_ADC,121,this.ADDR_ABSY,3,4),this.setOp(this.INS_ADC,97,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_ADC,113,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_AND,41,this.ADDR_IMM,2,2),this.setOp(this.INS_AND,37,this.ADDR_ZP,2,3),this.setOp(this.INS_AND,53,this.ADDR_ZPX,2,4),this.setOp(this.INS_AND,45,this.ADDR_ABS,3,4),this.setOp(this.INS_AND,61,this.ADDR_ABSX,3,4),this.setOp(this.INS_AND,57,this.ADDR_ABSY,3,4),this.setOp(this.INS_AND,33,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_AND,49,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_ASL,10,this.ADDR_ACC,1,2),this.setOp(this.INS_ASL,6,this.ADDR_ZP,2,5),this.setOp(this.INS_ASL,22,this.ADDR_ZPX,2,6),this.setOp(this.INS_ASL,14,this.ADDR_ABS,3,6),this.setOp(this.INS_ASL,30,this.ADDR_ABSX,3,7),this.setOp(this.INS_BCC,144,this.ADDR_REL,2,2),this.setOp(this.INS_BCS,176,this.ADDR_REL,2,2),this.setOp(this.INS_BEQ,240,this.ADDR_REL,2,2),this.setOp(this.INS_BIT,36,this.ADDR_ZP,2,3),this.setOp(this.INS_BIT,44,this.ADDR_ABS,3,4),this.setOp(this.INS_BMI,48,this.ADDR_REL,2,2),this.setOp(this.INS_BNE,208,this.ADDR_REL,2,2),this.setOp(this.INS_BPL,16,this.ADDR_REL,2,2),this.setOp(this.INS_BRK,0,this.ADDR_IMP,1,7),this.setOp(this.INS_BVC,80,this.ADDR_REL,2,2),this.setOp(this.INS_BVS,112,this.ADDR_REL,2,2),this.setOp(this.INS_CLC,24,this.ADDR_IMP,1,2),this.setOp(this.INS_CLD,216,this.ADDR_IMP,1,2),this.setOp(this.INS_CLI,88,this.ADDR_IMP,1,2),this.setOp(this.INS_CLV,184,this.ADDR_IMP,1,2),this.setOp(this.INS_CMP,201,this.ADDR_IMM,2,2),this.setOp(this.INS_CMP,197,this.ADDR_ZP,2,3),this.setOp(this.INS_CMP,213,this.ADDR_ZPX,2,4),this.setOp(this.INS_CMP,205,this.ADDR_ABS,3,4),this.setOp(this.INS_CMP,221,this.ADDR_ABSX,3,4),this.setOp(this.INS_CMP,217,this.ADDR_ABSY,3,4),this.setOp(this.INS_CMP,193,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_CMP,209,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_CPX,224,this.ADDR_IMM,2,2),this.setOp(this.INS_CPX,228,this.ADDR_ZP,2,3),this.setOp(this.INS_CPX,236,this.ADDR_ABS,3,4),this.setOp(this.INS_CPY,192,this.ADDR_IMM,2,2),this.setOp(this.INS_CPY,196,this.ADDR_ZP,2,3),this.setOp(this.INS_CPY,204,this.ADDR_ABS,3,4),this.setOp(this.INS_DEC,198,this.ADDR_ZP,2,5),this.setOp(this.INS_DEC,214,this.ADDR_ZPX,2,6),this.setOp(this.INS_DEC,206,this.ADDR_ABS,3,6),this.setOp(this.INS_DEC,222,this.ADDR_ABSX,3,7),this.setOp(this.INS_DEX,202,this.ADDR_IMP,1,2),this.setOp(this.INS_DEY,136,this.ADDR_IMP,1,2),this.setOp(this.INS_EOR,73,this.ADDR_IMM,2,2),this.setOp(this.INS_EOR,69,this.ADDR_ZP,2,3),this.setOp(this.INS_EOR,85,this.ADDR_ZPX,2,4),this.setOp(this.INS_EOR,77,this.ADDR_ABS,3,4),this.setOp(this.INS_EOR,93,this.ADDR_ABSX,3,4),this.setOp(this.INS_EOR,89,this.ADDR_ABSY,3,4),this.setOp(this.INS_EOR,65,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_EOR,81,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_INC,230,this.ADDR_ZP,2,5),this.setOp(this.INS_INC,246,this.ADDR_ZPX,2,6),this.setOp(this.INS_INC,238,this.ADDR_ABS,3,6),this.setOp(this.INS_INC,254,this.ADDR_ABSX,3,7),this.setOp(this.INS_INX,232,this.ADDR_IMP,1,2),this.setOp(this.INS_INY,200,this.ADDR_IMP,1,2),this.setOp(this.INS_JMP,76,this.ADDR_ABS,3,3),this.setOp(this.INS_JMP,108,this.ADDR_INDABS,3,5),this.setOp(this.INS_JSR,32,this.ADDR_ABS,3,6),this.setOp(this.INS_LDA,169,this.ADDR_IMM,2,2),this.setOp(this.INS_LDA,165,this.ADDR_ZP,2,3),this.setOp(this.INS_LDA,181,this.ADDR_ZPX,2,4),this.setOp(this.INS_LDA,173,this.ADDR_ABS,3,4),this.setOp(this.INS_LDA,189,this.ADDR_ABSX,3,4),this.setOp(this.INS_LDA,185,this.ADDR_ABSY,3,4),this.setOp(this.INS_LDA,161,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_LDA,177,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_LDX,162,this.ADDR_IMM,2,2),this.setOp(this.INS_LDX,166,this.ADDR_ZP,2,3),this.setOp(this.INS_LDX,182,this.ADDR_ZPY,2,4),this.setOp(this.INS_LDX,174,this.ADDR_ABS,3,4),this.setOp(this.INS_LDX,190,this.ADDR_ABSY,3,4),this.setOp(this.INS_LDY,160,this.ADDR_IMM,2,2),this.setOp(this.INS_LDY,164,this.ADDR_ZP,2,3),this.setOp(this.INS_LDY,180,this.ADDR_ZPX,2,4),this.setOp(this.INS_LDY,172,this.ADDR_ABS,3,4),this.setOp(this.INS_LDY,188,this.ADDR_ABSX,3,4),this.setOp(this.INS_LSR,74,this.ADDR_ACC,1,2),this.setOp(this.INS_LSR,70,this.ADDR_ZP,2,5),this.setOp(this.INS_LSR,86,this.ADDR_ZPX,2,6),this.setOp(this.INS_LSR,78,this.ADDR_ABS,3,6),this.setOp(this.INS_LSR,94,this.ADDR_ABSX,3,7),this.setOp(this.INS_NOP,26,this.ADDR_IMP,1,2),this.setOp(this.INS_NOP,58,this.ADDR_IMP,1,2),this.setOp(this.INS_NOP,90,this.ADDR_IMP,1,2),this.setOp(this.INS_NOP,122,this.ADDR_IMP,1,2),this.setOp(this.INS_NOP,218,this.ADDR_IMP,1,2),this.setOp(this.INS_NOP,234,this.ADDR_IMP,1,2),this.setOp(this.INS_NOP,250,this.ADDR_IMP,1,2),this.setOp(this.INS_ORA,9,this.ADDR_IMM,2,2),this.setOp(this.INS_ORA,5,this.ADDR_ZP,2,3),this.setOp(this.INS_ORA,21,this.ADDR_ZPX,2,4),this.setOp(this.INS_ORA,13,this.ADDR_ABS,3,4),this.setOp(this.INS_ORA,29,this.ADDR_ABSX,3,4),this.setOp(this.INS_ORA,25,this.ADDR_ABSY,3,4),this.setOp(this.INS_ORA,1,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_ORA,17,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_PHA,72,this.ADDR_IMP,1,3),this.setOp(this.INS_PHP,8,this.ADDR_IMP,1,3),this.setOp(this.INS_PLA,104,this.ADDR_IMP,1,4),this.setOp(this.INS_PLP,40,this.ADDR_IMP,1,4),this.setOp(this.INS_ROL,42,this.ADDR_ACC,1,2),this.setOp(this.INS_ROL,38,this.ADDR_ZP,2,5),this.setOp(this.INS_ROL,54,this.ADDR_ZPX,2,6),this.setOp(this.INS_ROL,46,this.ADDR_ABS,3,6),this.setOp(this.INS_ROL,62,this.ADDR_ABSX,3,7),this.setOp(this.INS_ROR,106,this.ADDR_ACC,1,2),this.setOp(this.INS_ROR,102,this.ADDR_ZP,2,5),this.setOp(this.INS_ROR,118,this.ADDR_ZPX,2,6),this.setOp(this.INS_ROR,110,this.ADDR_ABS,3,6),this.setOp(this.INS_ROR,126,this.ADDR_ABSX,3,7),this.setOp(this.INS_RTI,64,this.ADDR_IMP,1,6),this.setOp(this.INS_RTS,96,this.ADDR_IMP,1,6),this.setOp(this.INS_SBC,233,this.ADDR_IMM,2,2),this.setOp(this.INS_SBC,229,this.ADDR_ZP,2,3),this.setOp(this.INS_SBC,245,this.ADDR_ZPX,2,4),this.setOp(this.INS_SBC,237,this.ADDR_ABS,3,4),this.setOp(this.INS_SBC,253,this.ADDR_ABSX,3,4),this.setOp(this.INS_SBC,249,this.ADDR_ABSY,3,4),this.setOp(this.INS_SBC,225,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_SBC,241,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_SEC,56,this.ADDR_IMP,1,2),this.setOp(this.INS_SED,248,this.ADDR_IMP,1,2),this.setOp(this.INS_SEI,120,this.ADDR_IMP,1,2),this.setOp(this.INS_STA,133,this.ADDR_ZP,2,3),this.setOp(this.INS_STA,149,this.ADDR_ZPX,2,4),this.setOp(this.INS_STA,141,this.ADDR_ABS,3,4),this.setOp(this.INS_STA,157,this.ADDR_ABSX,3,5),this.setOp(this.INS_STA,153,this.ADDR_ABSY,3,5),this.setOp(this.INS_STA,129,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_STA,145,this.ADDR_POSTIDXIND,2,6),this.setOp(this.INS_STX,134,this.ADDR_ZP,2,3),this.setOp(this.INS_STX,150,this.ADDR_ZPY,2,4),this.setOp(this.INS_STX,142,this.ADDR_ABS,3,4),this.setOp(this.INS_STY,132,this.ADDR_ZP,2,3),this.setOp(this.INS_STY,148,this.ADDR_ZPX,2,4),this.setOp(this.INS_STY,140,this.ADDR_ABS,3,4),this.setOp(this.INS_TAX,170,this.ADDR_IMP,1,2),this.setOp(this.INS_TAY,168,this.ADDR_IMP,1,2),this.setOp(this.INS_TSX,186,this.ADDR_IMP,1,2),this.setOp(this.INS_TXA,138,this.ADDR_IMP,1,2),this.setOp(this.INS_TXS,154,this.ADDR_IMP,1,2),this.setOp(this.INS_TYA,152,this.ADDR_IMP,1,2),this.setOp(this.INS_ALR,75,this.ADDR_IMM,2,2),this.setOp(this.INS_ANC,11,this.ADDR_IMM,2,2),this.setOp(this.INS_ANC,43,this.ADDR_IMM,2,2),this.setOp(this.INS_ARR,107,this.ADDR_IMM,2,2),this.setOp(this.INS_AXS,203,this.ADDR_IMM,2,2),this.setOp(this.INS_LAX,163,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_LAX,167,this.ADDR_ZP,2,3),this.setOp(this.INS_LAX,175,this.ADDR_ABS,3,4),this.setOp(this.INS_LAX,179,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_LAX,183,this.ADDR_ZPY,2,4),this.setOp(this.INS_LAX,191,this.ADDR_ABSY,3,4),this.setOp(this.INS_SAX,131,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_SAX,135,this.ADDR_ZP,2,3),this.setOp(this.INS_SAX,143,this.ADDR_ABS,3,4),this.setOp(this.INS_SAX,151,this.ADDR_ZPY,2,4),this.setOp(this.INS_DCP,195,this.ADDR_PREIDXIND,2,8),this.setOp(this.INS_DCP,199,this.ADDR_ZP,2,5),this.setOp(this.INS_DCP,207,this.ADDR_ABS,3,6),this.setOp(this.INS_DCP,211,this.ADDR_POSTIDXIND,2,8),this.setOp(this.INS_DCP,215,this.ADDR_ZPX,2,6),this.setOp(this.INS_DCP,219,this.ADDR_ABSY,3,7),this.setOp(this.INS_DCP,223,this.ADDR_ABSX,3,7),this.setOp(this.INS_ISC,227,this.ADDR_PREIDXIND,2,8),this.setOp(this.INS_ISC,231,this.ADDR_ZP,2,5),this.setOp(this.INS_ISC,239,this.ADDR_ABS,3,6),this.setOp(this.INS_ISC,243,this.ADDR_POSTIDXIND,2,8),this.setOp(this.INS_ISC,247,this.ADDR_ZPX,2,6),this.setOp(this.INS_ISC,251,this.ADDR_ABSY,3,7),this.setOp(this.INS_ISC,255,this.ADDR_ABSX,3,7),this.setOp(this.INS_RLA,35,this.ADDR_PREIDXIND,2,8),this.setOp(this.INS_RLA,39,this.ADDR_ZP,2,5),this.setOp(this.INS_RLA,47,this.ADDR_ABS,3,6),this.setOp(this.INS_RLA,51,this.ADDR_POSTIDXIND,2,8),this.setOp(this.INS_RLA,55,this.ADDR_ZPX,2,6),this.setOp(this.INS_RLA,59,this.ADDR_ABSY,3,7),this.setOp(this.INS_RLA,63,this.ADDR_ABSX,3,7),this.setOp(this.INS_RRA,99,this.ADDR_PREIDXIND,2,8),this.setOp(this.INS_RRA,103,this.ADDR_ZP,2,5),this.setOp(this.INS_RRA,111,this.ADDR_ABS,3,6),this.setOp(this.INS_RRA,115,this.ADDR_POSTIDXIND,2,8),this.setOp(this.INS_RRA,119,this.ADDR_ZPX,2,6),this.setOp(this.INS_RRA,123,this.ADDR_ABSY,3,7),this.setOp(this.INS_RRA,127,this.ADDR_ABSX,3,7),this.setOp(this.INS_SLO,3,this.ADDR_PREIDXIND,2,8),this.setOp(this.INS_SLO,7,this.ADDR_ZP,2,5),this.setOp(this.INS_SLO,15,this.ADDR_ABS,3,6),this.setOp(this.INS_SLO,19,this.ADDR_POSTIDXIND,2,8),this.setOp(this.INS_SLO,23,this.ADDR_ZPX,2,6),this.setOp(this.INS_SLO,27,this.ADDR_ABSY,3,7),this.setOp(this.INS_SLO,31,this.ADDR_ABSX,3,7),this.setOp(this.INS_SRE,67,this.ADDR_PREIDXIND,2,8),this.setOp(this.INS_SRE,71,this.ADDR_ZP,2,5),this.setOp(this.INS_SRE,79,this.ADDR_ABS,3,6),this.setOp(this.INS_SRE,83,this.ADDR_POSTIDXIND,2,8),this.setOp(this.INS_SRE,87,this.ADDR_ZPX,2,6),this.setOp(this.INS_SRE,91,this.ADDR_ABSY,3,7),this.setOp(this.INS_SRE,95,this.ADDR_ABSX,3,7),this.setOp(this.INS_SKB,128,this.ADDR_IMM,2,2),this.setOp(this.INS_SKB,130,this.ADDR_IMM,2,2),this.setOp(this.INS_SKB,137,this.ADDR_IMM,2,2),this.setOp(this.INS_SKB,194,this.ADDR_IMM,2,2),this.setOp(this.INS_SKB,226,this.ADDR_IMM,2,2),this.setOp(this.INS_IGN,12,this.ADDR_ABS,3,4),this.setOp(this.INS_IGN,28,this.ADDR_ABSX,3,4),this.setOp(this.INS_IGN,60,this.ADDR_ABSX,3,4),this.setOp(this.INS_IGN,92,this.ADDR_ABSX,3,4),this.setOp(this.INS_IGN,124,this.ADDR_ABSX,3,4),this.setOp(this.INS_IGN,220,this.ADDR_ABSX,3,4),this.setOp(this.INS_IGN,252,this.ADDR_ABSX,3,4),this.setOp(this.INS_IGN,4,this.ADDR_ZP,2,3),this.setOp(this.INS_IGN,68,this.ADDR_ZP,2,3),this.setOp(this.INS_IGN,100,this.ADDR_ZP,2,3),this.setOp(this.INS_IGN,20,this.ADDR_ZPX,2,4),this.setOp(this.INS_IGN,52,this.ADDR_ZPX,2,4),this.setOp(this.INS_IGN,84,this.ADDR_ZPX,2,4),this.setOp(this.INS_IGN,116,this.ADDR_ZPX,2,4),this.setOp(this.INS_IGN,212,this.ADDR_ZPX,2,4),this.setOp(this.INS_IGN,244,this.ADDR_ZPX,2,4),this.cycTable=new Array(7,6,2,8,3,3,5,5,3,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7,6,6,2,8,3,3,5,5,4,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7,6,6,2,8,3,3,5,5,3,2,2,2,3,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7,6,6,2,8,3,3,5,5,4,2,2,2,5,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7,2,6,2,6,3,3,3,3,2,2,2,2,4,4,4,4,2,6,2,6,4,4,4,4,2,5,2,5,5,5,5,5,2,6,2,6,3,3,3,3,2,2,2,2,4,4,4,4,2,5,2,5,4,4,4,4,2,4,2,4,4,4,4,4,2,6,2,8,3,3,5,5,2,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7,2,6,3,8,3,3,5,5,2,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7),this.instname=new Array(70),this.instname[0]="ADC",this.instname[1]="AND",this.instname[2]="ASL",this.instname[3]="BCC",this.instname[4]="BCS",this.instname[5]="BEQ",this.instname[6]="BIT",this.instname[7]="BMI",this.instname[8]="BNE",this.instname[9]="BPL",this.instname[10]="BRK",this.instname[11]="BVC",this.instname[12]="BVS",this.instname[13]="CLC",this.instname[14]="CLD",this.instname[15]="CLI",this.instname[16]="CLV",this.instname[17]="CMP",this.instname[18]="CPX",this.instname[19]="CPY",this.instname[20]="DEC",this.instname[21]="DEX",this.instname[22]="DEY",this.instname[23]="EOR",this.instname[24]="INC",this.instname[25]="INX",this.instname[26]="INY",this.instname[27]="JMP",this.instname[28]="JSR",this.instname[29]="LDA",this.instname[30]="LDX",this.instname[31]="LDY",this.instname[32]="LSR",this.instname[33]="NOP",this.instname[34]="ORA",this.instname[35]="PHA",this.instname[36]="PHP",this.instname[37]="PLA",this.instname[38]="PLP",this.instname[39]="ROL",this.instname[40]="ROR",this.instname[41]="RTI",this.instname[42]="RTS",this.instname[43]="SBC",this.instname[44]="SEC",this.instname[45]="SED",this.instname[46]="SEI",this.instname[47]="STA",this.instname[48]="STX",this.instname[49]="STY",this.instname[50]="TAX",this.instname[51]="TAY",this.instname[52]="TSX",this.instname[53]="TXA",this.instname[54]="TXS",this.instname[55]="TYA",this.instname[56]="ALR",this.instname[57]="ANC",this.instname[58]="ARR",this.instname[59]="AXS",this.instname[60]="LAX",this.instname[61]="SAX",this.instname[62]="DCP",this.instname[63]="ISC",this.instname[64]="RLA",this.instname[65]="RRA",this.instname[66]="SLO",this.instname[67]="SRE",this.instname[68]="SKB",this.instname[69]="IGN",this.addrDesc=new Array("Zero Page           ","Relative            ","Implied             ","Absolute            ","Accumulator         ","Immediate           ","Zero Page,X         ","Zero Page,Y         ","Absolute,X          ","Absolute,Y          ","Preindexed Indirect ","Postindexed Indirect","Indirect Absolute   ")};vr.prototype={INS_ADC:0,INS_AND:1,INS_ASL:2,INS_BCC:3,INS_BCS:4,INS_BEQ:5,INS_BIT:6,INS_BMI:7,INS_BNE:8,INS_BPL:9,INS_BRK:10,INS_BVC:11,INS_BVS:12,INS_CLC:13,INS_CLD:14,INS_CLI:15,INS_CLV:16,INS_CMP:17,INS_CPX:18,INS_CPY:19,INS_DEC:20,INS_DEX:21,INS_DEY:22,INS_EOR:23,INS_INC:24,INS_INX:25,INS_INY:26,INS_JMP:27,INS_JSR:28,INS_LDA:29,INS_LDX:30,INS_LDY:31,INS_LSR:32,INS_NOP:33,INS_ORA:34,INS_PHA:35,INS_PHP:36,INS_PLA:37,INS_PLP:38,INS_ROL:39,INS_ROR:40,INS_RTI:41,INS_RTS:42,INS_SBC:43,INS_SEC:44,INS_SED:45,INS_SEI:46,INS_STA:47,INS_STX:48,INS_STY:49,INS_TAX:50,INS_TAY:51,INS_TSX:52,INS_TXA:53,INS_TXS:54,INS_TYA:55,INS_ALR:56,INS_ANC:57,INS_ARR:58,INS_AXS:59,INS_LAX:60,INS_SAX:61,INS_DCP:62,INS_ISC:63,INS_RLA:64,INS_RRA:65,INS_SLO:66,INS_SRE:67,INS_SKB:68,INS_IGN:69,INS_DUMMY:70,ADDR_ZP:0,ADDR_REL:1,ADDR_IMP:2,ADDR_ABS:3,ADDR_ACC:4,ADDR_IMM:5,ADDR_ZPX:6,ADDR_ZPY:7,ADDR_ABSX:8,ADDR_ABSY:9,ADDR_PREIDXIND:10,ADDR_POSTIDXIND:11,ADDR_INDABS:12,setOp:function(t,e,i,s,r){this.opdata[e]=t&255|(i&255)<<8|(s&255)<<16|(r&255)<<24}};var No=wr,Lr=function(){this.pix=new Array(64),this.fbIndex=null,this.tIndex=null,this.x=null,this.y=null,this.w=null,this.h=null,this.incX=null,this.incY=null,this.palIndex=null,this.tpri=null,this.c=null,this.initialized=!1,this.opaque=new Array(8)};Lr.prototype={setBuffer:function(t){for(this.y=0;this.y<8;this.y++)this.setScanline(this.y,t[this.y],t[this.y+8])},setScanline:function(t,e,i){for(this.initialized=!0,this.tIndex=t<<3,this.x=0;this.x<8;this.x++)this.pix[this.tIndex+this.x]=(e>>7-this.x&1)+((i>>7-this.x&1)<<1),this.pix[this.tIndex+this.x]===0&&(this.opaque[t]=!1)},render:function(t,e,i,s,r,n,o,h,a,c,p,g,S){if(!(n<-7||n>=256||o<-7||o>=240))if(this.w=s-e,this.h=r-i,n<0&&(e-=n),n+s>=256&&(s=256-n),o<0&&(i-=o),o+r>=240&&(r=240-o),!c&&!p)for(this.fbIndex=(o<<8)+n,this.tIndex=0,this.y=0;this.y<8;this.y++){for(this.x=0;this.x<8;this.x++)this.x>=e&&this.x<s&&this.y>=i&&this.y<r&&(this.palIndex=this.pix[this.tIndex],this.tpri=S[this.fbIndex],this.palIndex!==0&&g<=(this.tpri&255)&&(t[this.fbIndex]=a[this.palIndex+h],this.tpri=this.tpri&3840|g,S[this.fbIndex]=this.tpri)),this.fbIndex++,this.tIndex++;this.fbIndex-=8,this.fbIndex+=256}else if(c&&!p)for(this.fbIndex=(o<<8)+n,this.tIndex=7,this.y=0;this.y<8;this.y++){for(this.x=0;this.x<8;this.x++)this.x>=e&&this.x<s&&this.y>=i&&this.y<r&&(this.palIndex=this.pix[this.tIndex],this.tpri=S[this.fbIndex],this.palIndex!==0&&g<=(this.tpri&255)&&(t[this.fbIndex]=a[this.palIndex+h],this.tpri=this.tpri&3840|g,S[this.fbIndex]=this.tpri)),this.fbIndex++,this.tIndex--;this.fbIndex-=8,this.fbIndex+=256,this.tIndex+=16}else if(p&&!c)for(this.fbIndex=(o<<8)+n,this.tIndex=56,this.y=0;this.y<8;this.y++){for(this.x=0;this.x<8;this.x++)this.x>=e&&this.x<s&&this.y>=i&&this.y<r&&(this.palIndex=this.pix[this.tIndex],this.tpri=S[this.fbIndex],this.palIndex!==0&&g<=(this.tpri&255)&&(t[this.fbIndex]=a[this.palIndex+h],this.tpri=this.tpri&3840|g,S[this.fbIndex]=this.tpri)),this.fbIndex++,this.tIndex++;this.fbIndex-=8,this.fbIndex+=256,this.tIndex-=16}else for(this.fbIndex=(o<<8)+n,this.tIndex=63,this.y=0;this.y<8;this.y++){for(this.x=0;this.x<8;this.x++)this.x>=e&&this.x<s&&this.y>=i&&this.y<r&&(this.palIndex=this.pix[this.tIndex],this.tpri=S[this.fbIndex],this.palIndex!==0&&g<=(this.tpri&255)&&(t[this.fbIndex]=a[this.palIndex+h],this.tpri=this.tpri&3840|g,S[this.fbIndex]=this.tpri)),this.fbIndex++,this.tIndex--;this.fbIndex-=8,this.fbIndex+=256}},isTransparent:function(t,e){return this.pix[(e<<3)+t]===0},toJSON:function(){return{opaque:this.opaque,pix:this.pix}},fromJSON:function(t){this.opaque=t.opaque,this.pix=t.pix}};var kr=Lr,Eo=kr,Fs=zi,xr=function(t){this.nes=t,this.vramMem=null,this.spriteMem=null,this.vramAddress=null,this.vramTmpAddress=null,this.vramBufferedReadValue=null,this.firstWrite=null,this.sramAddress=null,this.currentMirroring=null,this.requestEndFrame=null,this.nmiOk=null,this.dummyCycleToggle=null,this.validTileData=null,this.nmiCounter=null,this.scanlineAlreadyRendered=null,this.f_nmiOnVblank=null,this.f_spriteSize=null,this.f_bgPatternTable=null,this.f_spPatternTable=null,this.f_addrInc=null,this.f_nTblAddress=null,this.f_color=null,this.f_spVisibility=null,this.f_bgVisibility=null,this.f_spClipping=null,this.f_bgClipping=null,this.f_dispType=null,this.cntFV=null,this.cntV=null,this.cntH=null,this.cntVT=null,this.cntHT=null,this.regFV=null,this.regV=null,this.regH=null,this.regVT=null,this.regHT=null,this.regFH=null,this.regS=null,this.curNt=null,this.attrib=null,this.buffer=null,this.bgbuffer=null,this.pixrendered=null,this.validTileData=null,this.scantile=null,this.scanline=null,this.lastRenderedScanline=null,this.curX=null,this.sprX=null,this.sprY=null,this.sprTile=null,this.sprCol=null,this.vertFlip=null,this.horiFlip=null,this.bgPriority=null,this.spr0HitX=null,this.spr0HitY=null,this.hitSpr0=null,this.sprPalette=null,this.imgPalette=null,this.ptTile=null,this.ntable1=null,this.currentMirroring=null,this.nameTable=null,this.vramMirrorTable=null,this.palTable=null,this.showSpr0Hit=!1,this.clipToTvSize=!0,this.reset()};xr.prototype={STATUS_VRAMWRITE:4,STATUS_SLSPRITECOUNT:5,STATUS_SPRITE0HIT:6,STATUS_VBLANK:7,reset:function(){var t;for(this.vramMem=new Array(32768),this.spriteMem=new Array(256),t=0;t<this.vramMem.length;t++)this.vramMem[t]=0;for(t=0;t<this.spriteMem.length;t++)this.spriteMem[t]=0;for(this.vramAddress=null,this.vramTmpAddress=null,this.vramBufferedReadValue=0,this.firstWrite=!0,this.sramAddress=0,this.currentMirroring=-1,this.requestEndFrame=!1,this.nmiOk=!1,this.dummyCycleToggle=!1,this.validTileData=!1,this.nmiCounter=0,this.scanlineAlreadyRendered=null,this.f_nmiOnVblank=0,this.f_spriteSize=0,this.f_bgPatternTable=0,this.f_spPatternTable=0,this.f_addrInc=0,this.f_nTblAddress=0,this.f_color=0,this.f_spVisibility=0,this.f_bgVisibility=0,this.f_spClipping=0,this.f_bgClipping=0,this.f_dispType=0,this.cntFV=0,this.cntV=0,this.cntH=0,this.cntVT=0,this.cntHT=0,this.regFV=0,this.regV=0,this.regH=0,this.regVT=0,this.regHT=0,this.regFH=0,this.regS=0,this.curNt=null,this.attrib=new Array(32),this.buffer=new Array(256*240),this.bgbuffer=new Array(256*240),this.pixrendered=new Array(256*240),this.validTileData=null,this.scantile=new Array(32),this.scanline=0,this.lastRenderedScanline=-1,this.curX=0,this.sprX=new Array(64),this.sprY=new Array(64),this.sprTile=new Array(64),this.sprCol=new Array(64),this.vertFlip=new Array(64),this.horiFlip=new Array(64),this.bgPriority=new Array(64),this.spr0HitX=0,this.spr0HitY=0,this.hitSpr0=!1,this.sprPalette=new Array(16),this.imgPalette=new Array(16),this.ptTile=new Array(512),t=0;t<512;t++)this.ptTile[t]=new Eo;for(this.ntable1=new Array(4),this.currentMirroring=-1,this.nameTable=new Array(4),t=0;t<4;t++)this.nameTable[t]=new Br(32,32,"Nt"+t);for(this.vramMirrorTable=new Array(32768),t=0;t<32768;t++)this.vramMirrorTable[t]=t;this.palTable=new Vr,this.palTable.loadNTSCPalette(),this.updateControlReg1(0),this.updateControlReg2(0)},setMirroring:function(t){if(t!==this.currentMirroring){this.currentMirroring=t,this.triggerRendering(),this.vramMirrorTable===null&&(this.vramMirrorTable=new Array(32768));for(var e=0;e<32768;e++)this.vramMirrorTable[e]=e;this.defineMirrorRegion(16160,16128,32),this.defineMirrorRegion(16192,16128,32),this.defineMirrorRegion(16256,16128,32),this.defineMirrorRegion(16320,16128,32),this.defineMirrorRegion(12288,8192,3840),this.defineMirrorRegion(16384,0,16384),t===this.nes.rom.HORIZONTAL_MIRRORING?(this.ntable1[0]=0,this.ntable1[1]=0,this.ntable1[2]=1,this.ntable1[3]=1,this.defineMirrorRegion(9216,8192,1024),this.defineMirrorRegion(11264,10240,1024)):t===this.nes.rom.VERTICAL_MIRRORING?(this.ntable1[0]=0,this.ntable1[1]=1,this.ntable1[2]=0,this.ntable1[3]=1,this.defineMirrorRegion(10240,8192,1024),this.defineMirrorRegion(11264,9216,1024)):t===this.nes.rom.SINGLESCREEN_MIRRORING?(this.ntable1[0]=0,this.ntable1[1]=0,this.ntable1[2]=0,this.ntable1[3]=0,this.defineMirrorRegion(9216,8192,1024),this.defineMirrorRegion(10240,8192,1024),this.defineMirrorRegion(11264,8192,1024)):t===this.nes.rom.SINGLESCREEN_MIRRORING2?(this.ntable1[0]=1,this.ntable1[1]=1,this.ntable1[2]=1,this.ntable1[3]=1,this.defineMirrorRegion(9216,9216,1024),this.defineMirrorRegion(10240,9216,1024),this.defineMirrorRegion(11264,9216,1024)):(this.ntable1[0]=0,this.ntable1[1]=1,this.ntable1[2]=2,this.ntable1[3]=3)}},defineMirrorRegion:function(t,e,i){for(var s=0;s<i;s++)this.vramMirrorTable[t+s]=e+s},startVBlank:function(){this.nes.cpu.requestIrq(this.nes.cpu.IRQ_NMI),this.lastRenderedScanline<239&&this.renderFramePartially(this.lastRenderedScanline+1,240-this.lastRenderedScanline),this.endFrame(),this.lastRenderedScanline=-1},endScanline:function(){switch(this.scanline){case 19:this.dummyCycleToggle&&(this.curX=1,this.dummyCycleToggle=!this.dummyCycleToggle);break;case 20:this.setStatusFlag(this.STATUS_VBLANK,!1),this.setStatusFlag(this.STATUS_SPRITE0HIT,!1),this.hitSpr0=!1,this.spr0HitX=-1,this.spr0HitY=-1,(this.f_bgVisibility===1||this.f_spVisibility===1)&&(this.cntFV=this.regFV,this.cntV=this.regV,this.cntH=this.regH,this.cntVT=this.regVT,this.cntHT=this.regHT,this.f_bgVisibility===1&&this.renderBgScanline(!1,0)),this.f_bgVisibility===1&&this.f_spVisibility===1&&this.checkSprite0(0),(this.f_bgVisibility===1||this.f_spVisibility===1)&&this.nes.mmap.clockIrqCounter();break;case 261:this.setStatusFlag(this.STATUS_VBLANK,!0),this.requestEndFrame=!0,this.nmiCounter=9,this.scanline=-1;break;default:this.scanline>=21&&this.scanline<=260&&(this.f_bgVisibility===1&&(this.scanlineAlreadyRendered||(this.cntHT=this.regHT,this.cntH=this.regH,this.renderBgScanline(!0,this.scanline+1-21)),this.scanlineAlreadyRendered=!1,!this.hitSpr0&&this.f_spVisibility===1&&this.sprX[0]>=-7&&this.sprX[0]<256&&this.sprY[0]+1<=this.scanline-20&&this.sprY[0]+1+(this.f_spriteSize===0?8:16)>=this.scanline-20&&this.checkSprite0(this.scanline-20)&&(this.hitSpr0=!0)),(this.f_bgVisibility===1||this.f_spVisibility===1)&&this.nes.mmap.clockIrqCounter())}this.scanline++,this.regsToAddress(),this.cntsToAddress()},startFrame:function(){var t=0;if(this.f_dispType===0)t=this.imgPalette[0];else switch(this.f_color){case 0:t=0;break;case 1:t=65280;break;case 2:t=16711680;break;case 3:t=0;break;case 4:t=255;break;default:t=0}var e=this.buffer,i;for(i=0;i<256*240;i++)e[i]=t;var s=this.pixrendered;for(i=0;i<s.length;i++)s[i]=65},endFrame:function(){var t,e,i,s=this.buffer;if(this.showSpr0Hit){if(this.sprX[0]>=0&&this.sprX[0]<256&&this.sprY[0]>=0&&this.sprY[0]<240){for(t=0;t<256;t++)s[(this.sprY[0]<<8)+t]=16733525;for(t=0;t<240;t++)s[(t<<8)+this.sprX[0]]=16733525}if(this.spr0HitX>=0&&this.spr0HitX<256&&this.spr0HitY>=0&&this.spr0HitY<240){for(t=0;t<256;t++)s[(this.spr0HitY<<8)+t]=5635925;for(t=0;t<240;t++)s[(t<<8)+this.spr0HitX]=5635925}}if(this.clipToTvSize||this.f_bgClipping===0||this.f_spClipping===0)for(i=0;i<240;i++)for(e=0;e<8;e++)s[(i<<8)+e]=0;if(this.clipToTvSize)for(i=0;i<240;i++)for(e=0;e<8;e++)s[(i<<8)+255-e]=0;if(this.clipToTvSize)for(i=0;i<8;i++)for(e=0;e<256;e++)s[(i<<8)+e]=0,s[(239-i<<8)+e]=0;this.nes.ui.writeFrame(s)},updateControlReg1:function(t){this.triggerRendering(),this.f_nmiOnVblank=t>>7&1,this.f_spriteSize=t>>5&1,this.f_bgPatternTable=t>>4&1,this.f_spPatternTable=t>>3&1,this.f_addrInc=t>>2&1,this.f_nTblAddress=t&3,this.regV=t>>1&1,this.regH=t&1,this.regS=t>>4&1},updateControlReg2:function(t){this.triggerRendering(),this.f_color=t>>5&7,this.f_spVisibility=t>>4&1,this.f_bgVisibility=t>>3&1,this.f_spClipping=t>>2&1,this.f_bgClipping=t>>1&1,this.f_dispType=t&1,this.f_dispType===0&&this.palTable.setEmphasis(this.f_color),this.updatePalettes()},setStatusFlag:function(t,e){var i=1<<t;this.nes.cpu.mem[8194]=this.nes.cpu.mem[8194]&255-i|(e?i:0)},readStatusRegister:function(){var t=this.nes.cpu.mem[8194];return this.firstWrite=!0,this.setStatusFlag(this.STATUS_VBLANK,!1),t},writeSRAMAddress:function(t){this.sramAddress=t},sramLoad:function(){return this.spriteMem[this.sramAddress]},sramWrite:function(t){this.spriteMem[this.sramAddress]=t,this.spriteRamWriteUpdate(this.sramAddress,t),this.sramAddress++,this.sramAddress%=256},scrollWrite:function(t){this.triggerRendering(),this.firstWrite?(this.regHT=t>>3&31,this.regFH=t&7):(this.regFV=t&7,this.regVT=t>>3&31),this.firstWrite=!this.firstWrite},writeVRAMAddress:function(t){this.firstWrite?(this.regFV=t>>4&3,this.regV=t>>3&1,this.regH=t>>2&1,this.regVT=this.regVT&7|(t&3)<<3):(this.triggerRendering(),this.regVT=this.regVT&24|t>>5&7,this.regHT=t&31,this.cntFV=this.regFV,this.cntV=this.regV,this.cntH=this.regH,this.cntVT=this.regVT,this.cntHT=this.regHT,this.checkSprite0(this.scanline-20)),this.firstWrite=!this.firstWrite,this.cntsToAddress(),this.vramAddress<8192&&this.nes.mmap.latchAccess(this.vramAddress)},vramLoad:function(){var t;return this.cntsToAddress(),this.regsToAddress(),this.vramAddress<=16127?(t=this.vramBufferedReadValue,this.vramAddress<8192?this.vramBufferedReadValue=this.vramMem[this.vramAddress]:this.vramBufferedReadValue=this.mirroredLoad(this.vramAddress),this.vramAddress<8192&&this.nes.mmap.latchAccess(this.vramAddress),this.vramAddress+=this.f_addrInc===1?32:1,this.cntsFromAddress(),this.regsFromAddress(),t):(t=this.mirroredLoad(this.vramAddress),this.vramAddress+=this.f_addrInc===1?32:1,this.cntsFromAddress(),this.regsFromAddress(),t)},vramWrite:function(t){this.triggerRendering(),this.cntsToAddress(),this.regsToAddress(),this.vramAddress>=8192?this.mirroredWrite(this.vramAddress,t):(this.writeMem(this.vramAddress,t),this.nes.mmap.latchAccess(this.vramAddress)),this.vramAddress+=this.f_addrInc===1?32:1,this.regsFromAddress(),this.cntsFromAddress()},sramDMA:function(t){for(var e=t*256,i,s=this.sramAddress;s<256;s++)i=this.nes.cpu.mem[e+s],this.spriteMem[s]=i,this.spriteRamWriteUpdate(s,i);this.nes.cpu.haltCycles(513)},regsFromAddress:function(){var t=this.vramTmpAddress>>8&255;this.regFV=t>>4&7,this.regV=t>>3&1,this.regH=t>>2&1,this.regVT=this.regVT&7|(t&3)<<3,t=this.vramTmpAddress&255,this.regVT=this.regVT&24|t>>5&7,this.regHT=t&31},cntsFromAddress:function(){var t=this.vramAddress>>8&255;this.cntFV=t>>4&3,this.cntV=t>>3&1,this.cntH=t>>2&1,this.cntVT=this.cntVT&7|(t&3)<<3,t=this.vramAddress&255,this.cntVT=this.cntVT&24|t>>5&7,this.cntHT=t&31},regsToAddress:function(){var t=(this.regFV&7)<<4;t|=(this.regV&1)<<3,t|=(this.regH&1)<<2,t|=this.regVT>>3&3;var e=(this.regVT&7)<<5;e|=this.regHT&31,this.vramTmpAddress=(t<<8|e)&32767},cntsToAddress:function(){var t=(this.cntFV&7)<<4;t|=(this.cntV&1)<<3,t|=(this.cntH&1)<<2,t|=this.cntVT>>3&3;var e=(this.cntVT&7)<<5;e|=this.cntHT&31,this.vramAddress=(t<<8|e)&32767},incTileCounter:function(t){for(var e=t;e!==0;e--)this.cntHT++,this.cntHT===32&&(this.cntHT=0,this.cntVT++,this.cntVT>=30&&(this.cntH++,this.cntH===2&&(this.cntH=0,this.cntV++,this.cntV===2&&(this.cntV=0,this.cntFV++,this.cntFV&=7))))},mirroredLoad:function(t){return this.vramMem[this.vramMirrorTable[t]]},mirroredWrite:function(t,e){if(t>=16128&&t<16160)t===16128||t===16144?(this.writeMem(16128,e),this.writeMem(16144,e)):t===16132||t===16148?(this.writeMem(16132,e),this.writeMem(16148,e)):t===16136||t===16152?(this.writeMem(16136,e),this.writeMem(16152,e)):t===16140||t===16156?(this.writeMem(16140,e),this.writeMem(16156,e)):this.writeMem(t,e);else if(t<this.vramMirrorTable.length)this.writeMem(this.vramMirrorTable[t],e);else throw new Error("Invalid VRAM address: "+t.toString(16))},triggerRendering:function(){this.scanline>=21&&this.scanline<=260&&(this.renderFramePartially(this.lastRenderedScanline+1,this.scanline-21-this.lastRenderedScanline),this.lastRenderedScanline=this.scanline-21)},renderFramePartially:function(t,e){if(this.f_spVisibility===1&&this.renderSpritesPartially(t,e,!0),this.f_bgVisibility===1){var i=t<<8,s=t+e<<8;s>61440&&(s=61440);for(var r=this.buffer,n=this.bgbuffer,o=this.pixrendered,h=i;h<s;h++)o[h]>255&&(r[h]=n[h])}this.f_spVisibility===1&&this.renderSpritesPartially(t,e,!1),this.validTileData=!1},renderBgScanline:function(t,e){var i=this.regS===0?0:256,s=(e<<8)-this.regFH;if(this.curNt=this.ntable1[this.cntV+this.cntV+this.cntH],this.cntHT=this.regHT,this.cntH=this.regH,this.curNt=this.ntable1[this.cntV+this.cntV+this.cntH],e<240&&e-this.cntFV>=0){for(var r=this.cntFV<<3,n=this.scantile,o=this.attrib,h=this.ptTile,a=this.nameTable,c=this.imgPalette,p=this.pixrendered,g=t?this.bgbuffer:this.buffer,S,T,L,k,O=0;O<32;O++){if(e>=0){if(this.validTileData){if(S=n[O],typeof S=="undefined")continue;T=S.pix,L=o[O]}else{if(S=h[i+a[this.curNt].getTileIndex(this.cntHT,this.cntVT)],typeof S=="undefined")continue;T=S.pix,L=a[this.curNt].getAttrib(this.cntHT,this.cntVT),n[O]=S,o[O]=L}var y=0,J=(O<<3)-this.regFH;if(J>-8)if(J<0&&(s-=J,y=-J),S.opaque[this.cntFV])for(;y<8;y++)g[s]=c[T[r+y]+L],p[s]|=256,s++;else for(;y<8;y++)k=T[r+y],k!==0&&(g[s]=c[k+L],p[s]|=256),s++}++this.cntHT===32&&(this.cntHT=0,this.cntH++,this.cntH%=2,this.curNt=this.ntable1[(this.cntV<<1)+this.cntH])}this.validTileData=!0}this.cntFV++,this.cntFV===8&&(this.cntFV=0,this.cntVT++,this.cntVT===30?(this.cntVT=0,this.cntV++,this.cntV%=2,this.curNt=this.ntable1[(this.cntV<<1)+this.cntH]):this.cntVT===32&&(this.cntVT=0),this.validTileData=!1)},renderSpritesPartially:function(t,e,i){if(this.f_spVisibility===1){for(var s=0;s<64;s++)if(this.bgPriority[s]===i&&this.sprX[s]>=0&&this.sprX[s]<256&&this.sprY[s]+8>=t&&this.sprY[s]<t+e)if(this.f_spriteSize===0)this.srcy1=0,this.srcy2=8,this.sprY[s]<t&&(this.srcy1=t-this.sprY[s]-1),this.sprY[s]+8>t+e&&(this.srcy2=t+e-this.sprY[s]+1),this.f_spPatternTable===0?this.ptTile[this.sprTile[s]].render(this.buffer,0,this.srcy1,8,this.srcy2,this.sprX[s],this.sprY[s]+1,this.sprCol[s],this.sprPalette,this.horiFlip[s],this.vertFlip[s],s,this.pixrendered):this.ptTile[this.sprTile[s]+256].render(this.buffer,0,this.srcy1,8,this.srcy2,this.sprX[s],this.sprY[s]+1,this.sprCol[s],this.sprPalette,this.horiFlip[s],this.vertFlip[s],s,this.pixrendered);else{var r=this.sprTile[s];(r&1)!==0&&(r=this.sprTile[s]-1+256);var n=0,o=8;this.sprY[s]<t&&(n=t-this.sprY[s]-1),this.sprY[s]+8>t+e&&(o=t+e-this.sprY[s]),this.ptTile[r+(this.vertFlip[s]?1:0)].render(this.buffer,0,n,8,o,this.sprX[s],this.sprY[s]+1,this.sprCol[s],this.sprPalette,this.horiFlip[s],this.vertFlip[s],s,this.pixrendered),n=0,o=8,this.sprY[s]+8<t&&(n=t-(this.sprY[s]+8+1)),this.sprY[s]+16>t+e&&(o=t+e-(this.sprY[s]+8)),this.ptTile[r+(this.vertFlip[s]?0:1)].render(this.buffer,0,n,8,o,this.sprX[s],this.sprY[s]+1+8,this.sprCol[s],this.sprPalette,this.horiFlip[s],this.vertFlip[s],s,this.pixrendered)}}},checkSprite0:function(t){this.spr0HitX=-1,this.spr0HitY=-1;var e,i=this.f_spPatternTable===0?0:256,s,r,n,o,h;if(s=this.sprX[0],r=this.sprY[0]+1,this.f_spriteSize===0){if(r<=t&&r+8>t&&s>=-7&&s<256)if(n=this.ptTile[this.sprTile[0]+i],this.vertFlip[0]?e=7-(t-r):e=t-r,e*=8,h=t*256+s,this.horiFlip[0])for(o=7;o>=0;o--){if(s>=0&&s<256&&h>=0&&h<61440&&this.pixrendered[h]!==0&&n.pix[e+o]!==0)return this.spr0HitX=h%256,this.spr0HitY=t,!0;s++,h++}else for(o=0;o<8;o++){if(s>=0&&s<256&&h>=0&&h<61440&&this.pixrendered[h]!==0&&n.pix[e+o]!==0)return this.spr0HitX=h%256,this.spr0HitY=t,!0;s++,h++}}else if(r<=t&&r+16>t&&s>=-7&&s<256)if(this.vertFlip[0]?e=15-(t-r):e=t-r,e<8?n=this.ptTile[this.sprTile[0]+(this.vertFlip[0]?1:0)+((this.sprTile[0]&1)!==0?255:0)]:(n=this.ptTile[this.sprTile[0]+(this.vertFlip[0]?0:1)+((this.sprTile[0]&1)!==0?255:0)],this.vertFlip[0]?e=15-e:e-=8),e*=8,h=t*256+s,this.horiFlip[0])for(o=7;o>=0;o--){if(s>=0&&s<256&&h>=0&&h<61440&&this.pixrendered[h]!==0&&n.pix[e+o]!==0)return this.spr0HitX=h%256,this.spr0HitY=t,!0;s++,h++}else for(o=0;o<8;o++){if(s>=0&&s<256&&h>=0&&h<61440&&this.pixrendered[h]!==0&&n.pix[e+o]!==0)return this.spr0HitX=h%256,this.spr0HitY=t,!0;s++,h++}return!1},writeMem:function(t,e){this.vramMem[t]=e,t<8192?(this.vramMem[t]=e,this.patternWrite(t,e)):t>=8192&&t<9152?this.nameTableWrite(this.ntable1[0],t-8192,e):t>=9152&&t<9216?this.attribTableWrite(this.ntable1[0],t-9152,e):t>=9216&&t<10176?this.nameTableWrite(this.ntable1[1],t-9216,e):t>=10176&&t<10240?this.attribTableWrite(this.ntable1[1],t-10176,e):t>=10240&&t<11200?this.nameTableWrite(this.ntable1[2],t-10240,e):t>=11200&&t<11264?this.attribTableWrite(this.ntable1[2],t-11200,e):t>=11264&&t<12224?this.nameTableWrite(this.ntable1[3],t-11264,e):t>=12224&&t<12288?this.attribTableWrite(this.ntable1[3],t-12224,e):t>=16128&&t<16160&&this.updatePalettes()},updatePalettes:function(){var t;for(t=0;t<16;t++)this.f_dispType===0?this.imgPalette[t]=this.palTable.getEntry(this.vramMem[16128+t]&63):this.imgPalette[t]=this.palTable.getEntry(this.vramMem[16128+t]&32);for(t=0;t<16;t++)this.f_dispType===0?this.sprPalette[t]=this.palTable.getEntry(this.vramMem[16144+t]&63):this.sprPalette[t]=this.palTable.getEntry(this.vramMem[16144+t]&32)},patternWrite:function(t,e){var i=Math.floor(t/16),s=t%16;s<8?this.ptTile[i].setScanline(s,e,this.vramMem[t+8]):this.ptTile[i].setScanline(s-8,this.vramMem[t-8],e)},nameTableWrite:function(t,e,i){this.nameTable[t].tile[e]=i,this.checkSprite0(this.scanline-20)},attribTableWrite:function(t,e,i){this.nameTable[t].writeAttrib(e,i)},spriteRamWriteUpdate:function(t,e){var i=Math.floor(t/4);i===0&&this.checkSprite0(this.scanline-20),t%4===0?this.sprY[i]=e:t%4===1?this.sprTile[i]=e:t%4===2?(this.vertFlip[i]=(e&128)!==0,this.horiFlip[i]=(e&64)!==0,this.bgPriority[i]=(e&32)!==0,this.sprCol[i]=(e&3)<<2):t%4===3&&(this.sprX[i]=e)},doNMI:function(){this.setStatusFlag(this.STATUS_VBLANK,!0),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_NMI)},isPixelWhite:function(t,e){return this.triggerRendering(),this.nes.ppu.buffer[(e<<8)+t]===16777215},JSON_PROPERTIES:["vramMem","spriteMem","cntFV","cntV","cntH","cntVT","cntHT","regFV","regV","regH","regVT","regHT","regFH","regS","vramAddress","vramTmpAddress","f_nmiOnVblank","f_spriteSize","f_bgPatternTable","f_spPatternTable","f_addrInc","f_nTblAddress","f_color","f_spVisibility","f_bgVisibility","f_spClipping","f_bgClipping","f_dispType","vramBufferedReadValue","firstWrite","currentMirroring","vramMirrorTable","ntable1","sramAddress","hitSpr0","sprPalette","imgPalette","curX","scanline","lastRenderedScanline","curNt","scantile","attrib","buffer","bgbuffer","pixrendered","requestEndFrame","nmiOk","dummyCycleToggle","nmiCounter","validTileData","scanlineAlreadyRendered"],toJSON:function(){var t,e=Fs.toJSON(this);for(e.nameTable=[],t=0;t<this.nameTable.length;t++)e.nameTable[t]=this.nameTable[t].toJSON();for(e.ptTile=[],t=0;t<this.ptTile.length;t++)e.ptTile[t]=this.ptTile[t].toJSON();return e},fromJSON:function(t){var e;for(Fs.fromJSON(this,t),e=0;e<this.nameTable.length;e++)this.nameTable[e].fromJSON(t.nameTable[e]);for(e=0;e<this.ptTile.length;e++)this.ptTile[e].fromJSON(t.ptTile[e]);for(e=0;e<this.spriteMem.length;e++)this.spriteRamWriteUpdate(e,this.spriteMem[e])}};var Br=function(t,e,i){this.width=t,this.height=e,this.name=i,this.tile=new Array(t*e),this.attrib=new Array(t*e);for(var s=0;s<t*e;s++)this.tile[s]=0,this.attrib[s]=0};Br.prototype={getTileIndex:function(t,e){return this.tile[e*this.width+t]},getAttrib:function(t,e){return this.attrib[e*this.width+t]},writeAttrib:function(t,e){for(var i=t%8*4,s=Math.floor(t/8)*4,r,n,o,h,a=0;a<2;a++)for(var c=0;c<2;c++){r=e>>2*(a*2+c)&3;for(var p=0;p<2;p++)for(var g=0;g<2;g++)n=i+c*2+g,o=s+a*2+p,h=o*this.width+n,this.attrib[h]=r<<2&12}},toJSON:function(){return{tile:this.tile,attrib:this.attrib}},fromJSON:function(t){this.tile=t.tile,this.attrib=t.attrib}};var Vr=function(){this.curTable=new Array(64),this.emphTable=new Array(8),this.currentEmph=-1};Vr.prototype={reset:function(){this.setEmphasis(0)},loadNTSCPalette:function(){this.curTable=[5395026,11796480,10485760,11599933,7602281,91,95,6208,12048,543240,26368,1196544,7153664,0,0,0,12899815,16728064,14421538,16729963,14090399,6818519,6588,21681,27227,35843,43776,2918400,10777088,0,0,0,16316664,16755516,16742785,16735173,16730354,14633471,4681215,46327,57599,58229,259115,7911470,15065624,7895160,0,0,16777215,16773822,16300216,16300248,16758527,16761855,13095423,10148607,8973816,8650717,12122296,16119980,16777136,16308472,0,0],this.makeTables(),this.setEmphasis(0)},loadPALPalette:function(){this.curTable=[5395026,11796480,10485760,11599933,7602281,91,95,6208,12048,543240,26368,1196544,7153664,0,0,0,12899815,16728064,14421538,16729963,14090399,6818519,6588,21681,27227,35843,43776,2918400,10777088,0,0,0,16316664,16755516,16742785,16735173,16730354,14633471,4681215,46327,57599,58229,259115,7911470,15065624,7895160,0,0,16777215,16773822,16300216,16300248,16758527,16761855,13095423,10148607,8973816,8650717,12122296,16119980,16777136,16308472,0,0],this.makeTables(),this.setEmphasis(0)},makeTables:function(){for(var t,e,i,s,r,n,o,h,a=0;a<8;a++)for(n=1,o=1,h=1,(a&1)!==0&&(n=.75,h=.75),(a&2)!==0&&(n=.75,o=.75),(a&4)!==0&&(o=.75,h=.75),this.emphTable[a]=new Array(64),r=0;r<64;r++)s=this.curTable[r],t=Math.floor(this.getRed(s)*n),e=Math.floor(this.getGreen(s)*o),i=Math.floor(this.getBlue(s)*h),this.emphTable[a][r]=this.getRgb(t,e,i)},setEmphasis:function(t){if(t!==this.currentEmph){this.currentEmph=t;for(var e=0;e<64;e++)this.curTable[e]=this.emphTable[t][e]}},getEntry:function(t){return this.curTable[t]},getRed:function(t){return t>>16&255},getGreen:function(t){return t>>8&255},getBlue:function(t){return t&255},getRgb:function(t,e,i){return t<<16|e<<8|i},loadDefaultPalette:function(){this.curTable[0]=this.getRgb(117,117,117),this.curTable[1]=this.getRgb(39,27,143),this.curTable[2]=this.getRgb(0,0,171),this.curTable[3]=this.getRgb(71,0,159),this.curTable[4]=this.getRgb(143,0,119),this.curTable[5]=this.getRgb(171,0,19),this.curTable[6]=this.getRgb(167,0,0),this.curTable[7]=this.getRgb(127,11,0),this.curTable[8]=this.getRgb(67,47,0),this.curTable[9]=this.getRgb(0,71,0),this.curTable[10]=this.getRgb(0,81,0),this.curTable[11]=this.getRgb(0,63,23),this.curTable[12]=this.getRgb(27,63,95),this.curTable[13]=this.getRgb(0,0,0),this.curTable[14]=this.getRgb(0,0,0),this.curTable[15]=this.getRgb(0,0,0),this.curTable[16]=this.getRgb(188,188,188),this.curTable[17]=this.getRgb(0,115,239),this.curTable[18]=this.getRgb(35,59,239),this.curTable[19]=this.getRgb(131,0,243),this.curTable[20]=this.getRgb(191,0,191),this.curTable[21]=this.getRgb(231,0,91),this.curTable[22]=this.getRgb(219,43,0),this.curTable[23]=this.getRgb(203,79,15),this.curTable[24]=this.getRgb(139,115,0),this.curTable[25]=this.getRgb(0,151,0),this.curTable[26]=this.getRgb(0,171,0),this.curTable[27]=this.getRgb(0,147,59),this.curTable[28]=this.getRgb(0,131,139),this.curTable[29]=this.getRgb(0,0,0),this.curTable[30]=this.getRgb(0,0,0),this.curTable[31]=this.getRgb(0,0,0),this.curTable[32]=this.getRgb(255,255,255),this.curTable[33]=this.getRgb(63,191,255),this.curTable[34]=this.getRgb(95,151,255),this.curTable[35]=this.getRgb(167,139,253),this.curTable[36]=this.getRgb(247,123,255),this.curTable[37]=this.getRgb(255,119,183),this.curTable[38]=this.getRgb(255,119,99),this.curTable[39]=this.getRgb(255,155,59),this.curTable[40]=this.getRgb(243,191,63),this.curTable[41]=this.getRgb(131,211,19),this.curTable[42]=this.getRgb(79,223,75),this.curTable[43]=this.getRgb(88,248,152),this.curTable[44]=this.getRgb(0,235,219),this.curTable[45]=this.getRgb(0,0,0),this.curTable[46]=this.getRgb(0,0,0),this.curTable[47]=this.getRgb(0,0,0),this.curTable[48]=this.getRgb(255,255,255),this.curTable[49]=this.getRgb(171,231,255),this.curTable[50]=this.getRgb(199,215,255),this.curTable[51]=this.getRgb(215,203,255),this.curTable[52]=this.getRgb(255,199,255),this.curTable[53]=this.getRgb(255,199,219),this.curTable[54]=this.getRgb(255,191,179),this.curTable[55]=this.getRgb(255,219,171),this.curTable[56]=this.getRgb(255,231,163),this.curTable[57]=this.getRgb(227,255,163),this.curTable[58]=this.getRgb(171,243,191),this.curTable[59]=this.getRgb(179,255,207),this.curTable[60]=this.getRgb(159,255,243),this.curTable[61]=this.getRgb(0,0,0),this.curTable[62]=this.getRgb(0,0,0),this.curTable[63]=this.getRgb(0,0,0),this.makeTables(),this.setEmphasis(0)}};var To=xr,Oo=17897725e-1,Gr=function(t){this.nes=t,this.square1=new Oi(this,!0),this.square2=new Oi(this,!1),this.triangle=new Hr(this),this.noise=new Xr(this),this.dmc=new qr(this),this.frameIrqCounter=null,this.frameIrqCounterMax=4,this.initCounter=2048,this.channelEnableValue=null,this.sampleRate=44100,this.lengthLookup=null,this.dmcFreqLookup=null,this.noiseWavelengthLookup=null,this.square_table=null,this.tnd_table=null,this.frameIrqEnabled=!1,this.frameIrqActive=null,this.frameClockNow=null,this.startedPlaying=!1,this.recordOutput=!1,this.initingHardware=!1,this.masterFrameCounter=null,this.derivedFrameCounter=null,this.countSequence=null,this.sampleTimer=null,this.frameTime=null,this.sampleTimerMax=null,this.sampleCount=null,this.triValue=0,this.smpSquare1=null,this.smpSquare2=null,this.smpTriangle=null,this.smpDmc=null,this.accCount=null,this.prevSampleL=0,this.prevSampleR=0,this.smpAccumL=0,this.smpAccumR=0,this.dacRange=0,this.dcValue=0,this.masterVolume=256,this.stereoPosLSquare1=null,this.stereoPosLSquare2=null,this.stereoPosLTriangle=null,this.stereoPosLNoise=null,this.stereoPosLDMC=null,this.stereoPosRSquare1=null,this.stereoPosRSquare2=null,this.stereoPosRTriangle=null,this.stereoPosRNoise=null,this.stereoPosRDMC=null,this.extraCycles=null,this.maxSample=null,this.minSample=null,this.panning=[80,170,100,150,128],this.setPanning(this.panning),this.initLengthLookup(),this.initDmcFrequencyLookup(),this.initNoiseWavelengthLookup(),this.initDACtables();for(var e=0;e<20;e++)e===16?this.writeReg(16400,16):this.writeReg(16384+e,0);this.reset()};Gr.prototype={reset:function(){this.sampleRate=this.nes.opts.sampleRate,this.sampleTimerMax=Math.floor(1024*Oo*this.nes.opts.preferredFrameRate/(this.sampleRate*60)),this.frameTime=Math.floor(14915*this.nes.opts.preferredFrameRate/60),this.sampleTimer=0,this.updateChannelEnable(0),this.masterFrameCounter=0,this.derivedFrameCounter=0,this.countSequence=0,this.sampleCount=0,this.initCounter=2048,this.frameIrqEnabled=!1,this.initingHardware=!1,this.resetCounter(),this.square1.reset(),this.square2.reset(),this.triangle.reset(),this.noise.reset(),this.dmc.reset(),this.accCount=0,this.smpSquare1=0,this.smpSquare2=0,this.smpTriangle=0,this.smpDmc=0,this.frameIrqEnabled=!1,this.frameIrqCounterMax=4,this.channelEnableValue=255,this.startedPlaying=!1,this.prevSampleL=0,this.prevSampleR=0,this.smpAccumL=0,this.smpAccumR=0,this.maxSample=-5e5,this.minSample=5e5},readReg:function(t){var e=0;return e|=this.square1.getLengthStatus(),e|=this.square2.getLengthStatus()<<1,e|=this.triangle.getLengthStatus()<<2,e|=this.noise.getLengthStatus()<<3,e|=this.dmc.getLengthStatus()<<4,e|=(this.frameIrqActive&&this.frameIrqEnabled?1:0)<<6,e|=this.dmc.getIrqStatus()<<7,this.frameIrqActive=!1,this.dmc.irqGenerated=!1,e&65535},writeReg:function(t,e){t>=16384&&t<16388?this.square1.writeReg(t,e):t>=16388&&t<16392?this.square2.writeReg(t,e):t>=16392&&t<16396?this.triangle.writeReg(t,e):t>=16396&&t<=16399?this.noise.writeReg(t,e):t===16400?this.dmc.writeReg(t,e):t===16401?this.dmc.writeReg(t,e):t===16402?this.dmc.writeReg(t,e):t===16403?this.dmc.writeReg(t,e):t===16405?(this.updateChannelEnable(e),e!==0&&this.initCounter>0&&(this.initingHardware=!0),this.dmc.writeReg(t,e)):t===16407&&(this.countSequence=e>>7&1,this.masterFrameCounter=0,this.frameIrqActive=!1,(e>>6&1)===0?this.frameIrqEnabled=!0:this.frameIrqEnabled=!1,this.countSequence===0?(this.frameIrqCounterMax=4,this.derivedFrameCounter=4):(this.frameIrqCounterMax=5,this.derivedFrameCounter=0,this.frameCounterTick()))},resetCounter:function(){this.countSequence===0?this.derivedFrameCounter=4:this.derivedFrameCounter=0},updateChannelEnable:function(t){this.channelEnableValue=t&65535,this.square1.setEnabled((t&1)!==0),this.square2.setEnabled((t&2)!==0),this.triangle.setEnabled((t&4)!==0),this.noise.setEnabled((t&8)!==0),this.dmc.setEnabled((t&16)!==0)},clockFrameCounter:function(t){if(this.initCounter>0&&this.initingHardware){this.initCounter-=t,this.initCounter<=0&&(this.initingHardware=!1);return}t+=this.extraCycles;var e=this.sampleTimerMax-this.sampleTimer;t<<10>e?(this.extraCycles=(t<<10)-e>>10,t-=this.extraCycles):this.extraCycles=0;var i=this.dmc,s=this.triangle,r=this.square1,n=this.square2,o=this.noise;if(i.isEnabled)for(i.shiftCounter-=t<<3;i.shiftCounter<=0&&i.dmaFrequency>0;)i.shiftCounter+=i.dmaFrequency,i.clockDmc();if(s.progTimerMax>0)for(s.progTimerCount-=t;s.progTimerCount<=0;)s.progTimerCount+=s.progTimerMax+1,s.linearCounter>0&&s.lengthCounter>0&&(s.triangleCounter++,s.triangleCounter&=31,s.isEnabled&&(s.triangleCounter>=16?s.sampleValue=s.triangleCounter&15:s.sampleValue=15-(s.triangleCounter&15),s.sampleValue<<=4));r.progTimerCount-=t,r.progTimerCount<=0&&(r.progTimerCount+=r.progTimerMax+1<<1,r.squareCounter++,r.squareCounter&=7,r.updateSampleValue()),n.progTimerCount-=t,n.progTimerCount<=0&&(n.progTimerCount+=n.progTimerMax+1<<1,n.squareCounter++,n.squareCounter&=7,n.updateSampleValue());var h=t;if(o.progTimerCount-h>0)o.progTimerCount-=h,o.accCount+=h,o.accValue+=h*o.sampleValue;else for(;h-- >0;)--o.progTimerCount<=0&&o.progTimerMax>0&&(o.shiftReg<<=1,o.tmp=(o.shiftReg<<(o.randomMode===0?1:6)^o.shiftReg)&32768,o.tmp!==0?(o.shiftReg|=1,o.randomBit=0,o.sampleValue=0):(o.randomBit=1,o.isEnabled&&o.lengthCounter>0?o.sampleValue=o.masterVolume:o.sampleValue=0),o.progTimerCount+=o.progTimerMax),o.accValue+=o.sampleValue,o.accCount++;this.frameIrqEnabled&&this.frameIrqActive&&this.nes.cpu.requestIrq(this.nes.cpu.IRQ_NORMAL),this.masterFrameCounter+=t<<1,this.masterFrameCounter>=this.frameTime&&(this.masterFrameCounter-=this.frameTime,this.frameCounterTick()),this.accSample(t),this.sampleTimer+=t<<10,this.sampleTimer>=this.sampleTimerMax&&(this.sample(),this.sampleTimer-=this.sampleTimerMax)},accSample:function(t){this.triangle.sampleCondition&&(this.triValue=Math.floor((this.triangle.progTimerCount<<4)/(this.triangle.progTimerMax+1)),this.triValue>16&&(this.triValue=16),this.triangle.triangleCounter>=16&&(this.triValue=16-this.triValue),this.triValue+=this.triangle.sampleValue),t===2?(this.smpTriangle+=this.triValue<<1,this.smpDmc+=this.dmc.sample<<1,this.smpSquare1+=this.square1.sampleValue<<1,this.smpSquare2+=this.square2.sampleValue<<1,this.accCount+=2):t===4?(this.smpTriangle+=this.triValue<<2,this.smpDmc+=this.dmc.sample<<2,this.smpSquare1+=this.square1.sampleValue<<2,this.smpSquare2+=this.square2.sampleValue<<2,this.accCount+=4):(this.smpTriangle+=t*this.triValue,this.smpDmc+=t*this.dmc.sample,this.smpSquare1+=t*this.square1.sampleValue,this.smpSquare2+=t*this.square2.sampleValue,this.accCount+=t)},frameCounterTick:function(){this.derivedFrameCounter++,this.derivedFrameCounter>=this.frameIrqCounterMax&&(this.derivedFrameCounter=0),(this.derivedFrameCounter===1||this.derivedFrameCounter===3)&&(this.triangle.clockLengthCounter(),this.square1.clockLengthCounter(),this.square2.clockLengthCounter(),this.noise.clockLengthCounter(),this.square1.clockSweep(),this.square2.clockSweep()),this.derivedFrameCounter>=0&&this.derivedFrameCounter<4&&(this.square1.clockEnvDecay(),this.square2.clockEnvDecay(),this.noise.clockEnvDecay(),this.triangle.clockLinearCounter()),this.derivedFrameCounter===3&&this.countSequence===0&&(this.frameIrqActive=!0)},sample:function(){var t,e;this.accCount>0?(this.smpSquare1<<=4,this.smpSquare1=Math.floor(this.smpSquare1/this.accCount),this.smpSquare2<<=4,this.smpSquare2=Math.floor(this.smpSquare2/this.accCount),this.smpTriangle=Math.floor(this.smpTriangle/this.accCount),this.smpDmc<<=4,this.smpDmc=Math.floor(this.smpDmc/this.accCount),this.accCount=0):(this.smpSquare1=this.square1.sampleValue<<4,this.smpSquare2=this.square2.sampleValue<<4,this.smpTriangle=this.triangle.sampleValue,this.smpDmc=this.dmc.sample<<4);var i=Math.floor((this.noise.accValue<<4)/this.noise.accCount);this.noise.accValue=i>>4,this.noise.accCount=1,t=this.smpSquare1*this.stereoPosLSquare1+this.smpSquare2*this.stereoPosLSquare2>>8,e=3*this.smpTriangle*this.stereoPosLTriangle+(i<<1)*this.stereoPosLNoise+this.smpDmc*this.stereoPosLDMC>>8,t>=this.square_table.length&&(t=this.square_table.length-1),e>=this.tnd_table.length&&(e=this.tnd_table.length-1);var s=this.square_table[t]+this.tnd_table[e]-this.dcValue;t=this.smpSquare1*this.stereoPosRSquare1+this.smpSquare2*this.stereoPosRSquare2>>8,e=3*this.smpTriangle*this.stereoPosRTriangle+(i<<1)*this.stereoPosRNoise+this.smpDmc*this.stereoPosRDMC>>8,t>=this.square_table.length&&(t=this.square_table.length-1),e>=this.tnd_table.length&&(e=this.tnd_table.length-1);var r=this.square_table[t]+this.tnd_table[e]-this.dcValue,n=s-this.prevSampleL;this.prevSampleL+=n,this.smpAccumL+=n-(this.smpAccumL>>10),s=this.smpAccumL;var o=r-this.prevSampleR;this.prevSampleR+=o,this.smpAccumR+=o-(this.smpAccumR>>10),r=this.smpAccumR,s>this.maxSample&&(this.maxSample=s),s<this.minSample&&(this.minSample=s),this.nes.opts.onAudioSample&&this.nes.opts.onAudioSample(s/32768,r/32768),this.smpSquare1=0,this.smpSquare2=0,this.smpTriangle=0,this.smpDmc=0},getLengthMax:function(t){return this.lengthLookup[t>>3]},getDmcFrequency:function(t){return t>=0&&t<16?this.dmcFreqLookup[t]:0},getNoiseWaveLength:function(t){return t>=0&&t<16?this.noiseWavelengthLookup[t]:0},setPanning:function(t){for(var e=0;e<5;e++)this.panning[e]=t[e];this.updateStereoPos()},setMasterVolume:function(t){t<0&&(t=0),t>256&&(t=256),this.masterVolume=t,this.updateStereoPos()},updateStereoPos:function(){this.stereoPosLSquare1=this.panning[0]*this.masterVolume>>8,this.stereoPosLSquare2=this.panning[1]*this.masterVolume>>8,this.stereoPosLTriangle=this.panning[2]*this.masterVolume>>8,this.stereoPosLNoise=this.panning[3]*this.masterVolume>>8,this.stereoPosLDMC=this.panning[4]*this.masterVolume>>8,this.stereoPosRSquare1=this.masterVolume-this.stereoPosLSquare1,this.stereoPosRSquare2=this.masterVolume-this.stereoPosLSquare2,this.stereoPosRTriangle=this.masterVolume-this.stereoPosLTriangle,this.stereoPosRNoise=this.masterVolume-this.stereoPosLNoise,this.stereoPosRDMC=this.masterVolume-this.stereoPosLDMC},initLengthLookup:function(){this.lengthLookup=[10,254,20,2,40,4,80,6,160,8,60,10,14,12,26,14,12,16,24,18,48,20,96,22,192,24,72,26,16,28,32,30]},initDmcFrequencyLookup:function(){this.dmcFreqLookup=new Array(16),this.dmcFreqLookup[0]=3424,this.dmcFreqLookup[1]=3040,this.dmcFreqLookup[2]=2720,this.dmcFreqLookup[3]=2560,this.dmcFreqLookup[4]=2288,this.dmcFreqLookup[5]=2032,this.dmcFreqLookup[6]=1808,this.dmcFreqLookup[7]=1712,this.dmcFreqLookup[8]=1520,this.dmcFreqLookup[9]=1280,this.dmcFreqLookup[10]=1136,this.dmcFreqLookup[11]=1024,this.dmcFreqLookup[12]=848,this.dmcFreqLookup[13]=672,this.dmcFreqLookup[14]=576,this.dmcFreqLookup[15]=432},initNoiseWavelengthLookup:function(){this.noiseWavelengthLookup=new Array(16),this.noiseWavelengthLookup[0]=4,this.noiseWavelengthLookup[1]=8,this.noiseWavelengthLookup[2]=16,this.noiseWavelengthLookup[3]=32,this.noiseWavelengthLookup[4]=64,this.noiseWavelengthLookup[5]=96,this.noiseWavelengthLookup[6]=128,this.noiseWavelengthLookup[7]=160,this.noiseWavelengthLookup[8]=202,this.noiseWavelengthLookup[9]=254,this.noiseWavelengthLookup[10]=380,this.noiseWavelengthLookup[11]=508,this.noiseWavelengthLookup[12]=762,this.noiseWavelengthLookup[13]=1016,this.noiseWavelengthLookup[14]=2034,this.noiseWavelengthLookup[15]=4068},initDACtables:function(){var t,e,i,s=0,r=0;for(this.square_table=new Array(32*16),this.tnd_table=new Array(204*16),i=0;i<32*16;i++)t=95.52/(8128/(i/16)+100),t*=.98411,t*=5e4,e=Math.floor(t),this.square_table[i]=e,e>s&&(s=e);for(i=0;i<204*16;i++)t=163.67/(24329/(i/16)+100),t*=.98411,t*=5e4,e=Math.floor(t),this.tnd_table[i]=e,e>r&&(r=e);this.dacRange=s+r,this.dcValue=this.dacRange/2}};var qr=function(t){this.papu=t,this.MODE_NORMAL=0,this.MODE_LOOP=1,this.MODE_IRQ=2,this.isEnabled=null,this.hasSample=null,this.irqGenerated=!1,this.playMode=null,this.dmaFrequency=null,this.dmaCounter=null,this.deltaCounter=null,this.playStartAddress=null,this.playAddress=null,this.playLength=null,this.playLengthCounter=null,this.shiftCounter=null,this.reg4012=null,this.reg4013=null,this.sample=null,this.dacLsb=null,this.data=null,this.reset()};qr.prototype={clockDmc:function(){this.hasSample&&((this.data&1)===0?this.deltaCounter>0&&this.deltaCounter--:this.deltaCounter<63&&this.deltaCounter++,this.sample=this.isEnabled?(this.deltaCounter<<1)+this.dacLsb:0,this.data>>=1),this.dmaCounter--,this.dmaCounter<=0&&(this.hasSample=!1,this.endOfSample(),this.dmaCounter=8),this.irqGenerated&&this.papu.nes.cpu.requestIrq(this.papu.nes.cpu.IRQ_NORMAL)},endOfSample:function(){this.playLengthCounter===0&&this.playMode===this.MODE_LOOP&&(this.playAddress=this.playStartAddress,this.playLengthCounter=this.playLength),this.playLengthCounter>0&&(this.nextSample(),this.playLengthCounter===0&&this.playMode===this.MODE_IRQ&&(this.irqGenerated=!0))},nextSample:function(){this.data=this.papu.nes.mmap.load(this.playAddress),this.papu.nes.cpu.haltCycles(4),this.playLengthCounter--,this.playAddress++,this.playAddress>65535&&(this.playAddress=32768),this.hasSample=!0},writeReg:function(t,e){t===16400?(e>>6===0?this.playMode=this.MODE_NORMAL:(e>>6&1)===1?this.playMode=this.MODE_LOOP:e>>6===2&&(this.playMode=this.MODE_IRQ),(e&128)===0&&(this.irqGenerated=!1),this.dmaFrequency=this.papu.getDmcFrequency(e&15)):t===16401?(this.deltaCounter=e>>1&63,this.dacLsb=e&1,this.sample=(this.deltaCounter<<1)+this.dacLsb):t===16402?(this.playStartAddress=e<<6|49152,this.playAddress=this.playStartAddress,this.reg4012=e):t===16403?(this.playLength=(e<<4)+1,this.playLengthCounter=this.playLength,this.reg4013=e):t===16405&&((e>>4&1)===0?this.playLengthCounter=0:(this.playAddress=this.playStartAddress,this.playLengthCounter=this.playLength),this.irqGenerated=!1)},setEnabled:function(t){!this.isEnabled&&t&&(this.playLengthCounter=this.playLength),this.isEnabled=t},getLengthStatus:function(){return this.playLengthCounter===0||!this.isEnabled?0:1},getIrqStatus:function(){return this.irqGenerated?1:0},reset:function(){this.isEnabled=!1,this.irqGenerated=!1,this.playMode=this.MODE_NORMAL,this.dmaFrequency=0,this.dmaCounter=0,this.deltaCounter=0,this.playStartAddress=0,this.playAddress=0,this.playLength=0,this.playLengthCounter=0,this.sample=0,this.dacLsb=0,this.shiftCounter=0,this.reg4012=0,this.reg4013=0,this.data=0}};var Xr=function(t){this.papu=t,this.isEnabled=null,this.envDecayDisable=null,this.envDecayLoopEnable=null,this.lengthCounterEnable=null,this.envReset=null,this.shiftNow=null,this.lengthCounter=null,this.progTimerCount=null,this.progTimerMax=null,this.envDecayRate=null,this.envDecayCounter=null,this.envVolume=null,this.masterVolume=null,this.shiftReg=1<<14,this.randomBit=null,this.randomMode=null,this.sampleValue=null,this.accValue=0,this.accCount=1,this.tmp=null,this.reset()};Xr.prototype={reset:function(){this.progTimerCount=0,this.progTimerMax=0,this.isEnabled=!1,this.lengthCounter=0,this.lengthCounterEnable=!1,this.envDecayDisable=!1,this.envDecayLoopEnable=!1,this.shiftNow=!1,this.envDecayRate=0,this.envDecayCounter=0,this.envVolume=0,this.masterVolume=0,this.shiftReg=1,this.randomBit=0,this.randomMode=0,this.sampleValue=0,this.tmp=0},clockLengthCounter:function(){this.lengthCounterEnable&&this.lengthCounter>0&&(this.lengthCounter--,this.lengthCounter===0&&this.updateSampleValue())},clockEnvDecay:function(){this.envReset?(this.envReset=!1,this.envDecayCounter=this.envDecayRate+1,this.envVolume=15):--this.envDecayCounter<=0&&(this.envDecayCounter=this.envDecayRate+1,this.envVolume>0?this.envVolume--:this.envVolume=this.envDecayLoopEnable?15:0),this.envDecayDisable?this.masterVolume=this.envDecayRate:this.masterVolume=this.envVolume,this.updateSampleValue()},updateSampleValue:function(){this.isEnabled&&this.lengthCounter>0&&(this.sampleValue=this.randomBit*this.masterVolume)},writeReg:function(t,e){t===16396?(this.envDecayDisable=(e&16)!==0,this.envDecayRate=e&15,this.envDecayLoopEnable=(e&32)!==0,this.lengthCounterEnable=(e&32)===0,this.envDecayDisable?this.masterVolume=this.envDecayRate:this.masterVolume=this.envVolume):t===16398?(this.progTimerMax=this.papu.getNoiseWaveLength(e&15),this.randomMode=e>>7):t===16399&&(this.lengthCounter=this.papu.getLengthMax(e&248),this.envReset=!0)},setEnabled:function(t){this.isEnabled=t,t||(this.lengthCounter=0),this.updateSampleValue()},getLengthStatus:function(){return this.lengthCounter===0||!this.isEnabled?0:1}};var Oi=function(t,e){this.papu=t,this.dutyLookup=[0,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,1,1,1,0,0,0,1,0,0,1,1,1,1,1],this.impLookup=[1,-1,0,0,0,0,0,0,1,0,-1,0,0,0,0,0,1,0,0,0,-1,0,0,0,-1,0,1,0,0,0,0,0],this.sqr1=e,this.isEnabled=null,this.lengthCounterEnable=null,this.sweepActive=null,this.envDecayDisable=null,this.envDecayLoopEnable=null,this.envReset=null,this.sweepCarry=null,this.updateSweepPeriod=null,this.progTimerCount=null,this.progTimerMax=null,this.lengthCounter=null,this.squareCounter=null,this.sweepCounter=null,this.sweepCounterMax=null,this.sweepMode=null,this.sweepShiftAmount=null,this.envDecayRate=null,this.envDecayCounter=null,this.envVolume=null,this.masterVolume=null,this.dutyMode=null,this.sweepResult=null,this.sampleValue=null,this.vol=null,this.reset()};Oi.prototype={reset:function(){this.progTimerCount=0,this.progTimerMax=0,this.lengthCounter=0,this.squareCounter=0,this.sweepCounter=0,this.sweepCounterMax=0,this.sweepMode=0,this.sweepShiftAmount=0,this.envDecayRate=0,this.envDecayCounter=0,this.envVolume=0,this.masterVolume=0,this.dutyMode=0,this.vol=0,this.isEnabled=!1,this.lengthCounterEnable=!1,this.sweepActive=!1,this.sweepCarry=!1,this.envDecayDisable=!1,this.envDecayLoopEnable=!1},clockLengthCounter:function(){this.lengthCounterEnable&&this.lengthCounter>0&&(this.lengthCounter--,this.lengthCounter===0&&this.updateSampleValue())},clockEnvDecay:function(){this.envReset?(this.envReset=!1,this.envDecayCounter=this.envDecayRate+1,this.envVolume=15):--this.envDecayCounter<=0&&(this.envDecayCounter=this.envDecayRate+1,this.envVolume>0?this.envVolume--:this.envVolume=this.envDecayLoopEnable?15:0),this.envDecayDisable?this.masterVolume=this.envDecayRate:this.masterVolume=this.envVolume,this.updateSampleValue()},clockSweep:function(){--this.sweepCounter<=0&&(this.sweepCounter=this.sweepCounterMax+1,this.sweepActive&&this.sweepShiftAmount>0&&this.progTimerMax>7&&(this.sweepCarry=!1,this.sweepMode===0?(this.progTimerMax+=this.progTimerMax>>this.sweepShiftAmount,this.progTimerMax>4095&&(this.progTimerMax=4095,this.sweepCarry=!0)):this.progTimerMax=this.progTimerMax-((this.progTimerMax>>this.sweepShiftAmount)-(this.sqr1?1:0)))),this.updateSweepPeriod&&(this.updateSweepPeriod=!1,this.sweepCounter=this.sweepCounterMax+1)},updateSampleValue:function(){this.isEnabled&&this.lengthCounter>0&&this.progTimerMax>7?this.sweepMode===0&&this.progTimerMax+(this.progTimerMax>>this.sweepShiftAmount)>4095?this.sampleValue=0:this.sampleValue=this.masterVolume*this.dutyLookup[(this.dutyMode<<3)+this.squareCounter]:this.sampleValue=0},writeReg:function(t,e){var i=this.sqr1?0:4;t===16384+i?(this.envDecayDisable=(e&16)!==0,this.envDecayRate=e&15,this.envDecayLoopEnable=(e&32)!==0,this.dutyMode=e>>6&3,this.lengthCounterEnable=(e&32)===0,this.envDecayDisable?this.masterVolume=this.envDecayRate:this.masterVolume=this.envVolume,this.updateSampleValue()):t===16385+i?(this.sweepActive=(e&128)!==0,this.sweepCounterMax=e>>4&7,this.sweepMode=e>>3&1,this.sweepShiftAmount=e&7,this.updateSweepPeriod=!0):t===16386+i?(this.progTimerMax&=1792,this.progTimerMax|=e):t===16387+i&&(this.progTimerMax&=255,this.progTimerMax|=(e&7)<<8,this.isEnabled&&(this.lengthCounter=this.papu.getLengthMax(e&248)),this.envReset=!0)},setEnabled:function(t){this.isEnabled=t,t||(this.lengthCounter=0),this.updateSampleValue()},getLengthStatus:function(){return this.lengthCounter===0||!this.isEnabled?0:1}};var Hr=function(t){this.papu=t,this.isEnabled=null,this.sampleCondition=null,this.lengthCounterEnable=null,this.lcHalt=null,this.lcControl=null,this.progTimerCount=null,this.progTimerMax=null,this.triangleCounter=null,this.lengthCounter=null,this.linearCounter=null,this.lcLoadValue=null,this.sampleValue=null,this.tmp=null,this.reset()};Hr.prototype={reset:function(){this.progTimerCount=0,this.progTimerMax=0,this.triangleCounter=0,this.isEnabled=!1,this.sampleCondition=!1,this.lengthCounter=0,this.lengthCounterEnable=!1,this.linearCounter=0,this.lcLoadValue=0,this.lcHalt=!0,this.lcControl=!1,this.tmp=0,this.sampleValue=15},clockLengthCounter:function(){this.lengthCounterEnable&&this.lengthCounter>0&&(this.lengthCounter--,this.lengthCounter===0&&this.updateSampleCondition())},clockLinearCounter:function(){this.lcHalt?(this.linearCounter=this.lcLoadValue,this.updateSampleCondition()):this.linearCounter>0&&(this.linearCounter--,this.updateSampleCondition()),this.lcControl||(this.lcHalt=!1)},getLengthStatus:function(){return this.lengthCounter===0||!this.isEnabled?0:1},readReg:function(t){return 0},writeReg:function(t,e){t===16392?(this.lcControl=(e&128)!==0,this.lcLoadValue=e&127,this.lengthCounterEnable=!this.lcControl):t===16394?(this.progTimerMax&=1792,this.progTimerMax|=e):t===16395&&(this.progTimerMax&=255,this.progTimerMax|=(e&7)<<8,this.lengthCounter=this.papu.getLengthMax(e&248),this.lcHalt=!0),this.updateSampleCondition()},clockProgrammableTimer:function(t){if(this.progTimerMax>0)for(this.progTimerCount+=t;this.progTimerMax>0&&this.progTimerCount>=this.progTimerMax;)this.progTimerCount-=this.progTimerMax,this.isEnabled&&this.lengthCounter>0&&this.linearCounter>0&&this.clockTriangleGenerator()},clockTriangleGenerator:function(){this.triangleCounter++,this.triangleCounter&=31},setEnabled:function(t){this.isEnabled=t,t||(this.lengthCounter=0),this.updateSampleCondition()},updateSampleCondition:function(){this.sampleCondition=this.isEnabled&&this.progTimerMax>7&&this.linearCounter>0&&this.lengthCounter>0}};var yo=Gr,jt=zi,R={};R[0]=function(t){this.nes=t};R[0].prototype={reset:function(){this.joy1StrobeState=0,this.joy2StrobeState=0,this.joypadLastWrite=0,this.zapperFired=!1,this.zapperX=null,this.zapperY=null},write:function(t,e){t<8192?this.nes.cpu.mem[t&2047]=e:t>16407?(this.nes.cpu.mem[t]=e,t>=24576&&t<32768&&this.nes.opts.onBatteryRamWrite(t,e)):t>8199&&t<16384?this.regWrite(8192+(t&7),e):this.regWrite(t,e)},writelow:function(t,e){t<8192?this.nes.cpu.mem[t&2047]=e:t>16407?this.nes.cpu.mem[t]=e:t>8199&&t<16384?this.regWrite(8192+(t&7),e):this.regWrite(t,e)},load:function(t){return t&=65535,t>16407?this.nes.cpu.mem[t]:t>=8192?this.regLoad(t):this.nes.cpu.mem[t&2047]},regLoad:function(t){switch(t>>12){case 0:break;case 1:break;case 2:case 3:switch(t&7){case 0:return this.nes.cpu.mem[8192];case 1:return this.nes.cpu.mem[8193];case 2:return this.nes.ppu.readStatusRegister();case 3:return 0;case 4:return this.nes.ppu.sramLoad();case 5:return 0;case 6:return 0;case 7:return this.nes.ppu.vramLoad()}break;case 4:switch(t-16405){case 0:return this.nes.papu.readReg(t);case 1:return this.joy1Read();case 2:var e;return this.zapperX!==null&&this.zapperY!==null&&this.nes.ppu.isPixelWhite(this.zapperX,this.zapperY)?e=0:e=1<<3,this.zapperFired&&(e|=1<<4),(this.joy2Read()|e)&65535}break}return 0},regWrite:function(t,e){switch(t){case 8192:this.nes.cpu.mem[t]=e,this.nes.ppu.updateControlReg1(e);break;case 8193:this.nes.cpu.mem[t]=e,this.nes.ppu.updateControlReg2(e);break;case 8195:this.nes.ppu.writeSRAMAddress(e);break;case 8196:this.nes.ppu.sramWrite(e);break;case 8197:this.nes.ppu.scrollWrite(e);break;case 8198:this.nes.ppu.writeVRAMAddress(e);break;case 8199:this.nes.ppu.vramWrite(e);break;case 16404:this.nes.ppu.sramDMA(e);break;case 16405:this.nes.papu.writeReg(t,e);break;case 16406:(e&1)===0&&(this.joypadLastWrite&1)===1&&(this.joy1StrobeState=0,this.joy2StrobeState=0),this.joypadLastWrite=e;break;case 16407:this.nes.papu.writeReg(t,e);break;default:t>=16384&&t<=16407&&this.nes.papu.writeReg(t,e)}},joy1Read:function(){var t;switch(this.joy1StrobeState){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t=this.nes.controllers[1].state[this.joy1StrobeState];break;case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:t=0;break;case 19:t=1;break;default:t=0}return this.joy1StrobeState++,this.joy1StrobeState===24&&(this.joy1StrobeState=0),t},joy2Read:function(){var t;switch(this.joy2StrobeState){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t=this.nes.controllers[2].state[this.joy2StrobeState];break;case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:t=0;break;case 19:t=1;break;default:t=0}return this.joy2StrobeState++,this.joy2StrobeState===24&&(this.joy2StrobeState=0),t},loadROM:function(){if(!this.nes.rom.valid||this.nes.rom.romCount<1)throw new Error("NoMapper: Invalid ROM! Unable to load.");this.loadPRGROM(),this.loadCHRROM(),this.loadBatteryRam(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)},loadPRGROM:function(){this.nes.rom.romCount>1?(this.loadRomBank(0,32768),this.loadRomBank(1,49152)):(this.loadRomBank(0,32768),this.loadRomBank(0,49152))},loadCHRROM:function(){this.nes.rom.vromCount>0&&(this.nes.rom.vromCount===1?(this.loadVromBank(0,0),this.loadVromBank(0,4096)):(this.loadVromBank(0,0),this.loadVromBank(1,4096)))},loadBatteryRam:function(){if(this.nes.rom.batteryRam){var t=this.nes.rom.batteryRam;t!==null&&t.length===8192&&jt.copyArrayElements(t,0,this.nes.cpu.mem,24576,8192)}},loadRomBank:function(t,e){t%=this.nes.rom.romCount,jt.copyArrayElements(this.nes.rom.rom[t],0,this.nes.cpu.mem,e,16384)},loadVromBank:function(t,e){if(this.nes.rom.vromCount!==0){this.nes.ppu.triggerRendering(),jt.copyArrayElements(this.nes.rom.vrom[t%this.nes.rom.vromCount],0,this.nes.ppu.vramMem,e,4096);var i=this.nes.rom.vromTile[t%this.nes.rom.vromCount];jt.copyArrayElements(i,0,this.nes.ppu.ptTile,e>>4,256)}},load32kRomBank:function(t,e){this.loadRomBank(t*2%this.nes.rom.romCount,e),this.loadRomBank((t*2+1)%this.nes.rom.romCount,e+16384)},load8kVromBank:function(t,e){this.nes.rom.vromCount!==0&&(this.nes.ppu.triggerRendering(),this.loadVromBank(t%this.nes.rom.vromCount,e),this.loadVromBank((t+1)%this.nes.rom.vromCount,e+4096))},load1kVromBank:function(t,e){if(this.nes.rom.vromCount!==0){this.nes.ppu.triggerRendering();var i=Math.floor(t/4)%this.nes.rom.vromCount,s=t%4*1024;jt.copyArrayElements(this.nes.rom.vrom[i],s,this.nes.ppu.vramMem,e,1024);for(var r=this.nes.rom.vromTile[i],n=e>>4,o=0;o<64;o++)this.nes.ppu.ptTile[n+o]=r[(t%4<<6)+o]}},load2kVromBank:function(t,e){if(this.nes.rom.vromCount!==0){this.nes.ppu.triggerRendering();var i=Math.floor(t/2)%this.nes.rom.vromCount,s=t%2*2048;jt.copyArrayElements(this.nes.rom.vrom[i],s,this.nes.ppu.vramMem,e,2048);for(var r=this.nes.rom.vromTile[i],n=e>>4,o=0;o<128;o++)this.nes.ppu.ptTile[n+o]=r[(t%2<<7)+o]}},load8kRomBank:function(t,e){var i=Math.floor(t/2)%this.nes.rom.romCount,s=t%2*8192;jt.copyArrayElements(this.nes.rom.rom[i],s,this.nes.cpu.mem,e,8192)},clockIrqCounter:function(){},latchAccess:function(t){},toJSON:function(){return{joy1StrobeState:this.joy1StrobeState,joy2StrobeState:this.joy2StrobeState,joypadLastWrite:this.joypadLastWrite}},fromJSON:function(t){this.joy1StrobeState=t.joy1StrobeState,this.joy2StrobeState=t.joy2StrobeState,this.joypadLastWrite=t.joypadLastWrite}};R[1]=function(t){this.nes=t};R[1].prototype=new R[0];R[1].prototype.reset=function(){R[0].prototype.reset.apply(this),this.regBuffer=0,this.regBufferCounter=0,this.mirroring=0,this.oneScreenMirroring=0,this.prgSwitchingArea=1,this.prgSwitchingSize=1,this.vromSwitchingSize=0,this.romSelectionReg0=0,this.romSelectionReg1=0,this.romBankSelect=0};R[1].prototype.write=function(t,e){if(t<32768){R[0].prototype.write.apply(this,arguments);return}(e&128)!==0?(this.regBufferCounter=0,this.regBuffer=0,this.getRegNumber(t)===0&&(this.prgSwitchingArea=1,this.prgSwitchingSize=1)):(this.regBuffer=this.regBuffer&255-(1<<this.regBufferCounter)|(e&1)<<this.regBufferCounter,this.regBufferCounter++,this.regBufferCounter===5&&(this.setReg(this.getRegNumber(t),this.regBuffer),this.regBuffer=0,this.regBufferCounter=0))};R[1].prototype.setReg=function(t,e){var i;switch(t){case 0:i=e&3,i!==this.mirroring&&(this.mirroring=i,(this.mirroring&2)===0?this.nes.ppu.setMirroring(this.nes.rom.SINGLESCREEN_MIRRORING):(this.mirroring&1)!==0?this.nes.ppu.setMirroring(this.nes.rom.HORIZONTAL_MIRRORING):this.nes.ppu.setMirroring(this.nes.rom.VERTICAL_MIRRORING)),this.prgSwitchingArea=e>>2&1,this.prgSwitchingSize=e>>3&1,this.vromSwitchingSize=e>>4&1;break;case 1:this.romSelectionReg0=e>>4&1,this.nes.rom.vromCount>0&&(this.vromSwitchingSize===0?this.romSelectionReg0===0?this.load8kVromBank(e&15,0):this.load8kVromBank(Math.floor(this.nes.rom.vromCount/2)+(e&15),0):this.romSelectionReg0===0?this.loadVromBank(e&15,0):this.loadVromBank(Math.floor(this.nes.rom.vromCount/2)+(e&15),0));break;case 2:this.romSelectionReg1=e>>4&1,this.nes.rom.vromCount>0&&this.vromSwitchingSize===1&&(this.romSelectionReg1===0?this.loadVromBank(e&15,4096):this.loadVromBank(Math.floor(this.nes.rom.vromCount/2)+(e&15),4096));break;default:i=e&15;var s,r=0;this.nes.rom.romCount>=32?this.vromSwitchingSize===0?this.romSelectionReg0===1&&(r=16):r=(this.romSelectionReg0|this.romSelectionReg1<<1)<<3:this.nes.rom.romCount>=16&&this.romSelectionReg0===1&&(r=8),this.prgSwitchingSize===0?(s=r+(e&15),this.load32kRomBank(s,32768)):(s=r*2+(e&15),this.prgSwitchingArea===0?this.loadRomBank(s,49152):this.loadRomBank(s,32768))}};R[1].prototype.getRegNumber=function(t){return t>=32768&&t<=40959?0:t>=40960&&t<=49151?1:t>=49152&&t<=57343?2:3};R[1].prototype.loadROM=function(){if(!this.nes.rom.valid)throw new Error("MMC1: Invalid ROM! Unable to load.");this.loadRomBank(0,32768),this.loadRomBank(this.nes.rom.romCount-1,49152),this.loadCHRROM(),this.loadBatteryRam(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)};R[1].prototype.switchLowHighPrgRom=function(t){};R[1].prototype.switch16to32=function(){};R[1].prototype.switch32to16=function(){};R[1].prototype.toJSON=function(){var t=R[0].prototype.toJSON.apply(this);return t.mirroring=this.mirroring,t.oneScreenMirroring=this.oneScreenMirroring,t.prgSwitchingArea=this.prgSwitchingArea,t.prgSwitchingSize=this.prgSwitchingSize,t.vromSwitchingSize=this.vromSwitchingSize,t.romSelectionReg0=this.romSelectionReg0,t.romSelectionReg1=this.romSelectionReg1,t.romBankSelect=this.romBankSelect,t.regBuffer=this.regBuffer,t.regBufferCounter=this.regBufferCounter,t};R[1].prototype.fromJSON=function(t){R[0].prototype.fromJSON.apply(this,arguments),this.mirroring=t.mirroring,this.oneScreenMirroring=t.oneScreenMirroring,this.prgSwitchingArea=t.prgSwitchingArea,this.prgSwitchingSize=t.prgSwitchingSize,this.vromSwitchingSize=t.vromSwitchingSize,this.romSelectionReg0=t.romSelectionReg0,this.romSelectionReg1=t.romSelectionReg1,this.romBankSelect=t.romBankSelect,this.regBuffer=t.regBuffer,this.regBufferCounter=t.regBufferCounter};R[2]=function(t){this.nes=t};R[2].prototype=new R[0];R[2].prototype.write=function(t,e){if(t<32768){R[0].prototype.write.apply(this,arguments);return}else this.loadRomBank(e,32768)};R[2].prototype.loadROM=function(){if(!this.nes.rom.valid)throw new Error("UNROM: Invalid ROM! Unable to load.");this.loadRomBank(0,32768),this.loadRomBank(this.nes.rom.romCount-1,49152),this.loadCHRROM(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)};R[3]=function(t){this.nes=t};R[3].prototype=new R[0];R[3].prototype.write=function(t,e){if(t<32768){R[0].prototype.write.apply(this,arguments);return}else{var i=e%(this.nes.rom.vromCount/2)*2;this.loadVromBank(i,0),this.loadVromBank(i+1,4096),this.load8kVromBank(e*2,0)}};R[4]=function(t){this.nes=t,this.CMD_SEL_2_1K_VROM_0000=0,this.CMD_SEL_2_1K_VROM_0800=1,this.CMD_SEL_1K_VROM_1000=2,this.CMD_SEL_1K_VROM_1400=3,this.CMD_SEL_1K_VROM_1800=4,this.CMD_SEL_1K_VROM_1C00=5,this.CMD_SEL_ROM_PAGE1=6,this.CMD_SEL_ROM_PAGE2=7,this.command=null,this.prgAddressSelect=null,this.chrAddressSelect=null,this.pageNumber=null,this.irqCounter=null,this.irqLatchValue=null,this.irqEnable=null,this.prgAddressChanged=!1};R[4].prototype=new R[0];R[4].prototype.write=function(t,e){if(t<32768){R[0].prototype.write.apply(this,arguments);return}switch(t){case 32768:this.command=e&7;var i=e>>6&1;i!==this.prgAddressSelect&&(this.prgAddressChanged=!0),this.prgAddressSelect=i,this.chrAddressSelect=e>>7&1;break;case 32769:this.executeCommand(this.command,e);break;case 40960:(e&1)!==0?this.nes.ppu.setMirroring(this.nes.rom.HORIZONTAL_MIRRORING):this.nes.ppu.setMirroring(this.nes.rom.VERTICAL_MIRRORING);break;case 40961:break;case 49152:this.irqCounter=e;break;case 49153:this.irqLatchValue=e;break;case 57344:this.irqEnable=0;break;case 57345:this.irqEnable=1;break}};R[4].prototype.executeCommand=function(t,e){switch(t){case this.CMD_SEL_2_1K_VROM_0000:this.chrAddressSelect===0?(this.load1kVromBank(e,0),this.load1kVromBank(e+1,1024)):(this.load1kVromBank(e,4096),this.load1kVromBank(e+1,5120));break;case this.CMD_SEL_2_1K_VROM_0800:this.chrAddressSelect===0?(this.load1kVromBank(e,2048),this.load1kVromBank(e+1,3072)):(this.load1kVromBank(e,6144),this.load1kVromBank(e+1,7168));break;case this.CMD_SEL_1K_VROM_1000:this.chrAddressSelect===0?this.load1kVromBank(e,4096):this.load1kVromBank(e,0);break;case this.CMD_SEL_1K_VROM_1400:this.chrAddressSelect===0?this.load1kVromBank(e,5120):this.load1kVromBank(e,1024);break;case this.CMD_SEL_1K_VROM_1800:this.chrAddressSelect===0?this.load1kVromBank(e,6144):this.load1kVromBank(e,2048);break;case this.CMD_SEL_1K_VROM_1C00:this.chrAddressSelect===0?this.load1kVromBank(e,7168):this.load1kVromBank(e,3072);break;case this.CMD_SEL_ROM_PAGE1:this.prgAddressChanged&&(this.prgAddressSelect===0?this.load8kRomBank((this.nes.rom.romCount-1)*2,49152):this.load8kRomBank((this.nes.rom.romCount-1)*2,32768),this.prgAddressChanged=!1),this.prgAddressSelect===0?this.load8kRomBank(e,32768):this.load8kRomBank(e,49152);break;case this.CMD_SEL_ROM_PAGE2:this.load8kRomBank(e,40960),this.prgAddressChanged&&(this.prgAddressSelect===0?this.load8kRomBank((this.nes.rom.romCount-1)*2,49152):this.load8kRomBank((this.nes.rom.romCount-1)*2,32768),this.prgAddressChanged=!1)}};R[4].prototype.loadROM=function(){if(!this.nes.rom.valid)throw new Error("MMC3: Invalid ROM! Unable to load.");this.load8kRomBank((this.nes.rom.romCount-1)*2,49152),this.load8kRomBank((this.nes.rom.romCount-1)*2+1,57344),this.load8kRomBank(0,32768),this.load8kRomBank(1,40960),this.loadCHRROM(),this.loadBatteryRam(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)};R[4].prototype.clockIrqCounter=function(){this.irqEnable===1&&(this.irqCounter--,this.irqCounter<0&&(this.nes.cpu.requestIrq(this.nes.cpu.IRQ_NORMAL),this.irqCounter=this.irqLatchValue))};R[4].prototype.toJSON=function(){var t=R[0].prototype.toJSON.apply(this);return t.command=this.command,t.prgAddressSelect=this.prgAddressSelect,t.chrAddressSelect=this.chrAddressSelect,t.pageNumber=this.pageNumber,t.irqCounter=this.irqCounter,t.irqLatchValue=this.irqLatchValue,t.irqEnable=this.irqEnable,t.prgAddressChanged=this.prgAddressChanged,t};R[4].prototype.fromJSON=function(t){R[0].prototype.fromJSON.apply(this,arguments),this.command=t.command,this.prgAddressSelect=t.prgAddressSelect,this.chrAddressSelect=t.chrAddressSelect,this.pageNumber=t.pageNumber,this.irqCounter=t.irqCounter,this.irqLatchValue=t.irqLatchValue,this.irqEnable=t.irqEnable,this.prgAddressChanged=t.prgAddressChanged};R[5]=function(t){this.nes=t};R[5].prototype=new R[0];R[5].prototype.write=function(t,e){t<32768?R[0].prototype.write.apply(this,arguments):this.load8kVromBank(e,0)};R[5].prototype.write=function(t,e){if(t<20480){R[0].prototype.write.apply(this,arguments);return}switch(t){case 20736:this.prg_size=e&3;break;case 20737:this.chr_size=e&3;break;case 20738:this.sram_we_a=e&3;break;case 20739:this.sram_we_b=e&3;break;case 20740:this.graphic_mode=e&3;break;case 20741:this.nametable_mode=e,this.nametable_type[0]=e&3,this.load1kVromBank(e&3,8192),e>>=2,this.nametable_type[1]=e&3,this.load1kVromBank(e&3,9216),e>>=2,this.nametable_type[2]=e&3,this.load1kVromBank(e&3,10240),e>>=2,this.nametable_type[3]=e&3,this.load1kVromBank(e&3,11264);break;case 20742:this.fill_chr=e;break;case 20743:this.fill_pal=e&3;break;case 20755:this.SetBank_SRAM(3,e&3);break;case 20756:case 20757:case 20758:case 20759:this.SetBank_CPU(t,e);break;case 20768:case 20769:case 20770:case 20771:case 20772:case 20773:case 20774:case 20775:this.chr_mode=0,this.chr_page[0][t&7]=e,this.SetBank_PPU();break;case 20776:case 20777:case 20778:case 20779:this.chr_mode=1,this.chr_page[1][(t&3)+0]=e,this.chr_page[1][(t&3)+4]=e,this.SetBank_PPU();break;case 20992:this.split_control=e;break;case 20993:this.split_scroll=e;break;case 20994:this.split_page=e&63;break;case 20995:this.irq_line=e,this.nes.cpu.ClearIRQ();break;case 20996:this.irq_enable=e,this.nes.cpu.ClearIRQ();break;case 20997:this.mult_a=e;break;case 20998:this.mult_b=e;break;default:t>=20480&&t<=20501?this.nes.papu.exWrite(t,e):t>=23552&&t<=24575?this.graphic_mode===2||this.graphic_mode!==3&&this.irq_status&64:t>=24576&&t<=32767&&this.sram_we_a===2&&this.sram_we_b;break}};R[5].prototype.loadROM=function(){if(!this.nes.rom.valid)throw new Error("UNROM: Invalid ROM! Unable to load.");this.load8kRomBank(this.nes.rom.romCount*2-1,32768),this.load8kRomBank(this.nes.rom.romCount*2-1,40960),this.load8kRomBank(this.nes.rom.romCount*2-1,49152),this.load8kRomBank(this.nes.rom.romCount*2-1,57344),this.loadCHRROM(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)};R[7]=function(t){this.nes=t};R[7].prototype=new R[0];R[7].prototype.write=function(t,e){t<32768?R[0].prototype.write.apply(this,arguments):(this.load32kRomBank(e&7,32768),e&16?this.nes.ppu.setMirroring(this.nes.rom.SINGLESCREEN_MIRRORING2):this.nes.ppu.setMirroring(this.nes.rom.SINGLESCREEN_MIRRORING))};R[7].prototype.loadROM=function(){if(!this.nes.rom.valid)throw new Error("AOROM: Invalid ROM! Unable to load.");this.loadPRGROM(),this.loadCHRROM(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)};R[11]=function(t){this.nes=t};R[11].prototype=new R[0];R[11].prototype.write=function(t,e){if(t<32768){R[0].prototype.write.apply(this,arguments);return}else{var i=(e&15)*2%this.nes.rom.romCount,s=((e&15)*2+1)%this.nes.rom.romCount;if(this.loadRomBank(i,32768),this.loadRomBank(s,49152),this.nes.rom.vromCount>0){var r=(e>>4)*2%this.nes.rom.vromCount;this.loadVromBank(r,0),this.loadVromBank(r+1,4096)}}};R[34]=function(t){this.nes=t};R[34].prototype=new R[0];R[34].prototype.write=function(t,e){if(t<32768){R[0].prototype.write.apply(this,arguments);return}else this.load32kRomBank(e,32768)};R[38]=function(t){this.nes=t};R[38].prototype=new R[0];R[38].prototype.write=function(t,e){if(t<28672||t>32767){R[0].prototype.write.apply(this,arguments);return}else this.load32kRomBank(e&3,32768),this.load8kVromBank((e>>2&3)*2,0)};R[66]=function(t){this.nes=t};R[66].prototype=new R[0];R[66].prototype.write=function(t,e){if(t<32768){R[0].prototype.write.apply(this,arguments);return}else this.load32kRomBank(e>>4&3,32768),this.load8kVromBank((e&3)*2,0)};R[94]=function(t){this.nes=t};R[94].prototype=new R[0];R[94].prototype.write=function(t,e){if(t<32768){R[0].prototype.write.apply(this,arguments);return}else this.loadRomBank(e>>2,32768)};R[94].prototype.loadROM=function(){if(!this.nes.rom.valid)throw new Error("UN1ROM: Invalid ROM! Unable to load.");this.loadRomBank(0,32768),this.loadRomBank(this.nes.rom.romCount-1,49152),this.loadCHRROM(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)};R[140]=function(t){this.nes=t};R[140].prototype=new R[0];R[140].prototype.write=function(t,e){if(t<24576||t>32767){R[0].prototype.write.apply(this,arguments);return}else this.load32kRomBank(e>>4&3,32768),this.load8kVromBank((e&15)*2,0)};R[180]=function(t){this.nes=t};R[180].prototype=new R[0];R[180].prototype.write=function(t,e){if(t<32768){R[0].prototype.write.apply(this,arguments);return}else this.loadRomBank(e,49152)};R[180].prototype.loadROM=function(){if(!this.nes.rom.valid)throw new Error("Mapper 180: Invalid ROM! Unable to load.");this.loadRomBank(0,32768),this.loadRomBank(this.nes.rom.romCount-1,49152),this.loadCHRROM(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)};var Fo=R,Ms=Fo,Mo=kr,Yr=function(t){this.nes=t,this.mapperName=new Array(92);for(var e=0;e<92;e++)this.mapperName[e]="Unknown Mapper";this.mapperName[0]="Direct Access",this.mapperName[1]="Nintendo MMC1",this.mapperName[2]="UNROM",this.mapperName[3]="CNROM",this.mapperName[4]="Nintendo MMC3",this.mapperName[5]="Nintendo MMC5",this.mapperName[6]="FFE F4xxx",this.mapperName[7]="AOROM",this.mapperName[8]="FFE F3xxx",this.mapperName[9]="Nintendo MMC2",this.mapperName[10]="Nintendo MMC4",this.mapperName[11]="Color Dreams Chip",this.mapperName[12]="FFE F6xxx",this.mapperName[15]="100-in-1 switch",this.mapperName[16]="Bandai chip",this.mapperName[17]="FFE F8xxx",this.mapperName[18]="Jaleco SS8806 chip",this.mapperName[19]="Namcot 106 chip",this.mapperName[20]="Famicom Disk System",this.mapperName[21]="Konami VRC4a",this.mapperName[22]="Konami VRC2a",this.mapperName[23]="Konami VRC2a",this.mapperName[24]="Konami VRC6",this.mapperName[25]="Konami VRC4b",this.mapperName[32]="Irem G-101 chip",this.mapperName[33]="Taito TC0190/TC0350",this.mapperName[34]="32kB ROM switch",this.mapperName[64]="Tengen RAMBO-1 chip",this.mapperName[65]="Irem H-3001 chip",this.mapperName[66]="GNROM switch",this.mapperName[67]="SunSoft3 chip",this.mapperName[68]="SunSoft4 chip",this.mapperName[69]="SunSoft5 FME-7 chip",this.mapperName[71]="Camerica chip",this.mapperName[78]="Irem 74HC161/32-based",this.mapperName[91]="Pirate HK-SF3 chip"};Yr.prototype={VERTICAL_MIRRORING:0,HORIZONTAL_MIRRORING:1,FOURSCREEN_MIRRORING:2,SINGLESCREEN_MIRRORING:3,SINGLESCREEN_MIRRORING2:4,SINGLESCREEN_MIRRORING3:5,SINGLESCREEN_MIRRORING4:6,CHRROM_MIRRORING:7,header:null,rom:null,vrom:null,vromTile:null,romCount:null,vromCount:null,mirroring:null,batteryRam:null,trainer:null,fourScreen:null,mapperType:null,valid:!1,load:function(t){var e,i,s;if(t.indexOf("NES")===-1)throw new Error("Not a valid NES ROM.");for(this.header=new Array(16),e=0;e<16;e++)this.header[e]=t.charCodeAt(e)&255;this.romCount=this.header[4],this.vromCount=this.header[5]*2,this.mirroring=(this.header[6]&1)!==0?1:0,this.batteryRam=(this.header[6]&2)!==0,this.trainer=(this.header[6]&4)!==0,this.fourScreen=(this.header[6]&8)!==0,this.mapperType=this.header[6]>>4|this.header[7]&240;var r=!1;for(e=8;e<16;e++)if(this.header[e]!==0){r=!0;break}r&&(this.mapperType&=15),this.rom=new Array(this.romCount);var n=16;for(e=0;e<this.romCount;e++){for(this.rom[e]=new Array(16384),i=0;i<16384&&!(n+i>=t.length);i++)this.rom[e][i]=t.charCodeAt(n+i)&255;n+=16384}for(this.vrom=new Array(this.vromCount),e=0;e<this.vromCount;e++){for(this.vrom[e]=new Array(4096),i=0;i<4096&&!(n+i>=t.length);i++)this.vrom[e][i]=t.charCodeAt(n+i)&255;n+=4096}for(this.vromTile=new Array(this.vromCount),e=0;e<this.vromCount;e++)for(this.vromTile[e]=new Array(256),i=0;i<256;i++)this.vromTile[e][i]=new Mo;var o,h;for(s=0;s<this.vromCount;s++)for(e=0;e<4096;e++)o=e>>4,h=e%16,h<8?this.vromTile[s][o].setScanline(h,this.vrom[s][e],this.vrom[s][e+8]):this.vromTile[s][o].setScanline(h-8,this.vrom[s][e-8],this.vrom[s][e]);this.valid=!0},getMirroringType:function(){return this.fourScreen?this.FOURSCREEN_MIRRORING:this.mirroring===0?this.HORIZONTAL_MIRRORING:this.VERTICAL_MIRRORING},getMapperName:function(){return this.mapperType>=0&&this.mapperType<this.mapperName.length?this.mapperName[this.mapperType]:"Unknown Mapper, "+this.mapperType},mapperSupported:function(){return typeof Ms[this.mapperType]!="undefined"},createMapper:function(){if(this.mapperSupported())return new Ms[this.mapperType](this.nes);throw new Error("This ROM uses a mapper not supported by JSNES: "+this.getMapperName()+"("+this.mapperType+")")}};var Po=Yr,wo=No,Ps=Pr,vo=To,Lo=yo,ko=Po,Ur=function(t){if(this.opts={onFrame:function(){},onAudioSample:null,onStatusUpdate:function(){},onBatteryRamWrite:function(){},preferredFrameRate:60,emulateSound:!0,sampleRate:48e3},typeof t!="undefined"){var e;for(e in this.opts)typeof t[e]!="undefined"&&(this.opts[e]=t[e])}this.frameTime=1e3/this.opts.preferredFrameRate,this.ui={writeFrame:this.opts.onFrame,updateStatus:this.opts.onStatusUpdate},this.cpu=new wo(this),this.ppu=new vo(this),this.papu=new Lo(this),this.mmap=null,this.controllers={1:new Ps,2:new Ps},this.ui.updateStatus("Ready to load a ROM."),this.frame=this.frame.bind(this),this.buttonDown=this.buttonDown.bind(this),this.buttonUp=this.buttonUp.bind(this),this.zapperMove=this.zapperMove.bind(this),this.zapperFireDown=this.zapperFireDown.bind(this),this.zapperFireUp=this.zapperFireUp.bind(this)};Ur.prototype={fpsFrameCount:0,romData:null,reset:function(){this.mmap!==null&&this.mmap.reset(),this.cpu.reset(),this.ppu.reset(),this.papu.reset(),this.lastFpsTime=null,this.fpsFrameCount=0},frame:function(){this.ppu.startFrame();var t=0,e=this.opts.emulateSound,i=this.cpu,s=this.ppu,r=this.papu;t:for(;;)for(i.cyclesToHalt===0?(t=i.emulate(),e&&r.clockFrameCounter(t),t*=3):i.cyclesToHalt>8?(t=24,e&&r.clockFrameCounter(8),i.cyclesToHalt-=8):(t=i.cyclesToHalt*3,e&&r.clockFrameCounter(i.cyclesToHalt),i.cyclesToHalt=0);t>0;t--){if(s.curX===s.spr0HitX&&s.f_spVisibility===1&&s.scanline-21===s.spr0HitY&&s.setStatusFlag(s.STATUS_SPRITE0HIT,!0),s.requestEndFrame&&(s.nmiCounter--,s.nmiCounter===0)){s.requestEndFrame=!1,s.startVBlank();break t}s.curX++,s.curX===341&&(s.curX=0,s.endScanline())}this.fpsFrameCount++},buttonDown:function(t,e){this.controllers[t].buttonDown(e)},buttonUp:function(t,e){this.controllers[t].buttonUp(e)},zapperMove:function(t,e){!this.mmap||(this.mmap.zapperX=t,this.mmap.zapperY=e)},zapperFireDown:function(){!this.mmap||(this.mmap.zapperFired=!0)},zapperFireUp:function(){!this.mmap||(this.mmap.zapperFired=!1)},getFPS:function(){var t=+new Date,e=null;return this.lastFpsTime&&(e=this.fpsFrameCount/((t-this.lastFpsTime)/1e3)),this.fpsFrameCount=0,this.lastFpsTime=t,e},reloadROM:function(){this.romData!==null&&this.loadROM(this.romData)},loadROM:function(t){this.rom=new ko(this),this.rom.load(t),this.reset(),this.mmap=this.rom.createMapper(),this.mmap.loadROM(),this.ppu.setMirroring(this.rom.getMirroringType()),this.romData=t},setFramerate:function(t){this.opts.preferredFrameRate=t,this.frameTime=1e3/t,this.papu.setSampleRate(this.opts.sampleRate,!1)},toJSON:function(){return{romData:this.romData,cpu:this.cpu.toJSON(),mmap:this.mmap.toJSON(),ppu:this.ppu.toJSON()}},fromJSON:function(t){this.reset(),this.romData=t.romData,this.cpu.fromJSON(t.cpu),this.mmap.fromJSON(t.mmap),this.ppu.fromJSON(t.ppu)}};var xo=Ur,ot={Controller:Pr,NES:xo};const Bo=["width","height"],Vo={name:"nes-eux"},Go=Yi({...Vo,props:{url:{type:String,require:!0},autoStart:{type:Boolean,require:!1,default:!1},width:{type:Number,require:!1,default:256},height:{type:Number,require:!1,default:240},label:{type:String,require:!1,default:"Game Start"},Controller_P1:{type:Object,require:!1,default:function(){return{UP:"KeyW",DOWN:"KeyS",LEFT:"KeyA",RIGHT:"KeyD",A:"KeyK",B:"KeyJ",SELECT:"Digit2",START:"Digit1"}}},Controller_P2:{type:Object,require:!1,default:function(){return{UP:"ArrowUp",DOWN:"ArrowDown",LEFT:"ArrowLeft",RIGHT:"ArrowRight",A:"Numpad2",B:"Numpad1"}}}},emits:["fpsPerSecond"],setup(t,{expose:e,emit:i}){const s=t,r=ue(256),n=ue(240),o=512,h=4*1024,a=ue(!0);let c={},p,g,S={},T={},L=h-1,k=new Float32Array(h),O=new Float32Array(h),y=0,J=0,Q;const H=new ot.NES({onFrame:function(P){var Y=0;for(let v=0;v<n.value;++v)for(let M=0;M<r.value;++M)Y=v*256+M,T[Y]=4278190080|P[Y]},onAudioSample:function(P,Y){k[y]=P,O[y]=Y,y=y+1&L},sampleRate:st()});function st(){if(!window.AudioContext)return 44100;let P=new window.AudioContext,Y=P.sampleRate;return P.close(),Y}function Bt(){return y-J&L}function Mt(P){try{P()}catch{return}}function B(P){let Y=P.outputBuffer,v=Y.length;Bt()<o&&Mt(H.frame);let M=Y.getChannelData(0),q=Y.getChannelData(1);for(let U=0;U<v;U++){let Pt=J+U&L;M[U]=k[Pt],q[U]=O[Pt]}J=J+v&L}function j(P,Y){let v=1,M=2;switch(Y.code){case s.Controller_P1.UP:P(v,ot.Controller.BUTTON_UP);break;case s.Controller_P1.DOWN:P(v,ot.Controller.BUTTON_DOWN);break;case s.Controller_P1.LEFT:P(v,ot.Controller.BUTTON_LEFT);break;case s.Controller_P1.RIGHT:P(v,ot.Controller.BUTTON_RIGHT);break;case s.Controller_P1.B:P(v,ot.Controller.BUTTON_B);break;case s.Controller_P1.A:P(v,ot.Controller.BUTTON_A);break;case s.Controller_P1.SELECT:P(v,ot.Controller.BUTTON_SELECT);break;case s.Controller_P1.START:c.state!=="running"&&c.resume(),P(v,ot.Controller.BUTTON_START);break;case s.Controller_P2.UP:P(M,ot.Controller.BUTTON_UP);break;case s.Controller_P2.DOWN:P(M,ot.Controller.BUTTON_DOWN);break;case s.Controller_P2.LEFT:P(M,ot.Controller.BUTTON_LEFT);break;case s.Controller_P2.RIGHT:P(M,ot.Controller.BUTTON_RIGHT);break;case s.Controller_P2.B:P(M,ot.Controller.BUTTON_B);break;case s.Controller_P2.A:P(M,ot.Controller.BUTTON_A);break}}function z(P=s.url){a.value=!1;const Y=document.querySelector("#game-box"),v=Y.getContext("2d"),M=v.getImageData(0,0,r.value,n.value);v.fillStyle="black",v.fillRect(0,0,r.value,n.value);const q=new ArrayBuffer(M.data.length);S=new Uint8ClampedArray(q),T=new Uint32Array(q),c=new AudioContext,p=c.createScriptProcessor(o,0,2),p.onaudioprocess=B,p.connect(c.destination);var U=new XMLHttpRequest;U.open("GET",P),U.overrideMimeType("text/plain; charset=x-user-defined"),U.onerror=()=>console.log(`Error loading ${P}: ${U.statusText}`),U.onload=function(){if(this.status===200)try{H.loadROM(this.responseText),rt(Y),Q=setInterval(()=>{const ft=H.getFPS();i("fpsPerSecond",ft||0)},1e3)}catch{console.error(`Error loading ${P}`),ct()}else console.log(`Error loading ${P}: ${U.statusText}`);g=requestAnimationFrame(Pt)},U.send(),document.addEventListener("keydown",ft=>{j(H.buttonDown,ft)}),document.addEventListener("keyup",ft=>{j(H.buttonUp,ft)});function Pt(){requestAnimationFrame(Pt),M.data.set(S),v.putImageData(M,0,0)}}function rt(P){let Y=P.parentNode,v=Y.clientWidth,M=Y.clientHeight,q=v/M,U=r.value/n.value;U<q?(P.style.width=`${Math.round(M*U)}px`,P.style.height=`${M}px`):(P.style.width=`${v}px`,P.style.height=`${Math.round(v/U)}px`)}function at(){a.value||(p.onaudioprocess&&ct(),s.url&&z(s.url))}function ct(){a.value||(p.disconnect(c.destination),p.onaudioprocess=null,clearInterval(Q),"close"in c&&c.close(),H.reset(),cancelAnimationFrame(g))}return Ui(()=>{if(s.url&&s.autoStart&&z(s.url),!s.url)throw"nes-eux missing props: url"}),xe(()=>s.url,()=>{at()}),e({gameStart:z,gameReset:at,gameStop:ct}),(P,Y)=>(Ee(),Ue("div",{style:We(`width:${t.width}px;height:${t.height}px;background-color:#000;margin:auto;position:relative`)},[vt("canvas",{id:"game-box",width:r.value,height:n.value,style:{display:"inline-block"}},null,8,Bo),a.value?(Ee(),Ue("div",{key:0,onClick:Y[0]||(Y[0]=v=>z(t.url)),style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",cursor:"pointer",color:"#f8f4ed","font-size":"20px"}},vs(t.label),1)):qh("",!0)],4))}});const qo={class:"box"},Xo={class:"show-fps"},Ho=Yi({__name:"DemoEux",setup(t){const e=ue(null),i=["../public/Wanpaku Duck Yume Bouken 2.nes","../public/Chip to Dale no Dai Sakusen 2.nes"];let s=ue(i[0]),r=ue("0"),n=0;function o(){n++,n===i.length&&(n=0),s.value=i[n]}function h(p){r.value=p.toFixed(2)}function a(){e.value&&e.value.gameReset()}function c(){e.value&&e.value.gameStop()}return(p,g)=>(Ee(),Ue(St,null,[vt("div",qo,[Dt(ke(Go),{url:ke(s),label:"Click to Start",onFpsPerSecond:h,width:512,height:480,ref_key:"eux",ref:e},null,8,["url"]),vt("div",Xo,"FPS:"+vs(ke(r)),1)]),vt("div",null,[vt("button",{onClick:o},"Switch"),vt("button",{onClick:a},"Reset"),vt("button",{onClick:c},"Stop")])],64))}});const Yo=Yi({__name:"App",setup(t){return(e,i)=>(Ee(),Ue("div",null,[Dt(Ho)]))}});Io(Yo).mount("#app");
